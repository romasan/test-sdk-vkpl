function t(t,e,n,r){Object.defineProperty(t,e,{get:n,set:r,enumerable:!0,configurable:!0})}(0,globalThis.parcelRequireb792.register)("cwlwz",function(e,n){t(e.exports,"DEFAULT_GRAPH_DESIGN",()=>s),t(e.exports,"GraphEditor",()=>l);var r={996:t=>{var e=function(t){var e;return!!t&&"object"==typeof t&&"[object RegExp]"!==(e=Object.prototype.toString.call(t))&&"[object Date]"!==e&&t.$$typeof!==n},n="function"==typeof Symbol&&Symbol.for?Symbol.for("react.element"):60103;function r(t,e){return!1!==e.clone&&e.isMergeableObject(t)?s(Array.isArray(t)?[]:{},t,e):t}function o(t,e,n){return t.concat(e).map(function(t){return r(t,n)})}function i(t){return Object.keys(t).concat(Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(t).filter(function(e){return Object.propertyIsEnumerable.call(t,e)}):[])}function a(t,e){try{return e in t}catch(t){return!1}}function s(t,n,l){(l=l||{}).arrayMerge=l.arrayMerge||o,l.isMergeableObject=l.isMergeableObject||e,l.cloneUnlessOtherwiseSpecified=r;var c,u,d=Array.isArray(n);return d===Array.isArray(t)?d?l.arrayMerge(t,n,l):(u={},(c=l).isMergeableObject(t)&&i(t).forEach(function(e){u[e]=r(t[e],c)}),i(n).forEach(function(e){a(t,e)&&!(Object.hasOwnProperty.call(t,e)&&Object.propertyIsEnumerable.call(t,e))||(a(t,e)&&c.isMergeableObject(n[e])?u[e]=(function(t,e){if(!e.customMerge)return s;var n=e.customMerge(t);return"function"==typeof n?n:s})(e,c)(t[e],n[e],c):u[e]=r(n[e],c))}),u):r(n,l)}s.all=function(t,e){if(!Array.isArray(t))throw Error("first argument should be an array");return t.reduce(function(t,n){return s(t,n,e)},{})},t.exports=s},96:(t,e,n)=>{var r="Expected a function",o=NaN,i=/^\s+|\s+$/g,a=/^[-+]0x[0-9a-f]+$/i,s=/^0b[01]+$/i,l=/^0o[0-7]+$/i,c=parseInt,u="object"==typeof n.g&&n.g&&n.g.Object===Object&&n.g,d="object"==typeof self&&self&&self.Object===Object&&self,h=u||d||Function("return this")(),f=Object.prototype.toString,p=Math.max,v=Math.min,y=function(){return h.Date.now()};function m(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function g(t){if("number"==typeof t)return t;if("symbol"==typeof(e=t)||e&&"object"==typeof e&&"[object Symbol]"==f.call(e))return o;if(m(t)){var e,n="function"==typeof t.valueOf?t.valueOf():t;t=m(n)?n+"":n}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(i,"");var r=s.test(t);return r||l.test(t)?c(t.slice(2),r?2:8):a.test(t)?o:+t}t.exports=function(t,e,n){var o=!0,i=!0;if("function"!=typeof t)throw TypeError(r);return m(n)&&(o="leading"in n?!!n.leading:o,i="trailing"in n?!!n.trailing:i),function(t,e,n){var o,i,a,s,l,c,u=0,d=!1,h=!1,f=!0;if("function"!=typeof t)throw TypeError(r);function _(e){var n=o,r=i;return o=i=void 0,u=e,s=t.apply(r,n)}function b(t){var n=t-c;return void 0===c||n>=e||n<0||h&&t-u>=a}function w(){var t,n=y();if(b(n))return C(n);l=setTimeout(w,(t=e-(n-c),h?v(t,a-(n-u)):t))}function C(t){return l=void 0,f&&o?_(t):(o=i=void 0,s)}function x(){var t,n=y(),r=b(n);if(o=arguments,i=this,c=n,r){if(void 0===l)return u=t=c,l=setTimeout(w,e),d?_(t):s;if(h)return l=setTimeout(w,e),_(c)}return void 0===l&&(l=setTimeout(w,e)),s}return e=g(e)||0,m(n)&&(d=!!n.leading,a=(h="maxWait"in n)?p(g(n.maxWait)||0,e):a,f="trailing"in n?!!n.trailing:f),x.cancel=function(){void 0!==l&&clearTimeout(l),u=0,o=c=i=l=void 0},x.flush=function(){return void 0===l?s:C(y())},x}(t,e,{leading:o,maxWait:e,trailing:i})}},254:(t,e,n)=>{var r={"./icon_action.svg":485,"./icon_action_area.svg":492,"./icon_action_button.svg":580,"./icon_add.svg":490,"./icon_end_node.svg":181,"./icon_end_of_video.svg":71,"./icon_etc.svg":161,"./icon_inaction.svg":577,"./icon_legend_navigation.svg":893,"./icon_location.svg":978,"./icon_lock.svg":628,"./icon_minus.svg":246,"./icon_move.svg":696,"./icon_node.svg":872,"./icon_plus.svg":52,"./icon_random.svg":716,"./icon_start_node.svg":916,"./icon_warning.svg":123};function o(t){return n(i(t))}function i(t){if(!n.o(r,t)){var e=Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return r[t]}o.keys=function(){return Object.keys(r)},o.resolve=i,t.exports=o,o.id=254},521:t=>{t.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTI4IiBoZWlnaHQ9IjEyOCIgdmlld0JveD0iMCAwIDEyOCAxMjgiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CiAgPHBhdGggZD0iTTM1IDgxVjM3YTIgMiAwIDAgMSAyLTJoNjRhMiAyIDAgMCAxIDIgMnY0NGEyIDIgMCAwIDEtMiAySDM3YTIgMiAwIDAgMS0yLTJaIiBmaWxsPSIjZmZmIiBmaWxsLW9wYWNpdHk9Ii4wNiIvPjxwYXRoIGQ9Ik0yNyA4OVY0NWEyIDIgMCAwIDEgMi0yaDY0YTIgMiAwIDAgMSAyIDJ2NDRhMiAyIDAgMCAxLTIgMkgyOWEyIDIgMCAwIDEtMi0yWiIgZmlsbD0iI2ZmZiIgZmlsbC1vcGFjaXR5PSIuMTEiLz4KPC9zdmc+Cg=="},485:t=>{t.exports='<svg viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg">\n  <path d="M2.94559 5.07445L1.54456 6.40055L4.22088 8.93219C4.70945 9.3593 5.35248 9.15608 5.55006 8.93219L8.00186 6.54693L10.4537 4.16168L9.07059 2.81836L5.19063 6.52268C4.99911 6.70553 4.69825 6.70736 4.50452 6.52687L2.94559 5.07445Z" fill="currentColor"/>\n</svg>\n'},492:t=>{t.exports='<svg viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path fill-rule="evenodd" clip-rule="evenodd" d="M13.75 9C14.1642 9 14.5 9.33579 14.5 9.75V10.5C14.5 10.5 14.5 11.0055 14.4634 11.4531C14.4256 11.9163 14.3449 12.3347 14.1458 12.7255C13.8342 13.337 13.337 13.8342 12.7255 14.1458C12.3347 14.3449 11.9163 14.4256 11.4531 14.4634C11.0055 14.5 10.4999 14.5 10.4999 14.5L9.75 14.5C9.33579 14.5 9 14.1642 9 13.75C9 13.3358 9.33579 13 9.75 13L10.4685 13C10.4685 13 10.9517 12.9994 11.3309 12.9684C11.7014 12.9382 11.9004 12.8827 12.0445 12.8093C12.3738 12.6415 12.6415 12.3738 12.8093 12.0445C12.8827 11.9004 12.9382 11.7014 12.9684 11.3309C12.9994 10.9517 13 10.4686 13 10.4686V9.75C13 9.33579 13.3358 9 13.75 9Z" fill="currentColor"/>\n<path fill-rule="evenodd" clip-rule="evenodd" d="M9 2.25C9 1.83579 9.33579 1.5 9.75 1.5H10.5C10.5 1.5 11.0054 1.50001 11.453 1.53657C11.9162 1.57442 12.3346 1.65516 12.7254 1.85425C13.3369 2.16584 13.8341 2.66303 14.1457 3.27455C14.3448 3.66529 14.4255 4.08369 14.4634 4.54695C14.4999 4.99452 14.4999 5.50002 14.4999 5.50002L14.5 6.25C14.5 6.66421 14.1642 7 13.75 7C13.3358 7 13 6.66421 13 6.25L12.9999 5.53143C12.9999 5.53143 12.9993 5.04836 12.9683 4.6691C12.9381 4.2986 12.8826 4.09958 12.8092 3.95554C12.6414 3.62626 12.3737 3.35854 12.0444 3.19076C11.9004 3.11737 11.7013 3.06186 11.3308 3.03159C10.9516 3.00061 10.4686 3 10.4686 3H9.75C9.33579 3 9 2.66421 9 2.25Z" fill="currentColor"/>\n<path fill-rule="evenodd" clip-rule="evenodd" d="M7 13.75C7 14.1642 6.66421 14.5 6.25 14.5H5.5C5.5 14.5 4.99466 14.5 4.5471 14.4634C4.08383 14.4256 3.66544 14.3449 3.2747 14.1458C2.66317 13.8342 2.16598 13.337 1.85439 12.7255C1.6553 12.3347 1.57457 11.9163 1.53672 11.4531C1.50015 11.0055 1.50025 10.5 1.50025 10.5L1.5 9.75C1.5 9.33579 1.83579 9 2.25 9C2.66421 9 3 9.33579 3 9.75L3.00025 10.4686C3.00025 10.4686 3.00075 10.9517 3.03173 11.3309C3.06201 11.7014 3.11751 11.9004 3.1909 12.0445C3.35868 12.3738 3.6264 12.6415 3.95568 12.8093C4.09972 12.8827 4.29874 12.9382 4.66924 12.9684C5.0485 12.9994 5.53141 13 5.53141 13H6.25C6.66421 13 7 13.3358 7 13.75Z" fill="currentColor"/>\n<path fill-rule="evenodd" clip-rule="evenodd" d="M2.25 7C1.83579 7 1.5 6.66421 1.5 6.25V5.5C1.5 5.5 1.49999 4.9945 1.53655 4.54693C1.5744 4.08367 1.65514 3.66527 1.85423 3.27453C2.16582 2.66301 2.66301 2.16582 3.27453 1.85423C3.66527 1.65514 4.08367 1.5744 4.54693 1.53655C4.9945 1.49999 5.50008 1.50002 5.50008 1.50002L6.25 1.5C6.66421 1.5 7 1.83579 7 2.25C7 2.66421 6.66421 3 6.25 3L5.53149 3.00002C5.53149 3.00002 5.04834 3.00058 4.66908 3.03157C4.29858 3.06184 4.09956 3.11735 3.95552 3.19074C3.62623 3.35852 3.35852 3.62623 3.19074 3.95552C3.11735 4.09956 3.06184 4.29858 3.03157 4.66908C3.00058 5.04834 3 5.53141 3 5.53141V6.25C3 6.66421 2.66421 7 2.25 7Z" fill="currentColor"/>\n<path d="M8 11C9.65685 11 11 9.65685 11 8C11 6.34315 9.65685 5 8 5C6.34315 5 5 6.34315 5 8C5 9.65685 6.34315 11 8 11Z" fill="currentColor"/>\n</svg>\n'},580:t=>{t.exports='<svg viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path d="M8 11.5C9.933 11.5 11.5 9.933 11.5 8C11.5 6.067 9.933 4.5 8 4.5C6.067 4.5 4.5 6.067 4.5 8C4.5 9.933 6.067 11.5 8 11.5Z" fill="currentColor"/>\n<path fill-rule="evenodd" clip-rule="evenodd" d="M15 8C15 11.866 11.866 15 8 15C4.13401 15 1 11.866 1 8C1 4.13401 4.13401 1 8 1C11.866 1 15 4.13401 15 8ZM13.5 8C13.5 11.0376 11.0376 13.5 8 13.5C4.96243 13.5 2.5 11.0376 2.5 8C2.5 4.96243 4.96243 2.5 8 2.5C11.0376 2.5 13.5 4.96243 13.5 8Z" fill="currentColor"/>\n</svg>\n'},490:t=>{t.exports='<svg viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">\n  <path d="M7 9v4.334c0 .666.448 1 1 1 .553 0 1-.334 1-1V9h4.334c.666 0 1-.447 1-1 0-.552-.334-1-1-1H9V2.667c0-.667-.447-1-1-1-.552 0-1 .333-1 1V7H2.667c-.667 0-1 .448-1 1 0 .553.333 1 1 1H7Z" fill="currentColor"/>\n</svg>\n'},181:t=>{t.exports='<svg viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path fill-rule="evenodd" clip-rule="evenodd" d="M4 2.75C4 2.25 3.57655 2 3.25 2C2.83579 2 2.5 2.33579 2.5 2.75V14.25C2.5 14.6642 2.83579 15 3.25 15C3.66421 15 4 14.6642 4 14.25V10H12.2461C12.6603 10 12.9961 9.66421 12.9961 9.25V3.75C12.9961 3.33579 12.6603 3 12.2461 3H4V2.75ZM7.01562 8.5H9.01562V6.5H7.01562V8.5ZM7.01562 4.5V6.5H5.01562V4.5H7.01562ZM9.01562 4.5H11V6.5H9.01562V4.5Z" fill="currentColor"/>\n</svg>\n'},71:t=>{t.exports='<svg viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path d="M9.93736 6.59854L6.22562 4.56868C5.49267 4.16785 5.1262 3.96744 4.82659 4.00385C4.56514 4.03562 4.32901 4.17562 4.17569 4.38976C3.99998 4.63517 3.99998 5.05286 3.99998 5.88825V10.1232C3.99998 10.9598 3.99998 11.3781 4.17592 11.6236C4.32944 11.8378 4.56585 11.9777 4.82751 12.0093C5.12738 12.0454 5.49408 11.8442 6.22749 11.4418L9.93934 9.40504C10.4254 9.13835 10.7699 8.94933 11 8.77819V11.2498C11 11.664 11.3358 11.9998 11.75 11.9998C12.1642 11.9998 12.5 11.664 12.5 11.2498V4.74999C12.5 4.33577 12.1642 3.99999 11.75 3.99999C11.3358 3.99999 11 4.33577 11 4.74999V7.2247C10.7696 7.05367 10.4245 6.86496 9.93736 6.59854Z" fill="currentColor"/>\n</svg>\n'},161:t=>{t.exports='<svg viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">\n  <path d="M9.333 8a1.333 1.333 0 1 1-2.666 0 1.333 1.333 0 0 1 2.666 0ZM14 8a1.333 1.333 0 1 1-2.667 0A1.333 1.333 0 0 1 14 8ZM4.667 8A1.333 1.333 0 1 1 2 8a1.333 1.333 0 0 1 2.667 0Z" fill="currentColor"/>\n</svg>\n'},577:t=>{t.exports='<svg viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg">\n  <path d="M4.26103 6.00006L2.53537 7.72572C2.34011 7.92098 2.34011 8.23756 2.53537 8.43283L3.56723 9.46469C3.76249 9.65995 4.07908 9.65995 4.27434 9.46469L6 7.73903L7.72566 9.46469C7.92092 9.65996 8.2375 9.65996 8.43277 9.46469L9.46463 8.43283C9.65989 8.23757 9.65989 7.92099 9.46463 7.72572L7.73897 6.00006L9.46461 4.27441C9.65987 4.07915 9.65987 3.76257 9.4646 3.5673L8.43274 2.53544C8.23748 2.34018 7.9209 2.34018 7.72563 2.53544L6 4.26108L4.27436 2.53544C4.0791 2.34018 3.76252 2.34018 3.56725 2.53544L2.53539 3.56731C2.34013 3.76257 2.34013 4.07915 2.53539 4.27441L4.26103 6.00006Z" fill="currentColor"/>\n</svg>\n'},893:t=>{t.exports='<svg viewBox="0 0 28 28" fill="none" xmlns="http://www.w3.org/2000/svg">\n<mask id="path-1-inside-1_2354_299569" fill="white">\n<path fill-rule="evenodd" clip-rule="evenodd" d="M14.7071 26.7071C14.3166 27.0976 13.6834 27.0976 13.2929 26.7071L11.2929 24.7071C10.9024 24.3166 10.9024 23.6834 11.2929 23.2929C11.6834 22.9024 12.3166 22.9024 12.7071 23.2929L14 24.5858L15.2929 23.2929C15.6834 22.9024 16.3166 22.9024 16.7071 23.2929C17.0976 23.6834 17.0976 24.3166 16.7071 24.7071L14.7071 26.7071Z"/>\n<path fill-rule="evenodd" clip-rule="evenodd" d="M1.29289 14.7071C0.902369 14.3166 0.902369 13.6834 1.29289 13.2929L3.29289 11.2929C3.68342 10.9024 4.31658 10.9024 4.70711 11.2929C5.09763 11.6834 5.09763 12.3166 4.70711 12.7071L3.41421 14L4.70711 15.2929C5.09763 15.6834 5.09763 16.3166 4.70711 16.7071C4.31658 17.0976 3.68342 17.0976 3.29289 16.7071L1.29289 14.7071Z"/>\n<path fill-rule="evenodd" clip-rule="evenodd" d="M26.7071 13.2929C27.0976 13.6834 27.0976 14.3166 26.7071 14.7071L24.7071 16.7071C24.3166 17.0976 23.6834 17.0976 23.2929 16.7071C22.9024 16.3166 22.9024 15.6834 23.2929 15.2929L24.5858 14L23.2929 12.7071C22.9024 12.3166 22.9024 11.6834 23.2929 11.2929C23.6834 10.9024 24.3166 10.9024 24.7071 11.2929L26.7071 13.2929Z"/>\n<path fill-rule="evenodd" clip-rule="evenodd" d="M13.2929 1.29289C13.6834 0.902369 14.3166 0.902369 14.7071 1.29289L16.7071 3.29289C17.0976 3.68342 17.0976 4.31658 16.7071 4.70711C16.3166 5.09763 15.6834 5.09763 15.2929 4.70711L14 3.41421L12.7071 4.70711C12.3166 5.09763 11.6834 5.09763 11.2929 4.70711C10.9024 4.31658 10.9024 3.68342 11.2929 3.29289L13.2929 1.29289Z"/>\n<path fill-rule="evenodd" clip-rule="evenodd" d="M13.8624 6.99995C13.067 6.99952 12.4764 6.9992 11.9647 7.1363C10.5844 7.50617 9.50616 8.58436 9.1363 9.96472C8.9992 10.4764 8.99952 11.067 8.99995 11.8624L9 16C9 18.7614 11.2386 21 14 21C16.7614 21 19 18.7614 19 16L19 11.8624C19.0005 11.067 19.0008 10.4764 18.8637 9.96472C18.4938 8.58436 17.4156 7.50617 16.0353 7.1363C15.5236 6.9992 14.933 6.99952 14.1376 6.99995H13.8624ZM14 9V13C14 13.5523 13.5523 14 13 14H11V16C11 17.6569 12.3431 19 14 19C15.6569 19 17 17.6569 17 16V12C17 11.0056 16.9914 10.7046 16.9319 10.4824C16.7469 9.79218 16.2078 9.25308 15.5176 9.06815C15.2954 9.00859 14.9944 9 14 9Z"/>\n</mask>\n<path fill-rule="evenodd" clip-rule="evenodd" d="M14.7071 26.7071C14.3166 27.0976 13.6834 27.0976 13.2929 26.7071L11.2929 24.7071C10.9024 24.3166 10.9024 23.6834 11.2929 23.2929C11.6834 22.9024 12.3166 22.9024 12.7071 23.2929L14 24.5858L15.2929 23.2929C15.6834 22.9024 16.3166 22.9024 16.7071 23.2929C17.0976 23.6834 17.0976 24.3166 16.7071 24.7071L14.7071 26.7071Z" fill="white"/>\n<path fill-rule="evenodd" clip-rule="evenodd" d="M1.29289 14.7071C0.902369 14.3166 0.902369 13.6834 1.29289 13.2929L3.29289 11.2929C3.68342 10.9024 4.31658 10.9024 4.70711 11.2929C5.09763 11.6834 5.09763 12.3166 4.70711 12.7071L3.41421 14L4.70711 15.2929C5.09763 15.6834 5.09763 16.3166 4.70711 16.7071C4.31658 17.0976 3.68342 17.0976 3.29289 16.7071L1.29289 14.7071Z" fill="white"/>\n<path fill-rule="evenodd" clip-rule="evenodd" d="M26.7071 13.2929C27.0976 13.6834 27.0976 14.3166 26.7071 14.7071L24.7071 16.7071C24.3166 17.0976 23.6834 17.0976 23.2929 16.7071C22.9024 16.3166 22.9024 15.6834 23.2929 15.2929L24.5858 14L23.2929 12.7071C22.9024 12.3166 22.9024 11.6834 23.2929 11.2929C23.6834 10.9024 24.3166 10.9024 24.7071 11.2929L26.7071 13.2929Z" fill="white"/>\n<path fill-rule="evenodd" clip-rule="evenodd" d="M13.2929 1.29289C13.6834 0.902369 14.3166 0.902369 14.7071 1.29289L16.7071 3.29289C17.0976 3.68342 17.0976 4.31658 16.7071 4.70711C16.3166 5.09763 15.6834 5.09763 15.2929 4.70711L14 3.41421L12.7071 4.70711C12.3166 5.09763 11.6834 5.09763 11.2929 4.70711C10.9024 4.31658 10.9024 3.68342 11.2929 3.29289L13.2929 1.29289Z" fill="white"/>\n<path fill-rule="evenodd" clip-rule="evenodd" d="M13.8624 6.99995C13.067 6.99952 12.4764 6.9992 11.9647 7.1363C10.5844 7.50617 9.50616 8.58436 9.1363 9.96472C8.9992 10.4764 8.99952 11.067 8.99995 11.8624L9 16C9 18.7614 11.2386 21 14 21C16.7614 21 19 18.7614 19 16L19 11.8624C19.0005 11.067 19.0008 10.4764 18.8637 9.96472C18.4938 8.58436 17.4156 7.50617 16.0353 7.1363C15.5236 6.9992 14.933 6.99952 14.1376 6.99995H13.8624ZM14 9V13C14 13.5523 13.5523 14 13 14H11V16C11 17.6569 12.3431 19 14 19C15.6569 19 17 17.6569 17 16V12C17 11.0056 16.9914 10.7046 16.9319 10.4824C16.7469 9.79218 16.2078 9.25308 15.5176 9.06815C15.2954 9.00859 14.9944 9 14 9Z" fill="white"/>\n<path d="M13.2929 26.7071L12.5858 27.4142L13.2929 26.7071ZM14.7071 26.7071L15.4142 27.4142L14.7071 26.7071ZM11.2929 23.2929L12 24V24L11.2929 23.2929ZM12.7071 23.2929L13.4142 22.5858V22.5858L12.7071 23.2929ZM14 24.5858L13.2929 25.2929C13.4804 25.4804 13.7348 25.5858 14 25.5858C14.2652 25.5858 14.5196 25.4804 14.7071 25.2929L14 24.5858ZM15.2929 23.2929L14.5858 22.5858V22.5858L15.2929 23.2929ZM16.7071 23.2929L17.4142 22.5858L16.7071 23.2929ZM16.7071 24.7071L17.4142 25.4142L16.7071 24.7071ZM1.29289 13.2929L0.585786 12.5858H0.585786L1.29289 13.2929ZM1.29289 14.7071L0.585786 15.4142H0.585786L1.29289 14.7071ZM3.29289 11.2929L2.58579 10.5858L3.29289 11.2929ZM4.70711 11.2929L4 12H4L4.70711 11.2929ZM4.70711 12.7071L5.41421 13.4142L4.70711 12.7071ZM3.41421 14L2.70711 13.2929C2.31658 13.6834 2.31658 14.3166 2.70711 14.7071L3.41421 14ZM4.70711 15.2929L5.41421 14.5858L4.70711 15.2929ZM4.70711 16.7071L5.41421 17.4142L4.70711 16.7071ZM3.29289 16.7071L2.58579 17.4142H2.58579L3.29289 16.7071ZM26.7071 14.7071L27.4142 15.4142L26.7071 14.7071ZM26.7071 13.2929L27.4142 12.5858L26.7071 13.2929ZM23.2929 16.7071L24 16H24L23.2929 16.7071ZM23.2929 15.2929L22.5858 14.5858H22.5858L23.2929 15.2929ZM24.5858 14L25.2929 14.7071C25.4804 14.5196 25.5858 14.2652 25.5858 14C25.5858 13.7348 25.4804 13.4804 25.2929 13.2929L24.5858 14ZM23.2929 12.7071L22.5858 13.4142H22.5858L23.2929 12.7071ZM23.2929 11.2929L22.5858 10.5858L23.2929 11.2929ZM24.7071 11.2929L25.4142 10.5858L24.7071 11.2929ZM14.7071 1.29289L15.4142 0.585786V0.585786L14.7071 1.29289ZM13.2929 1.29289L12.5858 0.585786V0.585786L13.2929 1.29289ZM16.7071 3.29289L17.4142 2.58579L16.7071 3.29289ZM16.7071 4.70711L16 4V4L16.7071 4.70711ZM15.2929 4.70711L14.5858 5.41421L15.2929 4.70711ZM14 3.41421L14.7071 2.70711C14.3166 2.31658 13.6834 2.31658 13.2929 2.70711L14 3.41421ZM12.7071 4.70711L13.4142 5.41421L12.7071 4.70711ZM11.2929 4.70711L10.5858 5.41421L11.2929 4.70711ZM11.2929 3.29289L10.5858 2.58579V2.58579L11.2929 3.29289ZM13.8624 6.99995L13.8619 7.99995H13.8624V6.99995ZM11.9647 7.1363L11.7059 6.17037L11.9647 7.1363ZM9.1363 9.96472L8.17037 9.7059L9.1363 9.96472ZM8.99995 11.8624L9.99995 11.8624L9.99995 11.8619L8.99995 11.8624ZM9 16H10V16L9 16ZM19 16L18 16V16H19ZM19 11.8624L18 11.8619V11.8624L19 11.8624ZM18.8637 9.96472L19.8296 9.7059V9.7059L18.8637 9.96472ZM16.0353 7.1363L15.7765 8.10222L16.0353 7.1363ZM14.1376 6.99995V7.99995H14.1381L14.1376 6.99995ZM14 9V8H13V9H14ZM11 14V13H10V14H11ZM16.9319 10.4824L17.8978 10.2235V10.2235L16.9319 10.4824ZM15.5176 9.06815L15.7765 8.10222H15.7765L15.5176 9.06815ZM12.5858 27.4142C13.3668 28.1953 14.6332 28.1953 15.4142 27.4142L14 26L12.5858 27.4142ZM10.5858 25.4142L12.5858 27.4142L14 26L12 24L10.5858 25.4142ZM10.5858 22.5858C9.80474 23.3668 9.80474 24.6332 10.5858 25.4142L12 24L10.5858 22.5858ZM13.4142 22.5858C12.6332 21.8047 11.3668 21.8047 10.5858 22.5858L12 24V24L13.4142 22.5858ZM14.7071 23.8787L13.4142 22.5858L12 24L13.2929 25.2929L14.7071 23.8787ZM14.5858 22.5858L13.2929 23.8787L14.7071 25.2929L16 24L14.5858 22.5858ZM17.4142 22.5858C16.6332 21.8047 15.3668 21.8047 14.5858 22.5858L16 24L17.4142 22.5858ZM17.4142 25.4142C18.1953 24.6332 18.1953 23.3668 17.4142 22.5858L16 24L17.4142 25.4142ZM15.4142 27.4142L17.4142 25.4142L16 24L14 26L15.4142 27.4142ZM0.585786 12.5858C-0.195262 13.3668 -0.195262 14.6332 0.585786 15.4142L2 14L0.585786 12.5858ZM2.58579 10.5858L0.585786 12.5858L2 14L4 12L2.58579 10.5858ZM5.41421 10.5858C4.63316 9.80474 3.36684 9.80474 2.58579 10.5858L4 12L5.41421 10.5858ZM5.41421 13.4142C6.19526 12.6332 6.19526 11.3668 5.41421 10.5858L4 12H4L5.41421 13.4142ZM4.12132 14.7071L5.41421 13.4142L4 12L2.70711 13.2929L4.12132 14.7071ZM5.41421 14.5858L4.12132 13.2929L2.70711 14.7071L4 16L5.41421 14.5858ZM5.41421 17.4142C6.19526 16.6332 6.19526 15.3668 5.41421 14.5858L4 16L5.41421 17.4142ZM2.58579 17.4142C3.36684 18.1953 4.63316 18.1953 5.41421 17.4142L4 16L2.58579 17.4142ZM0.585786 15.4142L2.58579 17.4142L4 16L2 14L0.585786 15.4142ZM27.4142 15.4142C28.1953 14.6332 28.1953 13.3668 27.4142 12.5858L26 14L27.4142 15.4142ZM25.4142 17.4142L27.4142 15.4142L26 14L24 16L25.4142 17.4142ZM22.5858 17.4142C23.3668 18.1953 24.6332 18.1953 25.4142 17.4142L24 16L22.5858 17.4142ZM22.5858 14.5858C21.8047 15.3668 21.8047 16.6332 22.5858 17.4142L24 16H24L22.5858 14.5858ZM23.8787 13.2929L22.5858 14.5858L24 16L25.2929 14.7071L23.8787 13.2929ZM22.5858 13.4142L23.8787 14.7071L25.2929 13.2929L24 12L22.5858 13.4142ZM22.5858 10.5858C21.8047 11.3668 21.8047 12.6332 22.5858 13.4142L24 12L22.5858 10.5858ZM25.4142 10.5858C24.6332 9.80474 23.3668 9.80474 22.5858 10.5858L24 12L25.4142 10.5858ZM27.4142 12.5858L25.4142 10.5858L24 12L26 14L27.4142 12.5858ZM15.4142 0.585786C14.6332 -0.195262 13.3668 -0.195262 12.5858 0.585786L14 2L15.4142 0.585786ZM17.4142 2.58579L15.4142 0.585786L14 2L16 4L17.4142 2.58579ZM17.4142 5.41421C18.1953 4.63316 18.1953 3.36684 17.4142 2.58579L16 4L17.4142 5.41421ZM14.5858 5.41421C15.3668 6.19526 16.6332 6.19526 17.4142 5.41421L16 4V4L14.5858 5.41421ZM13.2929 4.12132L14.5858 5.41421L16 4L14.7071 2.70711L13.2929 4.12132ZM13.4142 5.41421L14.7071 4.12132L13.2929 2.70711L12 4L13.4142 5.41421ZM10.5858 5.41421C11.3668 6.19526 12.6332 6.19526 13.4142 5.41421L12 4L10.5858 5.41421ZM10.5858 2.58579C9.80474 3.36684 9.80474 4.63316 10.5858 5.41421L12 4L10.5858 2.58579ZM12.5858 0.585786L10.5858 2.58579L12 4L14 2L12.5858 0.585786ZM12.2235 8.10222C12.5804 8.00661 13.0225 7.9995 13.8619 7.99995L13.863 5.99995C13.1116 5.99954 12.3724 5.99179 11.7059 6.17037L12.2235 8.10222ZM10.1022 10.2235C10.3796 9.18827 11.1883 8.37962 12.2235 8.10222L11.7059 6.17037C9.98044 6.63271 8.63271 7.98044 8.17037 9.7059L10.1022 10.2235ZM9.99995 11.8619C9.9995 11.0225 10.0066 10.5804 10.1022 10.2235L8.17037 9.7059C7.99179 10.3724 7.99954 11.1116 7.99995 11.863L9.99995 11.8619ZM14 20C11.7909 20 10 18.2091 10 16H8C8 19.3137 10.6863 22 14 22V20ZM18 16C18 18.2091 16.2091 20 14 20V22C17.3137 22 20 19.3137 20 16H18ZM17.8978 10.2235C17.9934 10.5804 18.0005 11.0225 18 11.8619L20 11.863C20.0005 11.1116 20.0082 10.3724 19.8296 9.7059L17.8978 10.2235ZM15.7765 8.10222C16.8117 8.37962 17.6204 9.18827 17.8978 10.2235L19.8296 9.7059C19.3673 7.98044 18.0196 6.63271 16.2941 6.17037L15.7765 8.10222ZM14.1381 7.99995C14.9775 7.9995 15.4196 8.00661 15.7765 8.10222L16.2941 6.17037C15.6276 5.99179 14.8884 5.99954 14.137 5.99995L14.1381 7.99995ZM13 9V13H15V9H13ZM13 13V15C14.1046 15 15 14.1046 15 13H13ZM13 13H11V15H13V13ZM10 14V16H12V14H10ZM10 16C10 18.2091 11.7909 20 14 20V18C12.8954 18 12 17.1046 12 16H10ZM14 20C16.2091 20 18 18.2091 18 16H16C16 17.1046 15.1046 18 14 18V20ZM18 16V12H16V16H18ZM18 12C18 11.0776 18.0004 10.6065 17.8978 10.2235L15.9659 10.7412C15.9677 10.7478 15.9807 10.7937 15.9892 10.9938C15.9977 11.1963 16 11.4985 16 12H18ZM17.8978 10.2235C17.6204 9.18827 16.8117 8.37962 15.7765 8.10222L15.2588 10.0341C15.6039 10.1265 15.8735 10.3961 15.9659 10.7412L17.8978 10.2235ZM15.7765 8.10222C15.3935 7.9996 14.9224 8 14 8V10C14.5015 10 14.8037 10.0023 15.0062 10.0109C15.2063 10.0193 15.2522 10.0323 15.2588 10.0341L15.7765 8.10222ZM13.8624 7.99995H14.1376V5.99995H13.8624V7.99995ZM10 16L9.99995 11.8624L7.99995 11.8624L8 16L10 16ZM18 11.8624L18 16L20 16L20 11.8624L18 11.8624Z" fill="white" mask="url(#path-1-inside-1_2354_299569)"/>\n</svg>\n'},978:t=>{t.exports='<svg viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path d="M6 12C6 16.0237 8.93828 21.8231 14.8148 29.3979L14.8148 29.3979C15.3226 30.0525 16.2649 30.1714 16.9194 29.6637C17.0188 29.5866 17.1081 29.4973 17.1852 29.3979C23.0617 21.8231 26 16.0237 26 12C26 6.47143 21.5286 2 16 2C10.4714 2 6 6.47143 6 12ZM12.5014 12.0015C12.5014 10.0695 14.0694 8.50148 16.0014 8.50148C17.9334 8.50148 19.5014 10.0695 19.5014 12.0015C19.5014 13.9335 17.9334 15.5015 16.0014 15.5015C14.0694 15.5015 12.5014 13.9335 12.5014 12.0015Z" fill="currentColor"/>\n</svg>\n'},628:t=>{t.exports='<svg viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path fill-rule="evenodd" clip-rule="evenodd" d="M14 10V11C14 12.4001 14 13.1002 13.7275 13.635C13.4878 14.1054 13.1054 14.4878 12.635 14.7275C12.1002 15 11.4001 15 10 15H6C4.59987 15 3.8998 15 3.36502 14.7275C2.89462 14.4878 2.51217 14.1054 2.27248 13.635C2 13.1002 2 12.4001 2 11V10C2 8.59987 2 7.8998 2.27248 7.36502C2.51217 6.89462 2.89462 6.51217 3.36502 6.27248C3.54965 6.17841 3.75397 6.11682 4 6.07649V5C4 2.79086 5.79086 1 8 1C10.2091 1 12 2.79086 12 5V6.07649C12.246 6.11682 12.4504 6.17841 12.635 6.27248C13.1054 6.51217 13.4878 6.89462 13.7275 7.36502C14 7.8998 14 8.59987 14 10ZM10 5V6H6V5C6 3.89543 6.89543 3 8 3C9.10457 3 10 3.89543 10 5Z" fill="currentColor"/>\n</svg>\n'},246:t=>{t.exports='<svg viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M1.96875 6.00013C1.96875 5.64868 2.25366 5.36377 2.60511 5.36377H9.39299C9.74445 5.36377 10.0294 5.64868 10.0294 6.00013C10.0294 6.35159 9.74445 6.6365 9.39299 6.6365H2.60511C2.25366 6.6365 1.96875 6.35159 1.96875 6.00013Z" fill="currentColor"/>\n</svg>\n'},696:t=>{t.exports='<svg viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">\n  <path d="m10 3.5.53-.53a.75.75 0 0 0-1.06 0l.53.53Zm0 14-.53.53a.75.75 0 0 0 1.06 0L10 17.5Zm7-7 .53.53a.75.75 0 0 0 0-1.06l-.53.53Zm-14 0-.53-.53a.75.75 0 0 0 0 1.06L3 10.5Zm4.37-5.43a.75.75 0 0 0 1.06 1.06L7.37 5.07Zm4.2 1.06a.75.75 0 1 0 1.06-1.06l-1.06 1.06Zm3.86 1.74a.75.75 0 1 0-1.06 1.06l1.06-1.06Zm-1.06 4.2a.75.75 0 1 0 1.06 1.06l-1.06-1.06ZM5.63 8.93a.75.75 0 0 0-1.06-1.06l1.06 1.06Zm-1.06 4.2a.75.75 0 0 0 1.06-1.06l-1.06 1.06Zm8.06 2.8a.75.75 0 1 0-1.06-1.06l1.06 1.06Zm-4.2-1.06a.75.75 0 0 0-1.06 1.06l1.06-1.06ZM9.25 3.5v7h1.5v-7h-1.5Zm0 7v7h1.5v-7h-1.5Zm.75.75h7v-1.5h-7v1.5Zm0-1.5H3v1.5h7v-1.5Zm-.53-6.78-2.1 2.1 1.06 1.06 2.1-2.1-1.06-1.06Zm0 1.06 2.1 2.1 1.06-1.06-2.1-2.1-1.06 1.06Zm8.06 5.94-2.1-2.1-1.06 1.06 2.1 2.1 1.06-1.06Zm-1.06 0-2.1 2.1 1.06 1.06 2.1-2.1-1.06-1.06ZM3.53 11.03l2.1-2.1-1.06-1.06-2.1 2.1 1.06 1.06Zm-1.06 0 2.1 2.1 1.06-1.06-2.1-2.1-1.06 1.06Zm8.06 7 2.1-2.1-1.06-1.06-2.1 2.1 1.06 1.06Zm0-1.06-2.1-2.1-1.06 1.06 2.1 2.1 1.06-1.06Z" fill="currentColor"/>\n</svg>\n'},872:t=>{t.exports='<svg viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path d="M4.6 12.5001C3.71634 12.5001 3 11.7541 3 10.8338V9.00003L1.5 9.00003C0.947716 9.00003 0.5 8.55231 0.5 8.00003C0.5 7.44774 0.947715 7.00003 1.5 7.00003H3V5.1663C3 4.24603 3.71634 3.5 4.6 3.5H11.4C12.2837 3.5 13 4.24603 13 5.1663V7.00003H14.5C15.0523 7.00003 15.5 7.44774 15.5 8.00003C15.5 8.55231 15.0523 9.00003 14.5 9.00003H13V10.8338C13 11.7541 12.2837 12.5001 11.4 12.5001H4.6Z" fill="currentColor"/>\n</svg>\n'},52:t=>{t.exports='<svg viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path d="M6.75 1.75105C6.75 1.33684 6.41421 1.00105 6 1.00105C5.58579 1.00105 5.25 1.33684 5.25 1.75105V5.25105H1.75C1.33579 5.25105 1 5.58684 1 6.00105C1 6.41527 1.33579 6.75105 1.75 6.75105H5.25V10.2511C5.25 10.6653 5.58579 11.0011 6 11.0011C6.41421 11.0011 6.75 10.6653 6.75 10.2511V6.75105H10.25C10.6642 6.75105 11 6.41527 11 6.00105C11 5.58684 10.6642 5.25105 10.25 5.25105H6.75V1.75105Z" fill="currentColor"/>\n</svg>\n'},716:t=>{t.exports='<svg viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path fill-rule="evenodd" clip-rule="evenodd" d="M12.713 2.55708C12.9932 2.441 13.3158 2.50516 13.5303 2.71966L14.7803 3.96966C15.0732 4.26255 15.0732 4.73743 14.7803 5.03032L13.5303 6.28032C13.3158 6.49482 12.9932 6.55899 12.713 6.4429C12.4327 6.32682 12.25 6.05334 12.25 5.74999V5.25155C11.3851 5.27952 10.6303 5.68239 9.85664 6.36406C9.54585 6.6379 9.07192 6.60795 8.79809 6.29717C8.52425 5.98639 8.5542 5.51246 8.86498 5.23862C9.78862 4.42478 10.8814 3.78015 12.25 3.75101V3.24999C12.25 2.94664 12.4327 2.67317 12.713 2.55708ZM1 4.49999C1 4.08577 1.33579 3.74999 1.75 3.74999C4.59632 3.74999 6.40513 5.8005 7.87948 7.51019C7.93447 7.57396 7.98901 7.63731 8.04315 7.70019C8.74976 8.52099 9.38845 9.26288 10.0789 9.82432C10.7759 10.391 11.4671 10.7231 12.25 10.7484V10.25C12.25 9.94664 12.4327 9.67317 12.713 9.55708C12.9932 9.441 13.3158 9.50516 13.5303 9.71966L14.7803 10.9697C15.0732 11.2626 15.0732 11.7374 14.7803 12.0303L13.5303 13.2803C13.3158 13.4948 12.9932 13.559 12.713 13.4429C12.4327 13.3268 12.25 13.0533 12.25 12.75V12.249C11.0124 12.2226 9.99878 11.6924 9.13262 10.9881C8.48049 10.4579 7.8782 9.79958 7.30755 9.14373C5.93869 10.6759 4.24592 12.25 1.75 12.25C1.33579 12.25 1 11.9142 1 11.5C1 11.0858 1.33579 10.75 1.75 10.75C3.61653 10.75 4.93343 9.56285 6.31646 8.00027C4.93633 6.44253 3.6229 5.24999 1.75 5.24999C1.33579 5.24999 1 4.9142 1 4.49999Z" fill="currentColor"/>\n</svg>\n'},916:t=>{t.exports='<svg viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path fill-rule="evenodd" clip-rule="evenodd" d="M4.75 2C5.16421 2 5.5 2.33579 5.5 2.75V3.02132L12.0658 6.06975C12.3306 6.19268 12.5 6.45808 12.5 6.75C12.5 7.04193 12.3306 7.30733 12.0658 7.43026L5.5 10.4787V14.2461C5.5 14.6603 5.16421 14.9961 4.75 14.9961C4.33579 14.9961 4 14.6603 4 14.2461V2.75C4 2.33579 4.33579 2 4.75 2Z" fill="currentColor"/>\n</svg>\n'},123:t=>{t.exports='<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\n  <path d="M19.81 12.84a.608.608 0 0 0-.45-.194h-2.24v-3l1.73-1.765a.634.634 0 0 0 .19-.46.634.634 0 0 0-.19-.459.609.609 0 0 0-.45-.194.609.609 0 0 0-.45.194l-1.73 1.766H7.78L6.05 6.962a.609.609 0 0 0-.45-.194.61.61 0 0 0-.45.194.634.634 0 0 0-.19.46c0 .176.063.33.19.459l1.73 1.765v3H4.64a.609.609 0 0 0-.45.194.634.634 0 0 0-.19.459c0 .177.063.33.19.46.127.128.277.193.45.193h2.24c0 1.088.193 2.02.58 2.796l-2.02 2.316a.659.659 0 0 0-.155.475.66.66 0 0 0 .205.454c.127.109.27.163.43.163a.633.633 0 0 0 .48-.214l1.83-2.112.15.143c.093.088.238.199.435.331.197.133.417.265.66.398.243.133.533.245.87.337a3.84 3.84 0 0 0 1.015.138v-9.143h1.28v9.143c.32 0 .643-.044.97-.133.326-.088.6-.187.82-.296a6.31 6.31 0 0 0 .65-.372c.213-.14.353-.236.42-.291.066-.055.116-.099.15-.133l1.98 2.01c.12.13.27.194.45.194a.59.59 0 0 0 .45-.194.636.636 0 0 0 .19-.459.635.635 0 0 0-.19-.459l-2.08-2.133c.447-.81.67-1.796.67-2.959h2.24a.608.608 0 0 0 .45-.194.634.634 0 0 0 .19-.459.633.633 0 0 0-.19-.46Z" fill="currentColor"/><path d="M14.265 5.11A3.054 3.054 0 0 0 12 4.156c-.887 0-1.642.318-2.265.954-.623.636-.935 1.407-.935 2.312h6.4c0-.905-.312-1.676-.935-2.312Z" fill="currentColor"/>\n</svg>\n'}},o={};function i(t){var e=o[t];if(void 0!==e)return e.exports;var n=o[t]={exports:{}};return r[t](n,n.exports,i),n.exports}i.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return i.d(e,{a:e}),e},i.d=(t,e)=>{for(var n in e)i.o(e,n)&&!i.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},i.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||Function("return this")()}catch(t){if("object"==typeof window)return window}}(),i.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e);var a={};(()=>{let t;i.d(a,{Q:()=>rD,$:()=>ak});var e,n,r,o,s={enableSkeletonsOnNodesCount:300,renderSkeletonOnZoomLessThan:.2,minSectorWidthInPixels:500,sectorsCount:200,sectorsVirtualBorderWidth:.2,renderAfterZoomThrottleInMs:10},l={node:{width:186,defaultHeight:115,heightWithPreview:151,heightWithPreviewEov:196,heightFull:237,borderRadius:12,headerHeight:36,componentAddActionHeight:40,componentPreviewHeight:114,componentControlHeight:44,componentOrderRadius:12,defaultConnectorPositionY:57,connectorPositionY:93,connectorPositionDiff:20,control:{connectorRadius:8,actionLinkY:12,inactionLinkY:32,lineLength:22},previewPlaceholder:{textColor:"#76787A",borderColor:"#5D5F61",backgroundColor:"#19191A"}},tool:{menuItemWidth:210,menuItemHeight:32,menuItemTooltipOffset:214,borderRadius:4,strokeColor:"rgba(255, 255, 255, 0.11)",textColor:"#F2F5FF",eov:{size:22,radius:10},copyPasteDx:50,copyPasteDy:50},strokeSize:1,iconSize:16,controlConnectorIconSize:12,color:{percentDiff:20,error:"#E94848",activeError:"#CC0E0E",text:"#FFFFFF",stroke:"#FFFFFF",disabledStroke:"#86898F",tooltipBackground:"#282A2E",elementBackground:"#232324",elementBackgroundAlt:"#1A1D20",elementBackgroundHover:"#363738",elementBackgroundHover2:"#505358",elementStroke:"#141414",nodeStroke:"#232324",shadowNodeFill:"rgba(255, 255, 255, 0.11)",shadowNodeStroke:"rgba(255, 255, 255, 0.48)",connectorStroke:"#797B82"},prefix:{nodeEOV:"eov_",nodeBorder:"border_",nodeFlipConnector:"flip_connector_",nodeActionConnector:"action_connector_",nodeInactionConnector:"inaction_connector_",nodeError:"error_"},grid:{size:18.6,steps:10}},c={node_video_error:"No video",node_video_choose:"Choose video",node_video_change:"Change video",node_open_editor:"Open editor",node_eov:"Flip to",node_add_control:"Add action",node_not_visited:"Not visited",node_watch_again_from:"Watch again",tool_menu_item_rename:"Rename",tool_menu_item_copy:"Copy",tool_menu_item_paste:"Paste",tool_menu_item_delete:"Delete",tool_menu_item_add_node:"Add node",tool_menu_item_as_start_node:"Set as Start node",tool_menu_item_as_end_node:"Set as End node",tool_menu_items_as_end_node:"Set as End nodes",tool_menu_item_as_node:"Set as node",tool_menu_items_as_node:"Set as nodes",tool_menu_item_start_preview:"Preview from this node",tool_menu_item_next_node:"Next node",tool_menu_item_random:"Random",tool_menu_item_random_tooltip:'Add action to use "Random"',tool_menu_item_control_area:"Area",tool_menu_item_control_button:"Button",tool_shadow_node_text:"Click on the left mouse \nbutton to create a node. \nClick on the right \nbutton to cancel \nthe action.",tool_shadow_node_link_text:"New node",tool_shadow_node_error:"The area must\nnot be in contact\nwith other nodes",popup_error_title:"Error",popup_error_message_1:"Manifest is broken",popup_error_message_2:"Manifest media metadata should be parsed",new_chapter_label:"[Untitled]",copied_chapter_suffix:"Copy",new_text_label:"Text",new_text_content:"Enter text",new_button_label:"Button",new_area_label:"Area",tooltip_inaction_not_available:'Not available because the <br/>"Waiting for interaction" option is enabled',copy_chapter:"Node copied",copy_multiple_chapters:"Multiple nodes copied",remove_initial_chapter:"Start node cannot be removed",graph_node_start:"Start",graph_node_end:"End",graph_location:"Current position",navigation_controls:"Zoom"},u={node_video_error:"Нет видео",node_video_choose:"Выбрать видео",node_video_change:"Заменить видео",node_open_editor:"Открыть редактор",node_eov:"Перейти к",node_add_control:"Добавить действие",node_not_visited:"Не пройдено",node_watch_again_from:"Пересмотреть",tool_menu_item_rename:"Переименовать",tool_menu_item_copy:"Копировать",tool_menu_item_paste:"Вставить",tool_menu_item_delete:"Удалить",tool_menu_item_add_node:"Новый нод",tool_menu_item_as_start_node:"Назначить нод стартовым",tool_menu_item_as_end_node:"Назначить нод финальным",tool_menu_items_as_end_node:"Назначить ноды финальными",tool_menu_item_as_node:"Назначить нод обычным",tool_menu_items_as_node:"Назначить ноды обычными",tool_menu_item_start_preview:"Начать предпросмотр",tool_menu_item_next_node:"Следующий нод",tool_menu_item_random:"Случайный",tool_menu_item_random_tooltip:'Добавьте действие чтобы использовать "Случайный"',tool_menu_item_control_area:"Область",tool_menu_item_control_button:"Кнопка",tool_shadow_node_text:"Нажмите на левую кнопку \nмыши, чтобы создать нод. \nНажмите на правую кнопку \nмыши, чтобы отменить \nдействие.",tool_shadow_node_link_text:"Новый нод",tool_shadow_node_error:"Область не должна\nзадевать другие ноды",popup_error_title:"Ошибка",popup_error_message_1:"Манифест сломан",popup_error_message_2:"Необходим парсинг поля 'metadata.media'",new_chapter_label:"[Без названия]",copied_chapter_suffix:"Копия",new_text_label:"Текст",new_text_content:"Введите текст",new_button_label:"Кнопка",new_area_label:"Область",tooltip_inaction_not_available:'Недоступно, так как включен параметр <br/>"Ожидание взаимодействия"',copy_chapter:"Нод скопирован",copy_multiple_chapters:"Несколько нод скопированы",remove_initial_chapter:"Стартовый нод нельзя удалить",graph_node_start:"Начало",graph_node_end:"Конец",graph_location:"Моя позиция",navigation_controls:"Перемещение"},d=function(){return(d=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};let h=new function(){var t=this;this.init=function(e){e&&(t._mode=e.mode||t._mode,e.lang&&(t.translation="en"===e.lang?c:u),e.translation&&(t.translation=d(d({},t.translation),e.translation)),e.performance&&(t.performance=d(d({},t.performance),e.performance)))},this.isViewMode=function(){return"read"===t._mode},this.isEditMode=function(){return"edit"===t._mode},this.isPreViewMode=function(){return"pre_view"===t._mode},this.isViewOrPreViewMode=function(){return t.isViewMode()||t.isPreViewMode()},this.isEditOrPreViewMode=function(){return t.isEditMode()||t.isPreViewMode()},this.switchMode=function(e){t._mode=e},this._mode="edit",this.render=l,this.translation=c,this.performance=s},f=new(function(){function t(){var t=this;this.on=function(e,n){t._listeners[e].push(n)},this.off=function(e,n){t._listeners[e]=t._listeners[e].filter(function(t){return t!==n})},this.emit=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];t._listeners[e].forEach(function(t){return t.apply(void 0,function(t,e,n){if(n||2==arguments.length)for(var r,o=0,i=e.length;o<i;o++)!r&&o in e||(r||(r=Array.prototype.slice.call(e,0,o)),r[o]=e[o]);return t.concat(r||Array.prototype.slice.call(e))}([],function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a}(n),!1))})},this.dispose=function(){t.resetListeners()},this.resetListeners()}return t.prototype.resetListeners=function(){this._listeners={manifestUpdate:[],selectBranches:[],control:[],zoom:[],zoomEnd:[],notification:[],actions:[],events:[]}},t}());(p=v||(v={})).Node="icon_node",p.StartNode="icon_start_node",p.EndNode="icon_end_node",p.EndOfVideo="icon_end_of_video",p.ActionButton="icon_action_button",p.ActionArea="icon_action_area",p.Etc="icon_etc",p.Add="icon_add",p.Random="icon_random",p.Warning="icon_warning",p.Move="icon_move",p.Plus="icon_plus",p.Minus="icon_minus",p.Action="icon_action",p.Inaction="icon_inaction",p.Location="icon_location",p.Lock="icon_lock",p.LegendNavigation="icon_legend_navigation";var p,v,y,m=[v.Plus,v.Minus,v.Action,v.Inaction],g=function(t){var e,n,r;try{for(var o=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}((r=v,Object.keys(r).filter(function(t){return Number.isNaN(+t)}))),a=o.next();!a.done;a=o.next()){var s=a.value;t.append("svg").attr("id",v[s]).attr("class","icon").attr("height",m.includes(v[s])?h.render.controlConnectorIconSize:h.render.iconSize).attr("width",m.includes(v[s])?h.render.controlConnectorIconSize:h.render.iconSize).html(i(254)("./".concat(v[s],".svg")))}}catch(t){e={error:t}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(e)throw e.error}}},_="M 0, 0  m -5, 0  a 5,5 0 1,0 10,0  a 5,5 0 1,0 -10,0",b="-7 -7 14 14";(tf=y||(y={})).Circle="marker_circle",tf.CircleDisabled="marker_circle_disabled",tf.Connector="marker_connector";var w=[{name:y.Circle,path:_,viewBox:b,stroke:h.render.color.stroke,strokeWidth:2,size:8,fill:h.render.color.stroke},{name:y.CircleDisabled,path:_,viewBox:b,stroke:"#76787A",strokeWidth:2,size:8,fill:"#76787A"},{name:y.Connector,path:_,viewBox:b,stroke:"#F2F5FF",strokeWidth:2,size:16,fill:"#35383C"}];function C(){}function x(t){return null==t?C:function(){return this.querySelector(t)}}function M(){return[]}function k(t){return null==t?M:function(){return this.querySelectorAll(t)}}function S(t){return function(){return this.matches(t)}}function N(t){return function(e){return e.matches(t)}}var E=Array.prototype.find;function L(){return this.firstElementChild}var O=Array.prototype.filter;function A(){return Array.from(this.children)}function T(t){return Array(t.length)}function B(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}function z(t,e,n,r,o,i){for(var a,s=0,l=e.length,c=i.length;s<c;++s)(a=e[s])?(a.__data__=i[s],r[s]=a):n[s]=new B(t,i[s]);for(;s<l;++s)(a=e[s])&&(o[s]=a)}function P(t,e,n,r,o,i,a){var s,l,c,u=new Map,d=e.length,h=i.length,f=Array(d);for(s=0;s<d;++s)(l=e[s])&&(f[s]=c=a.call(l,l.__data__,s,e)+"",u.has(c)?o[s]=l:u.set(c,l));for(s=0;s<h;++s)c=a.call(t,i[s],s,i)+"",(l=u.get(c))?(r[s]=l,l.__data__=i[s],u.delete(c)):n[s]=new B(t,i[s]);for(s=0;s<d;++s)(l=e[s])&&u.get(f[s])===l&&(o[s]=l)}function I(t){return t.__data__}function D(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}B.prototype={constructor:B,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};var Z="http://www.w3.org/1999/xhtml";let j={svg:"http://www.w3.org/2000/svg",xhtml:Z,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function V(t){var e=t+="",n=e.indexOf(":");return n>=0&&"xmlns"!==(e=t.slice(0,n))&&(t=t.slice(n+1)),j.hasOwnProperty(e)?{space:j[e],local:t}:t}function H(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function F(t,e){return t.style.getPropertyValue(e)||H(t).getComputedStyle(t,null).getPropertyValue(e)}function R(t){return t.trim().split(/^|\s+/)}function Y(t){return t.classList||new W(t)}function W(t){this._node=t,this._names=R(t.getAttribute("class")||"")}function X(t,e){for(var n=Y(t),r=-1,o=e.length;++r<o;)n.add(e[r])}function $(t,e){for(var n=Y(t),r=-1,o=e.length;++r<o;)n.remove(e[r])}function G(){this.textContent=""}function q(){this.innerHTML=""}function U(){this.nextSibling&&this.parentNode.appendChild(this)}function K(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function J(t){var e=V(t);return(e.local?function(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}:function(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===Z&&e.documentElement.namespaceURI===Z?e.createElement(t):e.createElementNS(n,t)}})(e)}function Q(){return null}function tt(){var t=this.parentNode;t&&t.removeChild(this)}function te(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function tn(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function tr(t){return function(){var e=this.__on;if(e){for(var n,r=0,o=-1,i=e.length;r<i;++r)n=e[r],t.type&&n.type!==t.type||n.name!==t.name?e[++o]=n:this.removeEventListener(n.type,n.listener,n.options);++o?e.length=o:delete this.__on}}}function to(t,e,n){return function(){var r,o=this.__on,i=function(t){e.call(this,t,this.__data__)};if(o){for(var a=0,s=o.length;a<s;++a)if((r=o[a]).type===t.type&&r.name===t.name)return this.removeEventListener(r.type,r.listener,r.options),this.addEventListener(r.type,r.listener=i,r.options=n),void(r.value=e)}this.addEventListener(t.type,i,n),r={type:t.type,name:t.name,value:e,listener:i,options:n},o?o.push(r):this.__on=[r]}}function ti(t,e,n){var r=H(t),o=r.CustomEvent;"function"==typeof o?o=new o(e,n):(o=r.document.createEvent("Event"),n?(o.initEvent(e,n.bubbles,n.cancelable),o.detail=n.detail):o.initEvent(e,!1,!1)),t.dispatchEvent(o)}W.prototype={add:function(t){0>this._names.indexOf(t)&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};var ta=[null];function ts(t,e){this._groups=t,this._parents=e}function tl(){return new ts([[document.documentElement]],ta)}ts.prototype=tl.prototype={constructor:ts,select:function(t){"function"!=typeof t&&(t=x(t));for(var e=this._groups,n=e.length,r=Array(n),o=0;o<n;++o)for(var i,a,s=e[o],l=s.length,c=r[o]=Array(l),u=0;u<l;++u)(i=s[u])&&(a=t.call(i,i.__data__,u,s))&&("__data__"in i&&(a.__data__=i.__data__),c[u]=a);return new ts(r,this._parents)},selectAll:function(t){var e;t="function"==typeof t?(e=t,function(){var t;return null==(t=e.apply(this,arguments))?[]:Array.isArray(t)?t:Array.from(t)}):k(t);for(var n=this._groups,r=n.length,o=[],i=[],a=0;a<r;++a)for(var s,l=n[a],c=l.length,u=0;u<c;++u)(s=l[u])&&(o.push(t.call(s,s.__data__,u,l)),i.push(s));return new ts(o,i)},selectChild:function(t){var e;return this.select(null==t?L:(e="function"==typeof t?t:N(t),function(){return E.call(this.children,e)}))},selectChildren:function(t){var e;return this.selectAll(null==t?A:(e="function"==typeof t?t:N(t),function(){return O.call(this.children,e)}))},filter:function(t){"function"!=typeof t&&(t=S(t));for(var e=this._groups,n=e.length,r=Array(n),o=0;o<n;++o)for(var i,a=e[o],s=a.length,l=r[o]=[],c=0;c<s;++c)(i=a[c])&&t.call(i,i.__data__,c,a)&&l.push(i);return new ts(r,this._parents)},data:function(t,e){if(!arguments.length)return Array.from(this,I);var n,r=e?P:z,o=this._parents,i=this._groups;"function"!=typeof t&&(n=t,t=function(){return n});for(var a=i.length,s=Array(a),l=Array(a),c=Array(a),u=0;u<a;++u){var d=o[u],h=i[u],f=h.length,p="object"==typeof(g=t.call(d,d&&d.__data__,u,o))&&"length"in g?g:Array.from(g),v=p.length,y=l[u]=Array(v),m=s[u]=Array(v);r(d,h,y,m,c[u]=Array(f),p,e);for(var g,_,b,w=0,C=0;w<v;++w)if(_=y[w]){for(w>=C&&(C=w+1);!(b=m[C])&&++C<v;);_._next=b||null}}return(s=new ts(s,o))._enter=l,s._exit=c,s},enter:function(){return new ts(this._enter||this._groups.map(T),this._parents)},exit:function(){return new ts(this._exit||this._groups.map(T),this._parents)},join:function(t,e,n){var r=this.enter(),o=this,i=this.exit();return"function"==typeof t?(r=t(r))&&(r=r.selection()):r=r.append(t+""),null!=e&&(o=e(o))&&(o=o.selection()),null==n?i.remove():n(i),r&&o?r.merge(o).order():o},merge:function(t){for(var e=t.selection?t.selection():t,n=this._groups,r=e._groups,o=n.length,i=r.length,a=Math.min(o,i),s=Array(o),l=0;l<a;++l)for(var c,u=n[l],d=r[l],h=u.length,f=s[l]=Array(h),p=0;p<h;++p)(c=u[p]||d[p])&&(f[p]=c);for(;l<o;++l)s[l]=n[l];return new ts(s,this._parents)},selection:function(){return this},order:function(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var r,o=t[e],i=o.length-1,a=o[i];--i>=0;)(r=o[i])&&(a&&4^r.compareDocumentPosition(a)&&a.parentNode.insertBefore(r,a),a=r);return this},sort:function(t){function e(e,n){return e&&n?t(e.__data__,n.__data__):!e-!n}t||(t=D);for(var n=this._groups,r=n.length,o=Array(r),i=0;i<r;++i){for(var a,s=n[i],l=s.length,c=o[i]=Array(l),u=0;u<l;++u)(a=s[u])&&(c[u]=a);c.sort(e)}return new ts(o,this._parents).order()},call:function(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this},nodes:function(){return Array.from(this)},node:function(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],o=0,i=r.length;o<i;++o){var a=r[o];if(a)return a}return null},size:function(){let t=0;for(let e of this)++t;return t},empty:function(){return!this.node()},each:function(t){for(var e=this._groups,n=0,r=e.length;n<r;++n)for(var o,i=e[n],a=0,s=i.length;a<s;++a)(o=i[a])&&t.call(o,o.__data__,a,i);return this},attr:function(t,e){var n=V(t);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((null==e?n.local?function(t){return function(){this.removeAttributeNS(t.space,t.local)}}:function(t){return function(){this.removeAttribute(t)}}:"function"==typeof e?n.local?function(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}:function(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttribute(t):this.setAttribute(t,n)}}:n.local?function(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}:function(t,e){return function(){this.setAttribute(t,e)}})(n,e))},style:function(t,e,n){return arguments.length>1?this.each((null==e?function(t){return function(){this.style.removeProperty(t)}}:"function"==typeof e?function(t,e,n){return function(){var r=e.apply(this,arguments);null==r?this.style.removeProperty(t):this.style.setProperty(t,r,n)}}:function(t,e,n){return function(){this.style.setProperty(t,e,n)}})(t,e,null==n?"":n)):F(this.node(),t)},property:function(t,e){return arguments.length>1?this.each((null==e?function(t){return function(){delete this[t]}}:"function"==typeof e?function(t,e){return function(){var n=e.apply(this,arguments);null==n?delete this[t]:this[t]=n}}:function(t,e){return function(){this[t]=e}})(t,e)):this.node()[t]},classed:function(t,e){var n=R(t+"");if(arguments.length<2){for(var r=Y(this.node()),o=-1,i=n.length;++o<i;)if(!r.contains(n[o]))return!1;return!0}return this.each(("function"==typeof e?function(t,e){return function(){(e.apply(this,arguments)?X:$)(this,t)}}:e?function(t){return function(){X(this,t)}}:function(t){return function(){$(this,t)}})(n,e))},text:function(t){return arguments.length?this.each(null==t?G:("function"==typeof t?function(t){return function(){var e=t.apply(this,arguments);this.textContent=null==e?"":e}}:function(t){return function(){this.textContent=t}})(t)):this.node().textContent},html:function(t){return arguments.length?this.each(null==t?q:("function"==typeof t?function(t){return function(){var e=t.apply(this,arguments);this.innerHTML=null==e?"":e}}:function(t){return function(){this.innerHTML=t}})(t)):this.node().innerHTML},raise:function(){return this.each(U)},lower:function(){return this.each(K)},append:function(t){var e="function"==typeof t?t:J(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})},insert:function(t,e){var n="function"==typeof t?t:J(t),r=null==e?Q:"function"==typeof e?e:x(e);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})},remove:function(){return this.each(tt)},clone:function(t){return this.select(t?tn:te)},datum:function(t){return arguments.length?this.property("__data__",t):this.node().__data__},on:function(t,e,n){var r,o,i=(t+"").trim().split(/^|\s+/).map(function(t){var e="",n=t.indexOf(".");return n>=0&&(e=t.slice(n+1),t=t.slice(0,n)),{type:t,name:e}}),a=i.length;if(!(arguments.length<2)){for(s=e?to:tr,r=0;r<a;++r)this.each(s(i[r],e,n));return this}var s=this.node().__on;if(s){for(var l,c=0,u=s.length;c<u;++c)for(r=0,l=s[c];r<a;++r)if((o=i[r]).type===l.type&&o.name===l.name)return l.value}},dispatch:function(t,e){return this.each(("function"==typeof e?function(t,e){return function(){return ti(this,t,e.apply(this,arguments))}}:function(t,e){return function(){return ti(this,t,e)}})(t,e))},[Symbol.iterator]:function*(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r,o=t[e],i=0,a=o.length;i<a;++i)(r=o[i])&&(yield r)}};var tc={value:()=>{}};function tu(){for(var t,e=0,n=arguments.length,r={};e<n;++e){if(!(t=arguments[e]+"")||t in r||/[\s.]/.test(t))throw Error("illegal type: "+t);r[t]=[]}return new td(r)}function td(t){this._=t}function th(t,e,n){for(var r=0,o=t.length;r<o;++r)if(t[r].name===e){t[r]=tc,t=t.slice(0,r).concat(t.slice(r+1));break}return null!=n&&t.push({name:e,value:n}),t}td.prototype=tu.prototype={constructor:td,on:function(t,e){var n,r=this._,o=(t+"").trim().split(/^|\s+/).map(function(t){var e="",n=t.indexOf(".");if(n>=0&&(e=t.slice(n+1),t=t.slice(0,n)),t&&!r.hasOwnProperty(t))throw Error("unknown type: "+t);return{type:t,name:e}}),i=-1,a=o.length;if(!(arguments.length<2)){if(null!=e&&"function"!=typeof e)throw Error("invalid callback: "+e);for(;++i<a;)if(n=(t=o[i]).type)r[n]=th(r[n],t.name,e);else if(null==e)for(n in r)r[n]=th(r[n],t.name,null);return this}for(;++i<a;)if((n=(t=o[i]).type)&&(n=function(t,e){for(var n,r=0,o=t.length;r<o;++r)if((n=t[r]).name===e)return n.value}(r[n],t.name)))return n},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new td(t)},call:function(t,e){if((n=arguments.length-2)>0)for(var n,r,o=Array(n),i=0;i<n;++i)o[i]=arguments[i+2];if(!this._.hasOwnProperty(t))throw Error("unknown type: "+t);for(i=0,n=(r=this._[t]).length;i<n;++i)r[i].value.apply(e,o)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw Error("unknown type: "+t);for(var r=this._[t],o=0,i=r.length;o<i;++o)r[o].value.apply(e,n)}};var tf,tp,tv,ty=0,tm=0,tg=0,t_=0,tb=0,tw=0,tC="object"==typeof performance&&performance.now?performance:Date,tx="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function tM(){return tb||(tx(tk),tb=tC.now()+tw)}function tk(){tb=0}function tS(){this._call=this._time=this._next=null}function tN(t,e,n){var r=new tS;return r.restart(t,e,n),r}function tE(){tb=(t_=tC.now())+tw,ty=tm=0;try{!function(){tM(),++ty;for(var t,e=tp;e;)(t=tb-e._time)>=0&&e._call.call(void 0,t),e=e._next;--ty}()}finally{ty=0,function(){for(var t,e,n=tp,r=1/0;n;)n._call?(r>n._time&&(r=n._time),t=n,n=n._next):(e=n._next,n._next=null,n=t?t._next=e:tp=e);tv=t,tO(r)}(),tb=0}}function tL(){var t=tC.now(),e=t-t_;e>1e3&&(tw-=e,t_=t)}function tO(t){ty||(tm&&(tm=clearTimeout(tm)),t-tb>24?(t<1/0&&(tm=setTimeout(tE,t-tC.now()-tw)),tg&&(tg=clearInterval(tg))):(tg||(t_=tC.now(),tg=setInterval(tL,1e3)),ty=1,tx(tE)))}function tA(t,e,n){var r=new tS;return e=null==e?0:+e,r.restart(n=>{r.stop(),t(n+e)},e,n),r}tS.prototype=tN.prototype={constructor:tS,restart:function(t,e,n){if("function"!=typeof t)throw TypeError("callback is not a function");n=(null==n?tM():+n)+(null==e?0:+e),this._next||tv===this||(tv?tv._next=this:tp=this,tv=this),this._call=t,this._time=n,tO()},stop:function(){this._call&&(this._call=null,this._time=1/0,tO())}};var tT=tu("start","end","cancel","interrupt"),tB=[];function tz(t,e,n,r,o,i){var a=t.__transition;if(a){if(n in a)return}else t.__transition={};!function(t,e,n){var r,o=t.__transition;function i(l){var c,u,d,h;if(1!==n.state)return s();for(c in o)if((h=o[c]).name===n.name){if(3===h.state)return tA(i);4===h.state?(h.state=6,h.timer.stop(),h.on.call("interrupt",t,t.__data__,h.index,h.group),delete o[c]):+c<e&&(h.state=6,h.timer.stop(),h.on.call("cancel",t,t.__data__,h.index,h.group),delete o[c])}if(tA(function(){3===n.state&&(n.state=4,n.timer.restart(a,n.delay,n.time),a(l))}),n.state=2,n.on.call("start",t,t.__data__,n.index,n.group),2===n.state){for(n.state=3,r=Array(d=n.tween.length),c=0,u=-1;c<d;++c)(h=n.tween[c].value.call(t,t.__data__,n.index,n.group))&&(r[++u]=h);r.length=u+1}}function a(e){for(var o=e<n.duration?n.ease.call(null,e/n.duration):(n.timer.restart(s),n.state=5,1),i=-1,a=r.length;++i<a;)r[i].call(t,o);5===n.state&&(n.on.call("end",t,t.__data__,n.index,n.group),s())}function s(){for(var r in n.state=6,n.timer.stop(),delete o[e],o)return;delete t.__transition}o[e]=n,n.timer=tN(function(t){n.state=1,n.timer.restart(i,n.delay,n.time),n.delay<=t&&i(t-n.delay)},0,n.time)}(t,n,{name:e,index:r,group:o,on:tT,tween:tB,time:i.time,delay:i.delay,duration:i.duration,ease:i.ease,timer:null,state:0})}function tP(t,e){var n=tD(t,e);if(n.state>0)throw Error("too late; already scheduled");return n}function tI(t,e){var n=tD(t,e);if(n.state>3)throw Error("too late; already running");return n}function tD(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw Error("transition not found");return n}function tZ(t,e){var n,r,o,i=t.__transition,a=!0;if(i){for(o in e=null==e?null:e+"",i)(n=i[o]).name===e?(r=n.state>2&&n.state<5,n.state=6,n.timer.stop(),n.on.call(r?"interrupt":"cancel",t,t.__data__,n.index,n.group),delete i[o]):a=!1;a&&delete t.__transition}}function tj(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}var tV,tH=180/Math.PI,tF={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function tR(t,e,n,r,o,i){var a,s,l;return(a=Math.sqrt(t*t+e*e))&&(t/=a,e/=a),(l=t*n+e*r)&&(n-=t*l,r-=e*l),(s=Math.sqrt(n*n+r*r))&&(n/=s,r/=s,l/=s),t*r<e*n&&(t=-t,e=-e,l=-l,a=-a),{translateX:o,translateY:i,rotate:Math.atan2(e,t)*tH,skewX:Math.atan(l)*tH,scaleX:a,scaleY:s}}function tY(t,e,n,r){function o(t){return t.length?t.pop()+" ":""}return function(i,a){var s,l,c,u,d=[],h=[];return i=t(i),a=t(a),function(t,r,o,i,a,s){if(t!==o||r!==i){var l=a.push("translate(",null,e,null,n);s.push({i:l-4,x:tj(t,o)},{i:l-2,x:tj(r,i)})}else(o||i)&&a.push("translate("+o+e+i+n)}(i.translateX,i.translateY,a.translateX,a.translateY,d,h),(s=i.rotate)!==(l=a.rotate)?(s-l>180?l+=360:l-s>180&&(s+=360),h.push({i:d.push(o(d)+"rotate(",null,r)-2,x:tj(s,l)})):l&&d.push(o(d)+"rotate("+l+r),(c=i.skewX)!==(u=a.skewX)?h.push({i:d.push(o(d)+"skewX(",null,r)-2,x:tj(c,u)}):u&&d.push(o(d)+"skewX("+u+r),function(t,e,n,r,i,a){if(t!==n||e!==r){var s=i.push(o(i)+"scale(",null,",",null,")");a.push({i:s-4,x:tj(t,n)},{i:s-2,x:tj(e,r)})}else 1===n&&1===r||i.push(o(i)+"scale("+n+","+r+")")}(i.scaleX,i.scaleY,a.scaleX,a.scaleY,d,h),i=a=null,function(t){for(var e,n=-1,r=h.length;++n<r;)d[(e=h[n]).i]=e.x(t);return d.join("")}}}var tW=tY(function(t){let e=new("function"==typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?tF:tR(e.a,e.b,e.c,e.d,e.e,e.f)},"px, ","px)","deg)"),tX=tY(function(t){return null==t?tF:(tV||(tV=document.createElementNS("http://www.w3.org/2000/svg","g")),tV.setAttribute("transform",t),(t=tV.transform.baseVal.consolidate())?tR((t=t.matrix).a,t.b,t.c,t.d,t.e,t.f):tF)},", ",")",")");function t$(t,e,n){var r=t._id;return t.each(function(){var t=tI(this,r);(t.value||(t.value={}))[e]=n.apply(this,arguments)}),function(t){return tD(t,r).value[e]}}function tG(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function tq(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function tU(){}var tK="\\s*([+-]?\\d+)\\s*",tJ="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",tQ="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",t1=/^#([0-9a-f]{3,8})$/,t0=RegExp(`^rgb\\(${tK},${tK},${tK}\\)$`),t2=RegExp(`^rgb\\(${tQ},${tQ},${tQ}\\)$`),t5=RegExp(`^rgba\\(${tK},${tK},${tK},${tJ}\\)$`),t4=RegExp(`^rgba\\(${tQ},${tQ},${tQ},${tJ}\\)$`),t6=RegExp(`^hsl\\(${tJ},${tQ},${tQ}\\)$`),t9=RegExp(`^hsla\\(${tJ},${tQ},${tQ},${tJ}\\)$`),t3={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function t7(){return this.rgb().formatHex()}function t8(){return this.rgb().formatRgb()}function et(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=t1.exec(t))?(n=e[1].length,e=parseInt(e[1],16),6===n?ee(e):3===n?new eo(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===n?en(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===n?en(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=t0.exec(t))?new eo(e[1],e[2],e[3],1):(e=t2.exec(t))?new eo(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=t5.exec(t))?en(e[1],e[2],e[3],e[4]):(e=t4.exec(t))?en(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=t6.exec(t))?eu(e[1],e[2]/100,e[3]/100,1):(e=t9.exec(t))?eu(e[1],e[2]/100,e[3]/100,e[4]):t3.hasOwnProperty(t)?ee(t3[t]):"transparent"===t?new eo(NaN,NaN,NaN,0):null}function ee(t){return new eo(t>>16&255,t>>8&255,255&t,1)}function en(t,e,n,r){return r<=0&&(t=e=n=NaN),new eo(t,e,n,r)}function er(t,e,n,r){var o;return 1==arguments.length?((o=t)instanceof tU||(o=et(o)),o?new eo((o=o.rgb()).r,o.g,o.b,o.opacity):new eo):new eo(t,e,n,null==r?1:r)}function eo(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}function ei(){return`#${ec(this.r)}${ec(this.g)}${ec(this.b)}`}function ea(){let t=es(this.opacity);return`${1===t?"rgb(":"rgba("}${el(this.r)}, ${el(this.g)}, ${el(this.b)}${1===t?")":`, ${t})`}`}function es(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function el(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function ec(t){return((t=el(t))<16?"0":"")+t.toString(16)}function eu(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new eh(t,e,n,r)}function ed(t){if(t instanceof eh)return new eh(t.h,t.s,t.l,t.opacity);if(t instanceof tU||(t=et(t)),!t)return new eh;if(t instanceof eh)return t;var e=(t=t.rgb()).r/255,n=t.g/255,r=t.b/255,o=Math.min(e,n,r),i=Math.max(e,n,r),a=NaN,s=i-o,l=(i+o)/2;return s?(a=e===i?(n-r)/s+6*(n<r):n===i?(r-e)/s+2:(e-n)/s+4,s/=l<.5?i+o:2-i-o,a*=60):s=l>0&&l<1?0:a,new eh(a,s,l,t.opacity)}function eh(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}function ef(t){return(t=(t||0)%360)<0?t+360:t}function ep(t){return Math.max(0,Math.min(1,t||0))}function ev(t,e,n){return 255*(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)}function ey(t,e,n,r,o){var i=t*t,a=i*t;return((1-3*t+3*i-a)*e+(4-6*i+3*a)*n+(1+3*t+3*i-3*a)*r+a*o)/6}tG(tU,et,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:t7,formatHex:t7,formatHex8:function(){return this.rgb().formatHex8()},formatHsl:function(){return ed(this).formatHsl()},formatRgb:t8,toString:t8}),tG(eo,er,tq(tU,{brighter(t){return t=null==t?1.4285714285714286:Math.pow(1.4285714285714286,t),new eo(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=null==t?.7:Math.pow(.7,t),new eo(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new eo(el(this.r),el(this.g),el(this.b),es(this.opacity))},displayable(){return -.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:ei,formatHex:ei,formatHex8:function(){return`#${ec(this.r)}${ec(this.g)}${ec(this.b)}${ec(255*(isNaN(this.opacity)?1:this.opacity))}`},formatRgb:ea,toString:ea})),tG(eh,function(t,e,n,r){return 1==arguments.length?ed(t):new eh(t,e,n,null==r?1:r)},tq(tU,{brighter(t){return t=null==t?1.4285714285714286:Math.pow(1.4285714285714286,t),new eh(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=null==t?.7:Math.pow(.7,t),new eh(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,o=2*n-r;return new eo(ev(t>=240?t-240:t+120,o,r),ev(t,o,r),ev(t<120?t+240:t-120,o,r),this.opacity)},clamp(){return new eh(ef(this.h),ep(this.s),ep(this.l),es(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){let t=es(this.opacity);return`${1===t?"hsl(":"hsla("}${ef(this.h)}, ${100*ep(this.s)}%, ${100*ep(this.l)}%${1===t?")":`, ${t})`}`}}));let em=t=>()=>t;function eg(t,e){var n=e-t;return n?function(e){return t+e*n}:em(isNaN(t)?e:t)}let e_=function t(e){var n,r=1==(n=+(n=e))?eg:function(t,e){var r,o,i;return e-t?(r=t,o=e,r=Math.pow(r,i=n),o=Math.pow(o,i)-r,i=1/i,function(t){return Math.pow(r+t*o,i)}):em(isNaN(t)?e:t)};function o(t,e){var n=r((t=er(t)).r,(e=er(e)).r),o=r(t.g,e.g),i=r(t.b,e.b),a=eg(t.opacity,e.opacity);return function(e){return t.r=n(e),t.g=o(e),t.b=i(e),t.opacity=a(e),t+""}}return o.gamma=t,o}(1);function eb(t){return function(e){var n,r,o=e.length,i=Array(o),a=Array(o),s=Array(o);for(n=0;n<o;++n)r=er(e[n]),i[n]=r.r||0,a[n]=r.g||0,s[n]=r.b||0;return i=t(i),a=t(a),s=t(s),r.opacity=1,function(t){return r.r=i(t),r.g=a(t),r.b=s(t),r+""}}}eb(function(t){var e=t.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,e-1):Math.floor(n*e),o=t[r],i=t[r+1],a=r>0?t[r-1]:2*o-i,s=r<e-1?t[r+2]:2*i-o;return ey((n-r/e)*e,a,o,i,s)}}),eb(function(t){var e=t.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*e),o=t[(r+e-1)%e],i=t[r%e],a=t[(r+1)%e],s=t[(r+2)%e];return ey((n-r/e)*e,o,i,a,s)}});var ew=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,eC=RegExp(ew.source,"g");function ex(t,e){var n,r,o,i,a,s=ew.lastIndex=eC.lastIndex=0,l=-1,c=[],u=[];for(t+="",e+="";(o=ew.exec(t))&&(i=eC.exec(e));)(a=i.index)>s&&(a=e.slice(s,a),c[l]?c[l]+=a:c[++l]=a),(o=o[0])===(i=i[0])?c[l]?c[l]+=i:c[++l]=i:(c[++l]=null,u.push({i:l,x:tj(o,i)})),s=eC.lastIndex;return s<e.length&&(a=e.slice(s),c[l]?c[l]+=a:c[++l]=a),c.length<2?u[0]?(n=u[0].x,function(t){return n(t)+""}):(r=e,function(){return r}):(e=u.length,function(t){for(var n,r=0;r<e;++r)c[(n=u[r]).i]=n.x(t);return c.join("")})}function eM(t,e){var n;return("number"==typeof e?tj:e instanceof et?e_:(n=et(e))?(e=n,e_):ex)(t,e)}var ek=tl.prototype.constructor;function eS(t){return function(){this.style.removeProperty(t)}}var eN=0;function eE(t,e,n,r){this._groups=t,this._parents=e,this._name=n,this._id=r}var eL=tl.prototype;eE.prototype=(function(t){return tl().transition(t)}).prototype={constructor:eE,select:function(t){var e=this._name,n=this._id;"function"!=typeof t&&(t=x(t));for(var r=this._groups,o=r.length,i=Array(o),a=0;a<o;++a)for(var s,l,c=r[a],u=c.length,d=i[a]=Array(u),h=0;h<u;++h)(s=c[h])&&(l=t.call(s,s.__data__,h,c))&&("__data__"in s&&(l.__data__=s.__data__),d[h]=l,tz(d[h],e,n,h,d,tD(s,n)));return new eE(i,this._parents,e,n)},selectAll:function(t){var e=this._name,n=this._id;"function"!=typeof t&&(t=k(t));for(var r=this._groups,o=r.length,i=[],a=[],s=0;s<o;++s)for(var l,c=r[s],u=c.length,d=0;d<u;++d)if(l=c[d]){for(var h,f=t.call(l,l.__data__,d,c),p=tD(l,n),v=0,y=f.length;v<y;++v)(h=f[v])&&tz(h,e,n,v,f,p);i.push(f),a.push(l)}return new eE(i,a,e,n)},selectChild:eL.selectChild,selectChildren:eL.selectChildren,filter:function(t){"function"!=typeof t&&(t=S(t));for(var e=this._groups,n=e.length,r=Array(n),o=0;o<n;++o)for(var i,a=e[o],s=a.length,l=r[o]=[],c=0;c<s;++c)(i=a[c])&&t.call(i,i.__data__,c,a)&&l.push(i);return new eE(r,this._parents,this._name,this._id)},merge:function(t){if(t._id!==this._id)throw Error();for(var e=this._groups,n=t._groups,r=e.length,o=n.length,i=Math.min(r,o),a=Array(r),s=0;s<i;++s)for(var l,c=e[s],u=n[s],d=c.length,h=a[s]=Array(d),f=0;f<d;++f)(l=c[f]||u[f])&&(h[f]=l);for(;s<r;++s)a[s]=e[s];return new eE(a,this._parents,this._name,this._id)},selection:function(){return new ek(this._groups,this._parents)},transition:function(){for(var t=this._name,e=this._id,n=++eN,r=this._groups,o=r.length,i=0;i<o;++i)for(var a,s=r[i],l=s.length,c=0;c<l;++c)if(a=s[c]){var u=tD(a,e);tz(a,t,n,c,s,{time:u.time+u.delay+u.duration,delay:0,duration:u.duration,ease:u.ease})}return new eE(r,this._parents,t,n)},call:eL.call,nodes:eL.nodes,node:eL.node,size:eL.size,empty:eL.empty,each:eL.each,on:function(t,e){var n,r,o,i=this._id;return arguments.length<2?tD(this.node(),i).on.on(t):this.each((o=(t+"").trim().split(/^|\s+/).every(function(t){var e=t.indexOf(".");return e>=0&&(t=t.slice(0,e)),!t||"start"===t})?tP:tI,function(){var a=o(this,i),s=a.on;s!==n&&(r=(n=s).copy()).on(t,e),a.on=r}))},attr:function(t,e){var n=V(t),r="transform"===n?tX:eM;return this.attrTween(t,"function"==typeof e?(n.local?function(t,e,n){var r,o,i;return function(){var a,s,l=n(this);if(null!=l)return(a=this.getAttributeNS(t.space,t.local))===(s=l+"")?null:a===r&&s===o?i:(o=s,i=e(r=a,l));this.removeAttributeNS(t.space,t.local)}}:function(t,e,n){var r,o,i;return function(){var a,s,l=n(this);if(null!=l)return(a=this.getAttribute(t))===(s=l+"")?null:a===r&&s===o?i:(o=s,i=e(r=a,l));this.removeAttribute(t)}})(n,r,t$(this,"attr."+t,e)):null==e?(n.local?function(t){return function(){this.removeAttributeNS(t.space,t.local)}}:function(t){return function(){this.removeAttribute(t)}})(n):(n.local?function(t,e,n){var r,o,i=n+"";return function(){var a=this.getAttributeNS(t.space,t.local);return a===i?null:a===r?o:o=e(r=a,n)}}:function(t,e,n){var r,o,i=n+"";return function(){var a=this.getAttribute(t);return a===i?null:a===r?o:o=e(r=a,n)}})(n,r,e))},attrTween:function(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(null==e)return this.tween(n,null);if("function"!=typeof e)throw Error();var r=V(t);return this.tween(n,(r.local?function(t,e){var n,r;function o(){var o=e.apply(this,arguments);return o!==r&&(n=(r=o)&&function(e){this.setAttributeNS(t.space,t.local,o.call(this,e))}),n}return o._value=e,o}:function(t,e){var n,r;function o(){var o=e.apply(this,arguments);return o!==r&&(n=(r=o)&&function(e){this.setAttribute(t,o.call(this,e))}),n}return o._value=e,o})(r,e))},style:function(t,e,n){var r,o,i,a,s,l,c,u,d,h,f,p,v,y,m,g,_,b,w,C,x,M="transform"==(t+="")?tW:eM;return null==e?this.styleTween(t,(r=t,function(){var t=F(this,r),e=(this.style.removeProperty(r),F(this,r));return t===e?null:t===o&&e===i?a:a=M(o=t,i=e)})).on("end.style."+t,eS(t)):"function"==typeof e?this.styleTween(t,(s=t,l=t$(this,"style."+t,e),function(){var t=F(this,s),e=l(this),n=e+"";return null==e&&(this.style.removeProperty(s),n=e=F(this,s)),t===n?null:t===c&&n===u?d:(u=n,d=M(c=t,e))})).each((h=this._id,_="end."+(g="style."+(f=t)),function(){var t=tI(this,h),e=t.on,n=null==t.value[g]?m||(m=eS(f)):void 0;e===p&&y===n||(v=(p=e).copy()).on(_,y=n),t.on=v})):this.styleTween(t,(b=t,x=e+"",function(){var t=F(this,b);return t===x?null:t===w?C:C=M(w=t,e)}),n).on("end.style."+t,null)},styleTween:function(t,e,n){var r="style."+(t+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(null==e)return this.tween(r,null);if("function"!=typeof e)throw Error();return this.tween(r,function(t,e,n){var r,o;function i(){var i=e.apply(this,arguments);return i!==o&&(r=(o=i)&&function(e){this.style.setProperty(t,i.call(this,e),n)}),r}return i._value=e,i}(t,e,null==n?"":n))},text:function(t){var e,n;return this.tween("text","function"==typeof t?(e=t$(this,"text",t),function(){var t=e(this);this.textContent=null==t?"":t}):(n=null==t?"":t+"",function(){this.textContent=n}))},textTween:function(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(null==t)return this.tween(e,null);if("function"!=typeof t)throw Error();return this.tween(e,function(t){var e,n;function r(){var r=t.apply(this,arguments);return r!==n&&(e=(n=r)&&function(t){this.textContent=r.call(this,t)}),e}return r._value=t,r}(t))},remove:function(){var t;return this.on("end.remove",(t=this._id,function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==t)return;e&&e.removeChild(this)}))},tween:function(t,e){var n=this._id;if(t+="",arguments.length<2){for(var r,o=tD(this.node(),n).tween,i=0,a=o.length;i<a;++i)if((r=o[i]).name===t)return r.value;return null}return this.each((null==e?function(t,e){var n,r;return function(){var o=tI(this,t),i=o.tween;if(i!==n){for(var a=0,s=(r=n=i).length;a<s;++a)if(r[a].name===e){(r=r.slice()).splice(a,1);break}}o.tween=r}}:function(t,e,n){var r,o;if("function"!=typeof n)throw Error();return function(){var i=tI(this,t),a=i.tween;if(a!==r){o=(r=a).slice();for(var s={name:e,value:n},l=0,c=o.length;l<c;++l)if(o[l].name===e){o[l]=s;break}l===c&&o.push(s)}i.tween=o}})(n,t,e))},delay:function(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?function(t,e){return function(){tP(this,t).delay=+e.apply(this,arguments)}}:function(t,e){return e=+e,function(){tP(this,t).delay=e}})(e,t)):tD(this.node(),e).delay},duration:function(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?function(t,e){return function(){tI(this,t).duration=+e.apply(this,arguments)}}:function(t,e){return e=+e,function(){tI(this,t).duration=e}})(e,t)):tD(this.node(),e).duration},ease:function(t){var e=this._id;return arguments.length?this.each(function(t,e){if("function"!=typeof e)throw Error();return function(){tI(this,t).ease=e}}(e,t)):tD(this.node(),e).ease},easeVarying:function(t){var e;if("function"!=typeof t)throw Error();return this.each((e=this._id,function(){var n=t.apply(this,arguments);if("function"!=typeof n)throw Error();tI(this,e).ease=n}))},end:function(){var t,e,n=this,r=n._id,o=n.size();return new Promise(function(i,a){var s={value:a},l={value:function(){0==--o&&i()}};n.each(function(){var n=tI(this,r),o=n.on;o!==t&&((e=(t=o).copy())._.cancel.push(s),e._.interrupt.push(s),e._.end.push(l)),n.on=e}),0===o&&i()})},[Symbol.iterator]:eL[Symbol.iterator]};var eO={time:null,delay:0,duration:250,ease:function(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}};tl.prototype.interrupt=function(t){return this.each(function(){tZ(this,t)})},tl.prototype.transition=function(t){var e,n;t instanceof eE?(e=t._id,t=t._name):(e=++eN,(n=eO).time=tM(),t=null==t?null:t+"");for(var r=this._groups,o=r.length,i=0;i<o;++i)for(var a,s=r[i],l=s.length,c=0;c<l;++c)(a=s[c])&&tz(a,t,e,c,s,n||function(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))throw Error(`transition ${e} not found`);return n}(a,e));return new eE(r,this._parents,t,e)};let{abs:eA,max:eT,min:eB}=Math;function ez(t){return{type:t}}function eP(t){return"string"==typeof t?new ts([[document.querySelector(t)]],[document.documentElement]):new ts([[t]],ta)}function eI(t,e){if(t=function(t){let e;for(;e=t.sourceEvent;)t=e;return t}(t),void 0===e&&(e=t.currentTarget),e){var n=e.ownerSVGElement||e;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=t.clientX,r.y=t.clientY,[(r=r.matrixTransform(e.getScreenCTM().inverse())).x,r.y]}if(e.getBoundingClientRect){var o=e.getBoundingClientRect();return[t.clientX-o.left-e.clientLeft,t.clientY-o.top-e.clientTop]}}return[t.pageX,t.pageY]}["w","e"].map(ez),["n","s"].map(ez),["n","w","e","s","nw","ne","sw","se"].map(ez);let eD={passive:!1},eZ={capture:!0,passive:!1};function ej(t){t.stopImmediatePropagation()}function eV(t){t.preventDefault(),t.stopImmediatePropagation()}function eH(t){var e=t.document.documentElement,n=eP(t).on("dragstart.drag",eV,eZ);"onselectstart"in e?n.on("selectstart.drag",eV,eZ):(e.__noselect=e.style.MozUserSelect,e.style.MozUserSelect="none")}function eF(t,e){var n=t.document.documentElement,r=eP(t).on("dragstart.drag",null);e&&(r.on("click.drag",eV,eZ),setTimeout(function(){r.on("click.drag",null)},0)),"onselectstart"in n?r.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}let eR=t=>()=>t;function eY(t,{sourceEvent:e,subject:n,target:r,identifier:o,active:i,x:a,y:s,dx:l,dy:c,dispatch:u}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:r,enumerable:!0,configurable:!0},identifier:{value:o,enumerable:!0,configurable:!0},active:{value:i,enumerable:!0,configurable:!0},x:{value:a,enumerable:!0,configurable:!0},y:{value:s,enumerable:!0,configurable:!0},dx:{value:l,enumerable:!0,configurable:!0},dy:{value:c,enumerable:!0,configurable:!0},_:{value:u}})}function eW(t){return!t.ctrlKey&&!t.button}function eX(){return this.parentNode}function e$(t,e){return null==e?{x:t.x,y:t.y}:e}function eG(){return navigator.maxTouchPoints||"ontouchstart"in this}function eq(){var t,e,n,r,o=eW,i=eX,a=e$,s=eG,l={},c=tu("start","drag","end"),u=0,d=0;function h(t){t.on("mousedown.drag",f).filter(s).on("touchstart.drag",y).on("touchmove.drag",m,eD).on("touchend.drag touchcancel.drag",g).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function f(a,s){if(!r&&o.call(this,a,s)){var l=_(this,i.call(this,a,s),a,s,"mouse");l&&(eP(a.view).on("mousemove.drag",p,eZ).on("mouseup.drag",v,eZ),eH(a.view),ej(a),n=!1,t=a.clientX,e=a.clientY,l("start",a))}}function p(r){if(eV(r),!n){var o=r.clientX-t,i=r.clientY-e;n=o*o+i*i>d}l.mouse("drag",r)}function v(t){eP(t.view).on("mousemove.drag mouseup.drag",null),eF(t.view,n),eV(t),l.mouse("end",t)}function y(t,e){if(o.call(this,t,e)){var n,r,a=t.changedTouches,s=i.call(this,t,e),l=a.length;for(n=0;n<l;++n)(r=_(this,s,t,e,a[n].identifier,a[n]))&&(ej(t),r("start",t,a[n]))}}function m(t){var e,n,r=t.changedTouches,o=r.length;for(e=0;e<o;++e)(n=l[r[e].identifier])&&(eV(t),n("drag",t,r[e]))}function g(t){var e,n,o=t.changedTouches,i=o.length;for(r&&clearTimeout(r),r=setTimeout(function(){r=null},500),e=0;e<i;++e)(n=l[o[e].identifier])&&(ej(t),n("end",t,o[e]))}function _(t,e,n,r,o,i){var s,d,f,p=c.copy(),v=eI(i||n,e);if(null!=(f=a.call(t,new eY("beforestart",{sourceEvent:n,target:h,identifier:o,active:u,x:v[0],y:v[1],dx:0,dy:0,dispatch:p}),r)))return s=f.x-v[0]||0,d=f.y-v[1]||0,function n(i,a,c){var y,m=v;switch(i){case"start":l[o]=n,y=u++;break;case"end":delete l[o],--u;case"drag":v=eI(c||a,e),y=u}p.call(i,t,new eY(i,{sourceEvent:a,subject:f,target:h,identifier:o,active:y,x:v[0]+s,y:v[1]+d,dx:v[0]-m[0],dy:v[1]-m[1],dispatch:p}),r)}}return h.filter=function(t){return arguments.length?(o="function"==typeof t?t:eR(!!t),h):o},h.container=function(t){return arguments.length?(i="function"==typeof t?t:eR(t),h):i},h.subject=function(t){return arguments.length?(a="function"==typeof t?t:eR(t),h):a},h.touchable=function(t){return arguments.length?(s="function"==typeof t?t:eR(!!t),h):s},h.on=function(){var t=c.on.apply(c,arguments);return t===c?h:t},h.clickDistance=function(t){return arguments.length?(d=(t=+t)*t,h):Math.sqrt(d)},h}eY.prototype.on=function(){var t=this._.on.apply(this._,arguments);return t===this._?this:t};var eU=Math.sqrt(50),eK=Math.sqrt(10),eJ=Math.sqrt(2);function eQ(t,e,n){var r=(e-t)/Math.max(0,n),o=Math.floor(Math.log(r)/Math.LN10),i=r/Math.pow(10,o);return o>=0?(i>=eU?10:i>=eK?5:i>=eJ?2:1)*Math.pow(10,o):-Math.pow(10,-o)/(i>=eU?10:i>=eK?5:i>=eJ?2:1)}function e1(t,e){return null==t||null==e?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function e0(t,e){return null==t||null==e?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function e2(t){let e,n,r;function o(t,r,o=0,i=t.length){if(o<i){if(0!==e(r,r))return i;do{let e=o+i>>>1;0>n(t[e],r)?o=e+1:i=e}while(o<i)}return o}return 2!==t.length?(e=e1,n=(e,n)=>e1(t(e),n),r=(e,n)=>t(e)-n):(e=t===e1||t===e0?t:e5,n=t,r=t),{left:o,center:function(t,e,n=0,i=t.length){let a=o(t,e,n,i-1);return a>n&&r(t[a-1],e)>-r(t[a],e)?a-1:a},right:function(t,r,o=0,i=t.length){if(o<i){if(0!==e(r,r))return i;do{let e=o+i>>>1;0>=n(t[e],r)?o=e+1:i=e}while(o<i)}return o}}}function e5(){return 0}let e4=e2(e1),e6=e4.right,e9=(e4.left,e2(function(t){return null===t?NaN:+t}).center,e6);function e3(t,e){return t=+t,e=+e,function(n){return Math.round(t*(1-n)+e*n)}}function e7(t){return+t}var e8=[0,1];function nt(t){return t}function ne(t,e){var n;return(e-=t=+t)?function(n){return(n-t)/e}:(n=isNaN(e)?NaN:.5,function(){return n})}function nn(t,e,n){var r=t[0],o=t[1],i=e[0],a=e[1];return o<r?(r=ne(o,r),i=n(a,i)):(r=ne(r,o),i=n(i,a)),function(t){return i(r(t))}}function nr(t,e,n){var r=Math.min(t.length,e.length)-1,o=Array(r),i=Array(r),a=-1;for(t[r]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++a<r;)o[a]=ne(t[a],t[a+1]),i[a]=n(e[a],e[a+1]);return function(e){var n=e9(t,e,1,r)-1;return i[n](o[n](e))}}function no(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t)}return this}var ni,na=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function ns(t){var e;if(!(e=na.exec(t)))throw Error("invalid format: "+t);return new nl({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}function nl(t){this.fill=void 0===t.fill?" ":t.fill+"",this.align=void 0===t.align?">":t.align+"",this.sign=void 0===t.sign?"-":t.sign+"",this.symbol=void 0===t.symbol?"":t.symbol+"",this.zero=!!t.zero,this.width=void 0===t.width?void 0:+t.width,this.comma=!!t.comma,this.precision=void 0===t.precision?void 0:+t.precision,this.trim=!!t.trim,this.type=void 0===t.type?"":t.type+""}function nc(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,r=t.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+t.slice(n+1)]}function nu(t){return(t=nc(Math.abs(t)))?t[1]:NaN}function nd(t,e){var n=nc(t,e);if(!n)return t+"";var r=n[0],o=n[1];return o<0?"0."+Array(-o).join("0")+r:r.length>o+1?r.slice(0,o+1)+"."+r.slice(o+1):r+Array(o-r.length+2).join("0")}ns.prototype=nl.prototype,nl.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};let nh={"%":(t,e)=>(100*t).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:function(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)},e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>nd(100*t,e),r:nd,s:function(t,e){var n=nc(t,e);if(!n)return t+"";var r=n[0],o=n[1],i=o-(ni=3*Math.max(-8,Math.min(8,Math.floor(o/3))))+1,a=r.length;return i===a?r:i>a?r+Array(i-a+1).join("0"):i>0?r.slice(0,i)+"."+r.slice(i):"0."+Array(1-i).join("0")+nc(t,Math.max(0,e+i-1))[0]},X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function nf(t){return t}var np,nv,ny,nm=Array.prototype.map,ng=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function n_(t){return eP(J(t).call(document.documentElement))}nv=(np=function(t){var e,n,r,o=void 0===t.grouping||void 0===t.thousands?nf:(n=nm.call(t.grouping,Number),r=t.thousands+"",function(t,e){for(var o=t.length,i=[],a=0,s=n[0],l=0;o>0&&s>0&&(l+s+1>e&&(s=Math.max(1,e-l)),i.push(t.substring(o-=s,o+s)),!((l+=s+1)>e));)s=n[a=(a+1)%n.length];return i.reverse().join(r)}),i=void 0===t.currency?"":t.currency[0]+"",a=void 0===t.currency?"":t.currency[1]+"",s=void 0===t.decimal?".":t.decimal+"",l=void 0===t.numerals?nf:(e=nm.call(t.numerals,String),function(t){return t.replace(/[0-9]/g,function(t){return e[+t]})}),c=void 0===t.percent?"%":t.percent+"",u=void 0===t.minus?"−":t.minus+"",d=void 0===t.nan?"NaN":t.nan+"";function h(t){var e=(t=ns(t)).fill,n=t.align,r=t.sign,h=t.symbol,f=t.zero,p=t.width,v=t.comma,y=t.precision,m=t.trim,g=t.type;"n"===g?(v=!0,g="g"):nh[g]||(void 0===y&&(y=12),m=!0,g="g"),(f||"0"===e&&"="===n)&&(f=!0,e="0",n="=");var _="$"===h?i:"#"===h&&/[boxX]/.test(g)?"0"+g.toLowerCase():"",b="$"===h?a:/[%p]/.test(g)?c:"",w=nh[g],C=/[defgprs%]/.test(g);function x(t){var i,a,c,h=_,x=b;if("c"===g)x=w(t)+x,t="";else{var M=(t=+t)<0||1/t<0;if(t=isNaN(t)?d:w(Math.abs(t),y),m&&(t=function(t){t:for(var e,n=t.length,r=1,o=-1;r<n;++r)switch(t[r]){case".":o=e=r;break;case"0":0===o&&(o=r),e=r;break;default:if(!+t[r])break t;o>0&&(o=0)}return o>0?t.slice(0,o)+t.slice(e+1):t}(t)),M&&0==+t&&"+"!==r&&(M=!1),h=(M?"("===r?r:u:"-"===r||"("===r?"":r)+h,x=("s"===g?ng[8+ni/3]:"")+x+(M&&"("===r?")":""),C){for(i=-1,a=t.length;++i<a;)if(48>(c=t.charCodeAt(i))||c>57){x=(46===c?s+t.slice(i+1):t.slice(i))+x,t=t.slice(0,i);break}}}v&&!f&&(t=o(t,1/0));var k=h.length+t.length+x.length,S=k<p?Array(p-k+1).join(e):"";switch(v&&f&&(t=o(S+t,S.length?p-x.length:1/0),S=""),n){case"<":t=h+t+x+S;break;case"=":t=h+S+t+x;break;case"^":t=S.slice(0,k=S.length>>1)+h+t+x+S.slice(k);break;default:t=S+h+t+x}return l(t)}return y=void 0===y?6:/[gprs]/.test(g)?Math.max(1,Math.min(21,y)):Math.max(0,Math.min(20,y)),x.toString=function(){return t+""},x}return{format:h,formatPrefix:function(t,e){var n=h(((t=ns(t)).type="f",t)),r=3*Math.max(-8,Math.min(8,Math.floor(nu(e)/3))),o=Math.pow(10,-r),i=ng[8+r/3];return function(t){return n(o*t)+i}}}}({thousands:",",grouping:[3],currency:["$",""]})).format,ny=np.formatPrefix;let nb=Math.PI,nw=2*nb,nC=nw-1e-6;function nx(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function nM(){return new nx}nx.prototype=nM.prototype={constructor:nx,moveTo:function(t,e){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)},closePath:function(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(t,e){this._+="L"+(this._x1=+t)+","+(this._y1=+e)},quadraticCurveTo:function(t,e,n,r){this._+="Q"+ +t+","+ +e+","+(this._x1=+n)+","+(this._y1=+r)},bezierCurveTo:function(t,e,n,r,o,i){this._+="C"+ +t+","+ +e+","+ +n+","+ +r+","+(this._x1=+o)+","+(this._y1=+i)},arcTo:function(t,e,n,r,o){t=+t,e=+e,n=+n,r=+r,o=+o;var i=this._x1,a=this._y1,s=n-t,l=r-e,c=i-t,u=a-e,d=c*c+u*u;if(o<0)throw Error("negative radius: "+o);if(null===this._x1)this._+="M"+(this._x1=t)+","+(this._y1=e);else if(d>1e-6){if(Math.abs(u*s-l*c)>1e-6&&o){var h=n-i,f=r-a,p=s*s+l*l,v=Math.sqrt(p),y=Math.sqrt(d),m=o*Math.tan((nb-Math.acos((p+d-(h*h+f*f))/(2*v*y)))/2),g=m/y,_=m/v;Math.abs(g-1)>1e-6&&(this._+="L"+(t+g*c)+","+(e+g*u)),this._+="A"+o+","+o+",0,0,"+ +(u*h>c*f)+","+(this._x1=t+_*s)+","+(this._y1=e+_*l)}else this._+="L"+(this._x1=t)+","+(this._y1=e)}},arc:function(t,e,n,r,o,i){t=+t,e=+e,i=!!i;var a=(n=+n)*Math.cos(r),s=n*Math.sin(r),l=t+a,c=e+s,u=1^i,d=i?r-o:o-r;if(n<0)throw Error("negative radius: "+n);null===this._x1?this._+="M"+l+","+c:(Math.abs(this._x1-l)>1e-6||Math.abs(this._y1-c)>1e-6)&&(this._+="L"+l+","+c),n&&(d<0&&(d=d%nw+nw),d>nC?this._+="A"+n+","+n+",0,1,"+u+","+(t-a)+","+(e-s)+"A"+n+","+n+",0,1,"+u+","+(this._x1=l)+","+(this._y1=c):d>1e-6&&(this._+="A"+n+","+n+",0,"+ +(d>=nb)+","+u+","+(this._x1=t+n*Math.cos(o))+","+(this._y1=e+n*Math.sin(o))))},rect:function(t,e,n,r){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)+"h"+ +n+"v"+ +r+"h"+-n+"Z"},toString:function(){return this._}};var nk=Array.prototype.slice;function nS(t){return function(){return t}}class nN{constructor(t,e){this._context=t,this._x=e}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line}point(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,e,t,e):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+e)/2,t,this._y0,t,e)}this._x0=t,this._y0=e}}function nE(t){return t[0]}function nL(t){return t[1]}function nO(t){return t.source}function nA(t){return t.target}function nT(t){return((t=Math.exp(t))+1/t)/2}let nB=function t(e,n,r){function o(t,o){var i,a,s=t[0],l=t[1],c=t[2],u=o[0],d=o[1],h=o[2],f=u-s,p=d-l,v=f*f+p*p;if(v<1e-12)a=Math.log(h/c)/e,i=function(t){return[s+t*f,l+t*p,c*Math.exp(e*t*a)]};else{var y=Math.sqrt(v),m=(h*h-c*c+r*v)/(2*c*n*y),g=(h*h-c*c-r*v)/(2*h*n*y),_=Math.log(Math.sqrt(m*m+1)-m);a=(Math.log(Math.sqrt(g*g+1)-g)-_)/e,i=function(t){var r,o,i=t*a,u=nT(_),d=c/(n*y)*(((o=Math.exp(2*(o=e*i+_)))-1)/(o+1)*u-((r=Math.exp(r=_))-1/r)/2);return[s+d*f,l+d*p,c*u/nT(e*i+_)]}}return i.duration=1e3*a*e/Math.SQRT2,i}return o.rho=function(e){var n=Math.max(.001,+e),r=n*n;return t(n,r,r*r)},o}(Math.SQRT2,2,4),nz=t=>()=>t;function nP(t,{sourceEvent:e,target:n,transform:r,dispatch:o}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:r,enumerable:!0,configurable:!0},_:{value:o}})}function nI(t,e,n){this.k=t,this.x=e,this.y=n}nI.prototype={constructor:nI,scale:function(t){return 1===t?this:new nI(this.k*t,this.x,this.y)},translate:function(t,e){return 0===t&0===e?this:new nI(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var nD,nZ=new nI(1,0,0);function nj(t){t.stopImmediatePropagation()}function nV(t){t.preventDefault(),t.stopImmediatePropagation()}function nH(t){return!(t.ctrlKey&&"wheel"!==t.type||t.button)}function nF(){var t=this;return t instanceof SVGElement?(t=t.ownerSVGElement||t).hasAttribute("viewBox")?[[(t=t.viewBox.baseVal).x,t.y],[t.x+t.width,t.y+t.height]]:[[0,0],[t.width.baseVal.value,t.height.baseVal.value]]:[[0,0],[t.clientWidth,t.clientHeight]]}function nR(){return this.__zoom||nZ}function nY(t){return-t.deltaY*(1===t.deltaMode?.05:t.deltaMode?1:.002)*(t.ctrlKey?10:1)}function nW(){return navigator.maxTouchPoints||"ontouchstart"in this}function nX(t,e,n){var r=t.invertX(e[0][0])-n[0][0],o=t.invertX(e[1][0])-n[1][0],i=t.invertY(e[0][1])-n[0][1],a=t.invertY(e[1][1])-n[1][1];return t.translate(o>r?(r+o)/2:Math.min(0,r)||Math.max(0,o),a>i?(i+a)/2:Math.min(0,i)||Math.max(0,a))}function n$(t,e){var n=!1;"#"===t[0]&&(t=t.slice(1),n=!0);var r=parseInt(t,16),o=(r>>16)+e;o>255?o=255:o<0&&(o=0);var i=(r>>8&255)+e;i>255?i=255:i<0&&(i=0);var a=(255&r)+e;a>255?a=255:a<0&&(a=0);var s=a|i<<8|o<<16;return n?"#"+s.toString(16):s.toString(16)}nI.prototype,(nD||(nD={})).ErrorMarker="error_marker";var nG,nq=function(t){var e=t.x,n=t.y,r=t.w,o=t.h,i=t.r,a=void 0===i?0:i,s=t.border,l={tl:!1,tr:!1,br:!1,bl:!1};a&&(s?(l.tl=s[0],l.tr=s[1],l.br=s[3],l.bl=s[2]):(l.tl=!0,l.tr=!0,l.br=!0,l.bl=!0));var c="M"+(e+a)+","+n+"h"+(r-2*a);return l.tr?c+="a"+a+","+a+" 0 0 1 "+a+","+a:c+="h"+a+"v"+a,c+="v"+(o-2*a),l.br?c+="a"+a+","+a+" 0 0 1 "+-a+","+a:c+="v"+a+"h"+-a,c+="h"+(2*a-r),l.bl?c+="a"+a+","+a+" 0 0 1 "+-a+","+-a:c+="h"+-a+"v"+-a,c+="v"+(2*a-o),l.tl?c+="a"+a+","+a+" 0 0 1 "+a+","+-a:c+="v"+-a+"h"+a,c+"z"},nU="clip-border-",nK="clip-",nJ=h.render.strokeSize/2,nQ=2*nJ,n1=function(t){var e=t.id,n=t.width,r=t.height,o=t.element,i=t.r;o.append("clipPath").attr("id",nK+e).append("path").attr("d",nq({x:nJ,y:nJ,w:n-2*nJ,h:r-2*nJ,r:i})),o.attr("clip-path","url(#".concat(nK).concat(e,")"))},n0=function(t,e,n){void 0===e&&(e=!1),void 0===n&&(n=!1);var r=n_("svg:g");return r.append("circle").attr("class","connector_circle").attr("r",h.render.node.control.connectorRadius-h.render.strokeSize).attr("fill",h.render.color.elementBackground).attr("stroke",n?h.render.color.disabledStroke:h.render.color.stroke).attr("stroke-width",h.render.strokeSize).attr("cx",h.render.node.control.connectorRadius).attr("cy",h.render.node.control.connectorRadius),r.append("use").style("color",h.render.tool.textColor).attr("x",2).attr("y",2).attr("href","#".concat(t)).style("opacity",n?.4:1),e&&r.on("mouseover",function(){eP(this).select(".connector_circle").attr("fill",h.render.color.elementBackgroundHover2)}).on("mouseout",function(){eP(this).select(".connector_circle").attr("fill",h.render.color.elementBackground)}),r},n2=(function(t){let e=nO,n=nA,r=nE,o=nL,i=null,a=null;function s(){let s;let l=nk.call(arguments),c=e.apply(this,l),u=n.apply(this,l);if(null==i&&(a=t(s=nM())),a.lineStart(),l[0]=c,a.point(+r.apply(this,l),+o.apply(this,l)),l[0]=u,a.point(+r.apply(this,l),+o.apply(this,l)),a.lineEnd(),s)return a=null,s+""||null}return s.source=function(t){return arguments.length?(e=t,s):e},s.target=function(t){return arguments.length?(n=t,s):n},s.x=function(t){return arguments.length?(r="function"==typeof t?t:nS(+t),s):r},s.y=function(t){return arguments.length?(o="function"==typeof t?t:nS(+t),s):o},s.context=function(e){return arguments.length?(null==e?i=a=null:a=t(i=e),s):i},s})(function(t){return new nN(t,!0)}).x(function(t){return t[0]}).y(function(t){return t[1]}),n5=function(t){var e=t.text,n=t.posX,r=t.posY,o=t.width,i=t.height,a=t.fontSize,s=t.fontWeight,l=t.color,c=n_("svg:foreignObject");return c.attr("x",n).attr("y",r).attr("width",o).attr("height",void 0===i?16:i).attr("class","mge-text").html(e),a&&12!==a&&c.style("font-size",a),l&&"rgb(255, 255, 255)"!==l&&"#FFFFFF"!==l&&c.style("color",l),s&&500!==s&&c.style("font-weight",s),c},n4=function(t){return n5(t).node()};(n6=nG||(nG={})).Order="node_order",n6.PreviewPlaceholder="preview_placeholder",n6.PreviewClipPath="preview_clip_path",n6.Connector="node_connector",n6.ConnectorDisabled="node_connector_disabled",n6.LinearGradient="linear_gradient";var n6,n9,n3,n7=function(t){var e=this;this._defsDOMElement=t,this.dispose=function(){e._defsDOMElement.selectAll("*").remove()},g(t),t.selectAll("marker").data(w).join("marker").attr("id",function(t){return t.name}).attr("stroke",function(t){return t.stroke}).attr("stroke-width",function(t){return t.strokeWidth}).attr("markerHeight",function(t){return t.size}).attr("markerWidth",function(t){return t.size}).attr("markerUnits","strokeWidth").attr("orient","auto").attr("refX",0).attr("refY",0).attr("viewBox",function(t){return t.viewBox}).append("path").attr("d",function(t){return t.path}).attr("fill",function(t){return t.fill}),t.append(function(){var t;return(t=n_("svg:g").attr("id",nG.PreviewPlaceholder)).append("rect").attr("x",2).attr("y",0).attr("width",h.render.node.width-4).attr("height",h.render.node.componentPreviewHeight).attr("fill",h.render.node.previewPlaceholder.backgroundColor),t.append("path").attr("d",nq({x:8,y:8,w:h.render.node.width-16,h:h.render.node.componentPreviewHeight-16,r:8})).attr("stroke-width",h.render.strokeSize).attr("stroke",h.render.node.previewPlaceholder.borderColor).style("stroke-dasharray","2, 4").attr("fill","none"),t.append("text").text(h.translation.node_video_error).attr("text-anchor","middle").attr("font-weight",600).attr("font-size",15).style("fill",h.render.node.previewPlaceholder.textColor).attr("x",h.render.node.width/2).attr("y",h.render.node.componentPreviewHeight/2+6).attr("text-rendering","optimizeSpeed"),t.node()}),t.append(function(){return n_("svg:path").attr("id",nG.Connector).attr("d","M0,0 L1,1z").attr("fill","none").style("marker-start","url(#".concat(y.Circle,")")).node()}),t.append(function(){return n_("svg:path").attr("id",nG.ConnectorDisabled).attr("d","M0,0 L1,1z").attr("fill","none").style("marker-start","url(#".concat(y.CircleDisabled,")")).node()}),t.append(function(){var t;return(t=n_("svg").attr("id",nG.Order)).append("circle").attr("r",h.render.node.componentOrderRadius).attr("fill","#FFFFFF").attr("cx",h.render.node.componentOrderRadius).attr("cy",h.render.node.componentOrderRadius),t.node()}),t.append(function(){var t,e;return t=(function t(){var e,n=(function(){var t,e,n,r,o,i,a=e8,s=e8,l=function t(e,n){var r,o,i=typeof n;return null==n||"boolean"===i?em(n):("number"===i?tj:"string"===i?(r=et(n))?(n=r,e_):ex:n instanceof et?e_:n instanceof Date?function(t,e){var n=new Date;return t=+t,e=+e,function(r){return n.setTime(t*(1-r)+e*r),n}}:!ArrayBuffer.isView(o=n)||o instanceof DataView?Array.isArray(n)?function(e,n){var r,o=n?n.length:0,i=e?Math.min(o,e.length):0,a=Array(i),s=Array(o);for(r=0;r<i;++r)a[r]=t(e[r],n[r]);for(;r<o;++r)s[r]=n[r];return function(t){for(r=0;r<i;++r)s[r]=a[r](t);return s}}:"function"!=typeof n.valueOf&&"function"!=typeof n.toString||isNaN(n)?function(e,n){var r,o={},i={};for(r in null!==e&&"object"==typeof e||(e={}),null!==n&&"object"==typeof n||(n={}),n)r in e?o[r]=t(e[r],n[r]):i[r]=n[r];return function(t){for(r in o)i[r]=o[r](t);return i}}:tj:function(t,e){e||(e=[]);var n,r=t?Math.min(e.length,t.length):0,o=e.slice();return function(i){for(n=0;n<r;++n)o[n]=t[n]*(1-i)+e[n]*i;return o}})(e,n)},c=nt;function u(){var t,e,n,l=Math.min(a.length,s.length);return c!==nt&&(t=a[0],e=a[l-1],t>e&&(n=t,t=e,e=n),c=function(n){return Math.max(t,Math.min(e,n))}),r=l>2?nr:nn,o=i=null,d}function d(e){return null==e||isNaN(e=+e)?n:(o||(o=r(a.map(t),s,l)))(t(c(e)))}return d.invert=function(n){return c(e((i||(i=r(s,a.map(t),tj)))(n)))},d.domain=function(t){return arguments.length?(a=Array.from(t,e7),u()):a.slice()},d.range=function(t){return arguments.length?(s=Array.from(t),u()):s.slice()},d.rangeRound=function(t){return s=Array.from(t),l=e3,u()},d.clamp=function(t){return arguments.length?(c=!!t||nt,u()):c!==nt},d.interpolate=function(t){return arguments.length?(l=t,u()):l},d.unknown=function(t){return arguments.length?(n=t,d):n},function(n,r){return t=n,e=r,u()}})()(nt,nt);return n.copy=function(){return t().domain(n.domain()).range(n.range()).interpolate(n.interpolate()).clamp(n.clamp()).unknown(n.unknown())},no.apply(n,arguments),e=n.domain,n.ticks=function(t){var n=e();return function(t,e,n){var r,o,i,a,s=-1;if(n=+n,(t=+t)==(e=+e)&&n>0)return[t];if((r=e<t)&&(o=t,t=e,e=o),0===(a=eQ(t,e,n))||!isFinite(a))return[];if(a>0){let n=Math.round(t/a),r=Math.round(e/a);for(n*a<t&&++n,r*a>e&&--r,i=Array(o=r-n+1);++s<o;)i[s]=(n+s)*a}else{let n=Math.round(t*(a=-a)),r=Math.round(e*a);for(n/a<t&&++n,r/a>e&&--r,i=Array(o=r-n+1);++s<o;)i[s]=(n+s)/a}return r&&i.reverse(),i}(n[0],n[n.length-1],null==t?10:t)},n.tickFormat=function(t,n){var r=e();return function(t,e,n,r){var o,i,a,s,l,c=(a=Math.pow(10,Math.floor(Math.log(i=Math.abs(e-t)/Math.max(0,n))/Math.LN10)),(s=i/a)>=eU?a*=10:s>=eK?a*=5:s>=eJ&&(a*=2),e<t?-a:a);switch((r=ns(null==r?",f":r)).type){case"s":var u=Math.max(Math.abs(t),Math.abs(e));return null!=r.precision||isNaN(l=Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(nu(u)/3)))-nu(Math.abs(c))))||(r.precision=l),ny(r,u);case"":case"e":case"g":case"p":case"r":null!=r.precision||isNaN(l=Math.max(0,nu(Math.abs(Math.max(Math.abs(t),Math.abs(e)))-(o=Math.abs(o=c)))-nu(o))+1)||(r.precision=l-("e"===r.type));break;case"f":case"%":null!=r.precision||isNaN(l=Math.max(0,-nu(Math.abs(c))))||(r.precision=l-2*("%"===r.type))}return nv(r)}(r[0],r[r.length-1],null==t?10:t,n)},n.nice=function(t){null==t&&(t=10);var r,o,i=e(),a=0,s=i.length-1,l=i[a],c=i[s],u=10;for(c<l&&(o=l,l=c,c=o,o=a,a=s,s=o);u-- >0;){if((o=eQ(l,c,t))===r)return i[a]=l,i[s]=c,e(i);if(o>0)l=Math.floor(l/o)*o,c=Math.ceil(c/o)*o;else{if(!(o<0))break;l=Math.ceil(l*o)/o,c=Math.floor(c*o)/o}r=o}return n},n})().range([h.render.color.nodeStroke,"rgba(0, 0, 0, 0)"]).domain([1,2]),(e=n_("svg:linearGradient").attr("id",nG.LinearGradient)).append("stop").attr("offset","5%").attr("stop-color",t(1)),e.append("stop").attr("offset","70%").attr("stop-color",t(2)),e.node()}),t.append(function(){var t;return(t=n_("svg:clipPath").attr("id",nG.PreviewClipPath)).append("path").attr("d",nq({x:2,y:h.render.node.headerHeight+1,w:h.render.node.width-4,h:h.render.node.componentPreviewHeight-1,r:8})),t.node()}),function(t){t.append(function(){var t,e;return t=h.render.iconSize+8,(e=n_("svg:g").attr("id",nD.ErrorMarker)).append("svg").attr("width",t).attr("height",t).attr("viewBox","0 0 ".concat(h.render.iconSize," ").concat(h.render.iconSize)).append("use").style("color",h.render.color.error).attr("href","#".concat(v.Warning)),e.append("rect").attr("fill","transparent").attr("width",t).attr("height",t),e.node()})}(t)};(n3=n9||(n9={}))[n3.NoVideo=0]="NoVideo",n3[n3.NoEOV=1]="NoEOV",n3[n3.NoBranches=2]="NoBranches";let n8={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)},rt=new Uint8Array(16),re=[];for(let t=0;t<256;++t)re.push((t+256).toString(16).slice(1));let rn=function(e,n,r){if(n8.randomUUID&&!n&&!e)return n8.randomUUID();let o=(e=e||{}).random||(e.rng||function(){if(!t&&!(t="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)))throw Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return t(rt)})();if(o[6]=15&o[6]|64,o[8]=63&o[8]|128,n){r=r||0;for(let t=0;t<16;++t)n[r+t]=o[t];return n}return function(t,e=0){return(re[t[e+0]]+re[t[e+1]]+re[t[e+2]]+re[t[e+3]]+"-"+re[t[e+4]]+re[t[e+5]]+"-"+re[t[e+6]]+re[t[e+7]]+"-"+re[t[e+8]]+re[t[e+9]]+"-"+re[t[e+10]]+re[t[e+11]]+re[t[e+12]]+re[t[e+13]]+re[t[e+14]]+re[t[e+15]]).toLowerCase()}(o)};var rr,ro=function(){return(ro=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},ri=(Object.freeze({background:"#0D0F12",border:"#0D0F12",text:"#F2F5FF"}),function(t,e,n){switch(e){case"setNextBranch":return{type:t,action:{type:e,args:{branchId:n,shouldOpenNow:!0}}};case"continuePlayback":return{type:t,action:{type:e,args:{shouldOpenNow:!0}}}}}),ra=function(){return(ra=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},rs=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(t);o<r.length;o++)0>e.indexOf(r[o])&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]])}return n},rl=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},rc=function(){return(rc=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},ru=function(){return(ru=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},rd=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a},rh=function(t,e,n){if(n||2==arguments.length)for(var r,o=0,i=e.length;o<i;o++)!r&&o in e||(r||(r=Array.prototype.slice.call(e,0,o)),r[o]=e[o]);return t.concat(r||Array.prototype.slice.call(e))},rf=function(t){for(var e=1,n=r2(),r=function(){return"".concat(t," (").concat(h.translation.copied_chapter_suffix).concat(e,")")},o=r();n.has(o);)e+=1,o=r();return o},rp=function(t,e){return{type:"onSuspense",action:{type:t,args:{branchId:e,shouldOpenNow:!0}}}},rv=function(t,e){return e.map(function(e){return e.action.args.branchId&&t.includes(e.action.args.branchId)?ru(ru({},e),{action:ru(ru({},e.action),{args:ru(ru({},e.action.args),{branchId:void 0})})}):e})},ry=function(t,e){return e.length?ru(ru({},t),{branches:t.branches.filter(function(t){return!e.includes(t.id)}),containers:t.containers.map(function(t){return ru(ru({},t),{controls:t.controls.map(function(t){return ru(ru({},t),{events:rv(e,t.events)})}),events:rv(e,t.events)})}),events:rv(e,t.events)}):t},rm=function(){return(rm=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},rg=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(t);o<r.length;o++)0>e.indexOf(r[o])&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]])}return n},r_=[{version:"3.0",migrate:function(t){var e,n,r,o,i,a,s,l,c=[];try{for(var u=rl(t.chapters),d=u.next();!d.done;d=u.next()){var h=d.value,f=void 0,p=[];try{for(var v=(r=void 0,rl(h.branches)),y=v.next();!y.done;y=v.next()){var m=y.value,g=m.isDefault,_=rs(m,["isDefault"]);g&&(f=_.id),p.push(_)}}catch(t){r={error:t}}finally{try{y&&!y.done&&(o=v.return)&&o.call(v)}finally{if(r)throw r.error}}var b=void 0,w=[];try{for(var C=(i=void 0,rl(h.containers)),x=C.next();!x.done;x=C.next()){var M=x.value,k=M.fallbackStrategy,S=rs(M,["fallbackStrategy"]);switch(k){case"await":b=[];break;case"default":b=[{type:"onSuspense",action:{type:"setNextBranch",args:{branchId:f,shouldOpenNow:!0}}}];break;case"weightlessRandom":case"random":b=[{type:"onSuspense",action:{type:"setRandomBranch",args:{shouldOpenNow:!0}}}]}try{for(var N=(s=void 0,rl(S.controls)),E=N.next();!E.done;E=N.next()){var L=E.value;w.push(ra(ra({},S),{controls:[ra(ra({},L),{events:"Text"===L.subtype||L.events.length?L.events:[ri("onClick","continuePlayback")]})],id:rn(),events:[{type:"onSuspense",action:{type:"continuePlayback",args:{shouldOpenNow:!0}}}]}))}}catch(t){s={error:t}}finally{try{E&&!E.done&&(l=N.return)&&l.call(N)}finally{if(s)throw s.error}}}}catch(t){i={error:t}}finally{try{x&&!x.done&&(a=C.return)&&a.call(C)}finally{if(i)throw i.error}}c.push(ra(ra({},h),{containers:w,events:b,branches:p}))}}catch(t){e={error:t}}finally{try{d&&!d.done&&(n=u.return)&&n.call(u)}finally{if(e)throw e.error}}return t.metadata.version="3.1",t.metadata.updated=(new Date).toISOString(),ra(ra({},t),{chapters:c})}},{version:"3.1",migrate:function(t){var e=t.metadata,n=e.media,r=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&0>e.indexOf(r)&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(t);o<r.length;o++)0>e.indexOf(r[o])&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]])}return n}(e,["media"]);if("string"==typeof n)throw Error("Manifest media should be parsed");return{chapters:t.chapters,metadata:rc(rc({},r),{version:"3.2"}),media:n}}},{version:"3.2",migrate:function(t){var e,n,r,o=[],i=[];try{for(var a=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}(t.chapters),s=a.next();!s.done;s=a.next())!function(t){var e=t.x,n=t.y,r=rg(t,["x","y"]),a=Array.isArray(t.events)&&!t.events.length,s=[],l=r.containers.map(function(t){var e;return rm(rm({},t),{events:(a?null===(e=t.events)||void 0===e?void 0:e.map(function(t){return"onSuspense"===t.type?(t.action.args.branchId&&s.push(t.action.args.branchId),rp("expect")):t}):t.events)||[],controls:t.controls.map(function(t){var e=t.subtype,n=rg(t,["subtype"]);return rm(rm({},n),{type:e,events:n.events||[ri("onClick","continuePlayback")]})})})});o.push(ry(rm(rm({},r),{containers:l,events:t.events||[]}),s)),i.push({id:r.id,x:e,y:n})}(s.value)}catch(t){n={error:t}}finally{try{s&&!s.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}return rm(rm({},t),{chapters:o,graph:(void 0===(e=i)&&(e=[]),{edit:{chapters:e},view:{}}),metadata:rm(rm({},t.metadata),{version:"3.3"})})}}],rb=function(t,e){return null==e?void 0:e.find(function(e){return e.type===t})},rw=function(t,e){void 0===e&&(e=function(t){return t.id});var n,r,o={};try{for(var i=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}(t),a=i.next();!a.done;a=i.next()){var s=a.value;o[e(s)]=s}}catch(t){n={error:t}}finally{try{a&&!a.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return o};(rP=rr||(rr={})).Failed="ManifestParsingFailed",rP.UnsupportedVersion="ManifestUnsupportedVersion";var rC=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a},rx=function(t,e,n){if(n||2==arguments.length)for(var r,o=0,i=e.length;o<i;o++)!r&&o in e||(r||(r=Array.prototype.slice.call(e,0,o)),r[o]=e[o]);return t.concat(r||Array.prototype.slice.call(e))};function rM(t){return"number"==typeof t}function rk(t){var e={};return Object.keys(t).forEach(function(n){var r;null!==(r=t[n])&&"object"==typeof r&&(e[n]=rk(t[n])),null!==t[n]&&(e[n]=t[n])}),e}var rS=function(t){f.emit("events",{name:"chapterUpdated",context:t})},rN=function(t){f.emit("actions",{name:"updateChapterOrder",context:t})},rE=function(t){f.emit("actions",{name:"deleteChapters",context:t.map(function(t){return{id:t}})})},rL=function(t){f.emit("events",{name:"chaptersSelected",context:rx([],rC(t),!1).map(function(t){return{id:t}})})},rO=function(t){f.emit("events",{name:"chaptersAdded",context:t.map(function(t){var e=rQ(t);return{chapter:e.chapter,graphChapter:e.styles}})})},rA=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a},rT=function(t,e,n){if(n||2==arguments.length)for(var r,o=0,i=e.length;o<i;o++)!r&&o in e||(r||(r=Array.prototype.slice.call(e,0,o)),r[o]=e[o]);return t.concat(r||Array.prototype.slice.call(e))},rB=function(){function t(){this._renderedNodesData={},this._renderedBranchesData={},this._previousNodesToRenderCount=0}return Object.defineProperty(t.prototype,"previousNodesToRenderCount",{set:function(t){this._previousNodesToRenderCount=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"renderedNodesData",{set:function(t){this._renderedNodesData=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"renderedBranchesData",{get:function(){return this._renderedBranchesData},set:function(t){this._renderedBranchesData=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasRenderedNodes",{get:function(){return!!Object.values(this._renderedNodesData).length},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasRenderedBranches",{get:function(){return!!Object.values(this._renderedBranchesData).length},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"shouldRenderFullLayout",{get:function(){var t=aM.inputs.zoom.zoomFactor>h.performance.renderSkeletonOnZoomLessThan;return this.isPerformanceBoostDisabled()||t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"branchesToRender",{get:function(){var t=rA(r3.sectors.getNodesMapCoordinates(),2),e=rA(t[0],2),n=e[0],r=e[1],o=rA(t[1],2),i=o[0],a=o[1];return r3.manifest.branches.filter(function(t){var e=r0(t.target.chapterId),o=r0(t.source.chapterId),s=e.y>a&&o.y>a,l=e.y<r&&o.y<r,c=e.x>i&&o.x>i,u=e.x<n&&o.x<n;return!(s||l||c||u)})},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"nodesToRender",{get:function(){var t=r3.manifest.nodes;return r3.layout.isPerformanceBoostDisabled()?t:t.filter(function(t){return r3.sectors.isNodeVisible(t.id)})},enumerable:!1,configurable:!0}),t.prototype.layoutChanged=function(){if(this.isPerformanceBoostDisabled())return!1;var t=r3.manifest.nodes.length,e=this._previousNodesToRenderCount,n=h.performance.enableSkeletonsOnNodesCount;return e<n&&t>=n||e>=n&&t<n},t.prototype.isPerformanceBoostDisabled=function(){return r3.manifest.nodes.length<h.performance.enableSkeletonsOnNodesCount},t.prototype.getChangedBranches=function(){var t=this.branchesToRender;if(!this.hasRenderedBranches||this.layoutChanged())return{deleted:[],edited:t};var e=Object.values(this._renderedBranchesData);return this.getChangedAfterRenderBranches({renderedBranches:e,branchesToRender:t})},t.prototype.getChangedNodes=function(){if(!this.hasRenderedNodes||this.layoutChanged())return{deletedNodes:[],editedNodes:this.nodesToRender};var t=Object.values(this._renderedNodesData);return this.getChangedAfterRenderNodes({renderedNodes:t,nodesToRender:this.nodesToRender})},t.prototype.getChangedAfterRenderBranches=function(t){var e=t.renderedBranches,n=t.branchesToRender,r=[],o=[],i=rw(n);return e.forEach(function(t){var e=i[t.id];e?t.isEqual(e)||o.push(e):r.push(t),delete i[t.id]}),o.push.apply(o,rT([],rA(Object.values(i)),!1)),{deleted:r,edited:o}},t.prototype.getChangedAfterRenderNodes=function(t){var e=t.renderedNodes,n=t.nodesToRender,r=[],o=[],i=rw(n);return e.forEach(function(t){var e=i[t.id];e?t.isEqual(e)||o.push(e):r.push(t),delete i[t.id]}),o.push.apply(o,rT([],rA(Object.values(i)),!1)),{deletedNodes:r,editedNodes:o}},t}();function rz(t,e){var n,r=((n={})[rI.Flip]=1,n[rI.Action]=2,n[rI.Inaction]=3,n);return r[t]<r[e]?-1:r[t]>r[e]?1:0}var rP,rI,rD={edit:{background:{color:"#0D0F12",grid:{enabled:!0,color:"#474747"}},defaultChapter:{flipTo:{enabled:!0,backgroundColor:"#232324",textColor:"#FFFFFF"},controls:{enabled:!0,backgroundColor:"#232324",textColor:"#FFFFFF"},hover:{enabled:!0,borderColor:"#7B68EE"}},chapters:[]},view:{background:{color:"#0D0F12",grid:{enabled:!1,color:"#474747"}},defaultChapter:{header:{enabled:!0,backgroundColor:"#232324",textColor:"#FFFFFF"},flipTo:{enabled:!1,backgroundColor:"#232324",textColor:"#FFFFFF"},controls:{enabled:!1,backgroundColor:"#232324",textColor:"#FFFFFF"},hover:{enabled:!0,borderColor:"#2688EB"},watchAgain:{enabled:!0,backgroundColor:"#2688EB",textColor:"#FFFFFF"},preview:{visible:!1,backgroundColor:"#19191A",textColor:"#5D5F61"},goBlind:!1}}},rZ=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a};(r7=rI||(rI={})).Flip="flip",r7.Action="action",r7.Inaction="inaction";var rj=function(){function t(t,e,n,r,o){var i=this;this._parentNode=r,this._targetedNode=o,this.updateSourceAbsolutePosition=function(t){var e=rZ(t,2),n=e[0],r=e[1];return i.source.position.absolute=[n+i.source.position.relative[0],r+i.source.position.relative[1]],i},this.updateTargetAbsolutePosition=function(t){var e=rZ(t,2),n=e[0],r=e[1];return i.target.position.absolute=[n+i.target.position.relative[0],r+i.target.position.relative[1]],i},this.isAssociatedNodeLocked=function(){return!(r3.visitedNodes.has(i.source.chapterId)&&r3.visitedNodes.has(i.target.chapterId))},this.updateInitialTargetCoordinates=function(){var t=i._targetedNode.getIncomingConnectorsCoordinates()[i.connectorType];return t&&(i.target.position.absolute[1]=i._targetedNode.styles.y+t[1],i.target.position.relative[1]=t[1]),i},this.id=t.id,this.type=e,this.connectorType=n,this.isHidden=this._parentNode.isEndNode();var a=this._parentNode.render.previewMiddleYCoordinate,s=this._targetedNode.render.previewMiddleYCoordinate;this.source={chapterId:this._parentNode.chapter.id,position:{absolute:[this._parentNode.styles.x+this._parentNode.render.width,this._parentNode.styles.y+a],relative:[this._parentNode.render.width,a]}},this.target={chapterId:t.chapterId,position:{absolute:[this._targetedNode.styles.x,this._targetedNode.styles.y+s],relative:[0,s]}},this.updateSourceCoordinates(t)}return t.prototype.isEqual=function(t){var e=this;return["id","type","connectorType","source","target"].every(function(n){return JSON.stringify(e[n])===JSON.stringify(t[n])})},t.prototype.updateSourceCoordinates=function(t){var e,n,r,o;switch(this.type){case rI.Flip:if(h.isEditMode()||h.isViewOrPreViewMode()&&(null===(e=this._parentNode.stylesWithDefaults.flipTo)||void 0===e?void 0:e.enabled)){var i=rZ((o=(r=this._parentNode).render.flipToYCoordinate,[r.styles.x+r.render.width+44,r.styles.y+o+h.render.node.componentControlHeight/2]),2),a=i[0],s=i[1];this.source.position.absolute=[a,s],this.source.position.relative=[a-this._parentNode.styles.x,s-this._parentNode.styles.y]}break;case rI.Action:case rI.Inaction:if(h.isEditMode()||h.isViewOrPreViewMode()&&(null===(n=this._parentNode.stylesWithDefaults.controls)||void 0===n?void 0:n.enabled)){var l,c,u,d,f,p=rZ((l=this._parentNode,c=t.id,(d=-1===(u=l.controls().findIndex(function(t){var e;return null===(e=t.events)||void 0===e?void 0:e.some(function(t){return t.action.args.branchId===c})})))&&(u=l.containers().reverse().findIndex(function(t){var e;return null===(e=t.events)||void 0===e?void 0:e.some(function(t){return t.action.args.branchId===c})})),f=l.render.controlsContainerYCoordinate,[l.styles.x+l.render.width,l.styles.y+f+h.render.node.componentControlHeight*u+(d?h.render.node.control.inactionLinkY:h.render.node.control.actionLinkY)]),2);a=p[0],s=p[1],this.source.position.absolute=[a,s],this.source.position.relative=[a-this._parentNode.styles.x,s-this._parentNode.styles.y]}}},t}(),rV=i(996),rH=i.n(rV),rF=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},rR=function(){function t(t,e){var n,r=this;this.branches=[],this.saveViewChapterDesign=!1,this.parentChaptersConnections=[],this.chapterErrors=[],this.isDragged=!1,this._modified=!1,this.getContainerControls=function(t){var e;return(null===(e=r.chapter.containers.find(function(e){return e.id===t}))||void 0===e?void 0:e.controls.filter(function(t){return"Text"!==t.type}))||[]},this.controls=function(){return r.chapter.containers.flatMap(function(t){return t.controls}).reverse().filter(function(t){return"Text"!==t.type})},this.containers=function(){return r.chapter.containers.filter(function(t){return t.controls.some(function(t){return"Text"!==t.type})})},this.hasParentChapters=function(t){return t?r.parentChaptersConnections.some(function(e){return e.type===t}):!!r.parentChaptersConnections.length},this.getParentChaptersByType=function(t){return r.parentChaptersConnections.filter(function(e){return e.type===t})},this.hasBranches=function(t){return t?r.branches.some(function(e){return e.type===t}):!!r.branches.length},this.isConnected=function(){return r.hasParentChapters()||r.hasBranches()||"start"===r.chapter.order},this.isEndNode=function(){return"end"===r.chapter.order},this.hasErrors=function(){return!!r.chapterErrors.length},this.getPolygon=function(){return[[r.styles.x,r.styles.y],[r.styles.x+r.render.width,r.styles.y],[r.styles.x+r.render.width,r.styles.y+r.render.height],[r.styles.x,r.styles.y+r.render.height]]},this.getBBox=function(){return{minX:r.styles.x,minY:r.styles.y,maxX:r.styles.x+r.render.width,maxY:r.styles.y+r.render.height}},this.getCenter=function(){return[r.styles.x+r.render.width/2,r.styles.y+r.render.height/2]},this.updatePosition=function(t,e){return r.styles.x=t,r.styles.y=e,h.isPreViewMode()&&(r.saveViewChapterDesign=!0),r},this.addBranch=function(t,e,n){var o,i,a={id:rn(),chapterId:t};return r.chapter=(o=r.chapter,ru(ru({},o),e?{containers:o.containers.map(function(t){return ru(ru({},t),{controls:t.controls.map(function(t){return t.id===e?ru(ru({},t),{events:[ri("onClick","setNextBranch",a.id)]}):t})})}),branches:rh(rh([],rd(o.branches),!1),[a],!1)}:n?{containers:o.containers.map(function(t){return t.id===n?ru(ru({},t),{events:[rp("setNextBranch",a.id)]}):t}),branches:rh(rh([],rd(o.branches),!1),[a],!1)}:{branches:rh(rh([],rd(o.branches),!1),[a],!1),events:null===(i=o.events)||void 0===i?void 0:i.map(function(t){return"onSuspense"===t.type?ru(ru({},t),{action:ru(ru({},t.action),{args:{branchId:a.id,shouldOpenNow:!0}})}):t})})),r},this.deleteBranch=function(t){return r.chapter=ry(r.chapter,[t]),r},this.updateChapterSuspenseAction=function(t){var e,n,o,i,a;return r.chapter=(o=(e=r.chapter).events||[],a=null==(i=null===(n=e.events)||void 0===n?void 0:n.find(function(t){return"onSuspense"===t.type}))?void 0:i.action.args.branchId,t&&(o=i?o.map(function(e){return"onSuspense"===e.type?ru(ru({},e),{action:ru(ru({},e.action),{type:t,args:ru(ru({},e.action.args),{branchId:"setNextBranch"===t?e.action.args.branchId:void 0})})}):e}):rh(rh([],rd(o),!1),[{type:"onSuspense",action:{type:t,args:{shouldOpenNow:!0}}}],!1)),ru(ru({},e),{events:o,branches:"setNextBranch"!==t?e.branches.filter(function(t){return t.id!==a}):e.branches})),r},this.getIncomingConnectorsCoordinates=function(){return r._incomingConnectorsCoordinates?r._incomingConnectorsCoordinates:r.updateIncomingConnectorsCoordinates()},this.updateIncomingConnectorsCoordinates=function(t){return void 0===t&&(t=null),t&&(r.parentChaptersConnections.find(function(e){return t.type===e.type})||r.parentChaptersConnections.push(t)),r._incomingConnectorsCoordinates=r.getConnectorCoordinatesForBranchTypes(r.getUniqueParentConnectionTypes()),r._incomingConnectorsCoordinates},this.getConnectorCoordinatesForBranchTypes=function(t){var e=t.sort(rz),n=(e.length-1)*h.render.node.connectorPositionDiff/2,r=h.render.node.connectorPositionY-n;return e.reduce(function(t,e,n){return t[e]=[0,r+h.render.node.connectorPositionDiff*n],t},{})},this.id=t.id,this._chapter=t,this.chapterErrors=r3.nodesErrors[this.id]||[];var o=null===(n=e.view.chapters)||void 0===n?void 0:n.find(function(e){return e.id===t.id}),i=e.edit.chapters.find(function(e){return e.id===t.id});h.isEditMode()?(this.styles=rk(i),this._stylesWithDefaults=rH()(e.edit.defaultChapter,this.styles)):(this.styles=rk(o||i),this._stylesWithDefaults=rH()(e.view.defaultChapter,this.styles)),this.saveViewChapterDesign=h.isPreViewMode()&&!!o,this.render=this.getGraphNodeRender()}return Object.defineProperty(t.prototype,"chapter",{get:function(){return this._chapter},set:function(t){this.setModified(),this._chapter=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"stylesWithDefaults",{get:function(){return this._stylesWithDefaults},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isLocked",{get:function(){return!!h.isViewOrPreViewMode()&&"start"!==this.chapter.order&&!r3.visitedNodes.has(this.id)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"displayLockedContent",{get:function(){return!h.isViewOrPreViewMode()||"start"===this.chapter.order||!!this.stylesWithDefaults.preview.visible||!this.isLocked},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"modified",{get:function(){return this._modified},enumerable:!1,configurable:!0}),t.prototype.resetModified=function(){this._modified&&(this._modified=!1)},t.prototype.setModified=function(){this._modified||(this._modified=!0)},t.prototype.getSuspenseActionType=function(){return function(t){if(t.events){var e=t.events.find(function(t){return"onSuspense"===t.type});return null==e?void 0:e.action.type}}(this.chapter)},t.prototype.getSuspenseBranchId=function(){var t,e;return null===(e=null===(t=this.chapter.events)||void 0===t?void 0:t.find(function(t){return"onSuspense"===t.type}))||void 0===e?void 0:e.action.args.branchId},t.prototype.getContainerBranchIds=function(){var t,e,n,r,o=[];try{for(var i=rF(this.containers().reverse()),a=i.next();!a.done;a=i.next()){var s=a.value;try{for(var l=(n=void 0,rF(s.events||[])),c=l.next();!c.done;c=l.next()){var u=c.value;"onSuspense"===u.type&&u.action.args.branchId&&o.push(u.action.args.branchId)}}catch(t){n={error:t}}finally{try{c&&!c.done&&(r=l.return)&&r.call(l)}finally{if(n)throw n.error}}}}catch(e){t={error:e}}finally{try{a&&!a.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}return o},t.prototype.updateControlActionEvent=function(t,e,n){var r,o,i,a,s,l,c,u,d;return this.chapter=(r=this.chapter,o=t.id,i=e.id,l=(null==(s=null===(a=r.containers.find(function(t){return t.id===o}))||void 0===a?void 0:a.controls.find(function(t){return t.id===i}))?void 0:s.events)||[],u=null==(c=rb("onClick",null==s?void 0:s.events))?void 0:c.action.args.branchId,"setNextBranch"!==n&&"continuePlayback"!==n||(c?l=l.map(function(t){return t===c?ro(ro({},t),{action:ro(ro({},t.action),{type:n,args:ro(ro({},t.action.args),{branchId:"setNextBranch"===n?t.action.args.branchId:void 0})})}):t}):l.push(ri("onClick",n))),d="setNextBranch"!==n?r.branches.filter(function(t){return t.id!==u}):r.branches,ro(ro({},r),{branches:d,containers:r.containers.map(function(t){return t.id===o?ro(ro({},t),{controls:t.controls.map(function(t){return t.id===i?ro(ro({},t),{events:l}):t})}):t})})),this},t.prototype.updateContainerSuspenseAction=function(t,e){var n,r,o,i,a,s;return this.chapter=(n=this.chapter,r=t.events||[],i=null==(o=rb("onSuspense",t.events))?void 0:o.action.args.branchId,e&&(r=o?r.map(function(t){return"onSuspense"===t.type?ru(ru({},t),{action:ru(ru({},t.action),{type:e,args:ru(ru({},t.action.args),{branchId:"setNextBranch"===e?t.action.args.branchId:void 0})})}):t}):rh(rh([],rd(r),!1),[{type:"onSuspense",action:{type:e,args:{shouldOpenNow:!0}}}],!1)),a="setNextBranch"!==e?n.branches.filter(function(t){return t.id!==i}):n.branches,s=ru(ru({},t),{events:r}),ru(ru({},n),{branches:a,containers:n.containers.map(function(e){return e.id===t.id?s:e})})),this},t.prototype.isEqual=function(t){var e=this;if(this.modified||t.modified||this.chapter!==t.chapter)return!1;var n=["id","type","connectorType","source","target","isHidden"],r=function(t){return t.map(function(t){return n.map(function(e){return t[e]}).join()}).join()};return!(r(t.branches)!==r(this.branches))&&["id","parentChaptersConnections","render","isDragged","chapterErrors","videoInfo","saveViewChapterDesign"].every(function(n){return JSON.stringify(t[n])===JSON.stringify(e[n])})},t.prototype.getGraphNodeRender=function(){var t,e,n,r=this.calculateNodeHeight(),o=h.render.node.connectorPositionY,i=h.render.node.heightWithPreview,a=h.render.node.heightWithPreviewEov+h.render.node.componentAddActionHeight+1;return h.isViewOrPreViewMode()&&((null===(t=this.stylesWithDefaults.header)||void 0===t?void 0:t.enabled)||(o=h.render.node.defaultConnectorPositionY),(null===(e=this.stylesWithDefaults.flipTo)||void 0===e?void 0:e.enabled)&&(i=h.render.node.heightWithPreview),a=(null===(n=this.stylesWithDefaults.flipTo)||void 0===n?void 0:n.enabled)?h.render.node.heightWithPreviewEov+1:i+1),{height:r,width:h.render.node.width,previewMiddleYCoordinate:o,flipToYCoordinate:i,controlsContainerYCoordinate:a}},t.prototype.calculateNodeHeight=function(){var t,e,n,r;return"end"===this.chapter.order?!h.isViewOrPreViewMode()||(null===(t=this.stylesWithDefaults.header)||void 0===t?void 0:t.enabled)?h.render.node.heightWithPreview:h.render.node.defaultHeight:h.isViewOrPreViewMode()?((null===(e=this.stylesWithDefaults.header)||void 0===e?void 0:e.enabled)?h.render.node.heightWithPreview:h.render.node.defaultHeight)+((null===(n=this.stylesWithDefaults.flipTo)||void 0===n?void 0:n.enabled)?h.render.node.componentControlHeight:0)+((null===(r=this.stylesWithDefaults.controls)||void 0===r?void 0:r.enabled)?this.controls().length*h.render.node.componentControlHeight:0):h.render.node.heightFull+this.controls().length*h.render.node.componentControlHeight},t.prototype.getControlTypeLabelTranslation=function(t){switch(t){case"Text":return h.translation.new_text_label;case"Button":return h.translation.new_button_label;case"Area":return h.translation.new_area_label}},t.prototype.getUniqueParentConnectionTypes=function(){return Array.from(new Set(this.parentChaptersConnections.map(function(t){return t.connectorType})))},t}(),rY=function(){return(rY=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},rW=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},rX=function(){function t(){var t=this;this._graphDesign=rD,this._nodes={},this._branches={},this.setAllNodesAsModified=function(){t.nodes.forEach(function(t){return t.setModified()})},this.getBranchById=function(e){return t._branches[e]},this.selectBranch=function(e){return t._branches[e]},this.reset=function(){t._metadata=void 0,t._media=void 0,t._videosDict={},t._nodes={},t._branches={},t._graphDesign=rD},this.rebuildNodesAndBranches=function(){t.buildNodesAndBranches()},this.set=function(e){var n;n=e,e=r_.reduce(function(t,e){return t.metadata.version===e.version?e.migrate(t):t},n),t._metadata=e.metadata,t._media=e.media,t._videosDict=rw(e.media.videos,function(t){return t.id}),t._chapters=e.chapters,t._graphDesign=rH()(t._graphDesign,{edit:rk(e.graph.edit),view:rk(e.graph.view)}),t.buildNodesAndBranches()},this.save=function(){var e,n;if(t._metadata&&t._media&&t._graphDesign){t._metadata.updated=(new Date).toISOString();var r=Object.values(t._nodes),o=[],i=[],a=h.isEditMode()?"edit":"view";try{for(var s=rW(r),l=s.next();!l.done;l=s.next()){var c=l.value,u=c.chapter,d=c.styles,p=c.saveViewChapterDesign;o.push(u),("view"===a&&p||"edit"===a)&&i.push(d)}}catch(t){e={error:t}}finally{try{l&&!l.done&&(n=s.return)&&n.call(s)}finally{if(e)throw e.error}}var v={chapters:o,metadata:t._metadata,media:t._media,graph:rY(rY({},t._graphDesign),{edit:rY(rY({},t._graphDesign.edit),"edit"===a?{chapters:i}:{}),view:rY(rY({},t._graphDesign.view),"view"===a?{chapters:i}:{})})};f.emit("manifestUpdate",v)}},this.updateBranches=function(){var e,n,r,o,i,a;t._branches={};try{for(var s=rW(Object.values(t._nodes)),l=s.next();!l.done;l=s.next())(d=l.value).parentChaptersConnections=[]}catch(t){e={error:t}}finally{try{l&&!l.done&&(n=s.return)&&n.call(s)}finally{if(e)throw e.error}}try{for(var c=rW(Object.values(t._nodes)),u=c.next();!u.done;u=c.next()){var d=u.value;t.buildNodeBranches(d)}}catch(t){r={error:t}}finally{try{u&&!u.done&&(o=c.return)&&o.call(c)}finally{if(r)throw r.error}}try{for(var h=rW(Object.values(t._branches)),f=h.next();!f.done;f=h.next())f.value.updateInitialTargetCoordinates()}catch(t){i={error:t}}finally{try{f&&!f.done&&(a=h.return)&&a.call(h)}finally{if(i)throw i.error}}return t},this.createNode=function(e,n,r){var o,i,a=(void 0===(i=h.translation.new_chapter_label)&&(i=h.translation.new_chapter_label),{id:rn(),label:i,order:"simple",branches:[],containers:[],events:[]}),s={id:a.id,x:(o=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a}(e,2))[0],y:o[1]};return t._graphDesign.edit.chapters.push(s),t._nodes[a.id]=new rR(a,t._graphDesign),null==r||r(a.id),n||rO([a.id]),t},this.setNodeOrder=function(e,n){var r=rQ(e);return"start"===r.chapter.order&&t._metadata&&(t._metadata.initChapterId=void 0),r.chapter=rY(rY({},r.chapter),{order:n}),t},this.duplicateNode=function(e,n,r){var o,i,a=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a}(n,2),s=a[0],l=a[1],c=t._nodes[e],u=c.styles,d=(o=c.chapter,ru(ru({},o),{label:rf(o.label),id:rn(),order:"start"===o.order?"simple":o.order,branches:[],containers:o.containers.map(function(t){return ru(ru({},t),{id:rn(),controls:t.controls.map(function(t){return ru(ru({},t),{id:rn(),events:"Text"!==t.type?[ri("onClick","continuePlayback")]:[]})}),events:[rp("continuePlayback")]})}),events:null===(i=o.events)||void 0===i?void 0:i.map(function(t){return"onSuspense"===t.type&&"setNextBranch"===t.action.type?ru(ru({},t),{action:ru(ru({},t.action),{args:ru(ru({},t.action.args),{branchId:void 0})})}):t})})),h=JSON.parse(JSON.stringify(rY(rY({},u),{id:d.id,x:t._nodes[e].styles.x+s,y:t._nodes[e].styles.y+l})));return t._graphDesign.edit.chapters.push(h),t.buildNodeFromChapter(d),null==r||r(d.id),t},this.getManifestBoundingBox=function(){var e,n,r=0,o=0,i=0,a=0;try{for(var s=rW(Object.values(t._nodes)),l=s.next();!l.done;l=s.next()){var c=l.value.getBBox();r=c.minX<r?c.minX:r,o=c.minY<o?c.minY:o,i=c.maxX>i?c.maxX:i,a=c.maxY>a?c.maxY:a}}catch(t){e={error:t}}finally{try{l&&!l.done&&(n=s.return)&&n.call(s)}finally{if(e)throw e.error}}return{minX:r,minY:o,maxX:i,maxY:a}}}return Object.defineProperty(t.prototype,"metadata",{get:function(){return this._metadata},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"nodesDict",{get:function(){return this._nodes},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"branchesDict",{get:function(){return this._branches},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"nodes",{get:function(){var t=this;return h.isViewMode()?Object.values(this._nodes).filter(function(e){return!(e.isLocked&&t.styles.defaultChapter.goBlind)}):Object.values(this._nodes)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"styles",{get:function(){var t=h.isEditMode()?"edit":"view";return this._graphDesign[t]},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"branches",{get:function(){if(h.isViewOrPreViewMode()){var t=!!h.isViewMode()&&this.styles.defaultChapter.goBlind;return Object.values(this._branches).filter(function(e){return!(e.isHidden||e.isAssociatedNodeLocked()&&t)})}return Object.values(this._branches).filter(function(t){return!t.isHidden})},enumerable:!1,configurable:!0}),t.prototype.deleteGraphBranches=function(t){var e,n,r,o;return null===(n=null===(e=this._graphDesign)||void 0===e?void 0:e.edit.branches)||void 0===n||n.filter(function(e){return!t.includes(e.id)}),null===(o=null===(r=this._graphDesign)||void 0===r?void 0:r.view.branches)||void 0===o||o.filter(function(e){return!t.includes(e.id)}),this},t.prototype.buildNodesAndBranches=function(){var t,e;if(this._chapters){try{for(var n=rW(this._chapters),r=n.next();!r.done;r=n.next()){var o=r.value;this.buildNodeFromChapter(o)}}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.updateBranches()}},t.prototype.buildNodeBranches=function(t){var e,n,r,o,i=[];t.branches=[];var a=this;try{for(var s=rW(t.chapter.branches),l=s.next();!l.done;l=s.next()){var c=function(e){var n=rJ(e.chapterId);if(!n)return a.showErrorMessage(h.translation.popup_error_message_1),{value:void 0};var s,l=void 0;if(l=s=t.getSuspenseBranchId()===e.id?rI.Flip:t.getContainerBranchIds().includes(e.id)?rI.Inaction:rI.Action,h.isViewOrPreViewMode()&&(s===rI.Flip&&!(null===(r=t.stylesWithDefaults.flipTo)||void 0===r?void 0:r.enabled)||!(null===(o=t.stylesWithDefaults.controls)||void 0===o?void 0:o.enabled))){if(l=rI.Flip,i.find(function(t){return t.connectorType===rI.Flip&&t.targetNodeId===n.id}))return"continue";i.push({connectorType:rI.Flip,targetNodeId:n.id})}var c=new rj(e,s,l,t,n);if(a._branches[e.id]=c,t.branches.push(c),a._branches[e.id].isHidden)return{value:void 0};a._nodes[e.chapterId].parentChaptersConnections.push({chapterId:t.id,type:c.type,connectorType:c.connectorType,branchId:c.id})}(l.value);if("object"==typeof c)return c.value}}catch(t){e={error:t}}finally{try{l&&!l.done&&(n=s.return)&&n.call(s)}finally{if(e)throw e.error}}},t.prototype.buildNodeFromChapter=function(t){var e;if(this._videosDict&&(this._nodes[t.id]=new rR(t,this._graphDesign),t.videoId)){var n=this._videosDict[t.videoId];if(!n)return void console.warn("videoId ".concat(t.videoId," for chapter ").concat(t.id," not found}"));var r=r3.videosInfo[n.id];this._nodes[t.id].videoInfo={id:(null==r?void 0:r.id)||n.id,cover:(null==r?void 0:r.cover)||(null===(e=n.variants.find(function(t){return t.cover}))||void 0===e?void 0:e.cover)||"",title:(null==r?void 0:r.title)||n.title}}},t.prototype.showErrorMessage=function(t){aM.popups.show(t,h.translation.popup_error_title),this.reset()},t}(),r$=[[0,0],[0,0]],rG=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a},rq=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a},rU=function(t,e,n){if(n||2==arguments.length)for(var r,o=0,i=e.length;o<i;o++)!r&&o in e||(r||(r=Array.prototype.slice.call(e,0,o)),r[o]=e[o]);return t.concat(r||Array.prototype.slice.call(e))},rK=function(){function t(){this._sectors={},this.sectorsByNodes={},this.sectorsByCoordinates={},this.prevNodesMapCoordinates=r$,this._hasHiddenSectors=!1}return Object.defineProperty(t.prototype,"sectors",{get:function(){return Object.values(this._sectors)},set:function(t){this._sectors=rw(t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasHiddenSectors",{get:function(){return this._hasHiddenSectors},enumerable:!1,configurable:!0}),t.prototype.updateSectors=function(t,e){var n=this;if(void 0===e&&(e=r3.manifest.nodes),!r3.layout.isPerformanceBoostDisabled()){this._hasHiddenSectors=!1;var r=this.getNodesMapCoordinates();(0===this.sectors.length||this.nodesMapSizeChanged())&&(this.initSectors(),this.prevNodesMapCoordinates=r);var o=e.map(function(t){return t.id});this.seedSectorsWithNodes(o),this.sectors.forEach(function(e){var o,i,a,s,l,c,u,d,f,p,v,y,m,g,_,b,w=(o=e.size,i=e.indexes,a=rG(r,1),l=(s=rG(a[0],2))[0],c=s[1],d=(u=rG(i,2))[0],f=u[1],v=[(d-(p=h.performance.sectorsVirtualBorderWidth))*o,(d+p)*o+o].map(function(e){return(e+l)*t.scale+t.transformX}),y=[(f-p)*o,(f+p)*o+o].map(function(e){return(e+c)*t.scale+t.transformY}),m=v.some(function(e){return e>=0&&e<=t.viewWidth}),g=v[0]<0&&v[1]>t.viewWidth,_=y.some(function(e){return e>=0&&e<=t.viewHeight}),b=y[0]<0&&y[1]>t.viewHeight,(m||g)&&(_||b));e.visible=w,n._hasHiddenSectors||w||(n._hasHiddenSectors=!0)})}},t.prototype.isNodeVisible=function(t){var e=this.sectorsByNodes[t];return this._sectors[e].visible},t.prototype.getNodesMapCoordinates=function(){if(0===r3.manifest.nodes.length)return r$;var t=[],e=[];return r3.manifest.nodes.forEach(function(n){t.push(n.styles.x),e.push(n.styles.y)}),[[Math.min.apply(Math,rU([],rq(t),!1)),Math.min.apply(Math,rU([],rq(e),!1))],[Math.max.apply(Math,rU([],rq(t),!1)),Math.max.apply(Math,rU([],rq(e),!1))]]},t.prototype.initSectors=function(){var t=this;this.reset();var e={},n=this.getLayoutInfo(),r=n.sectorWidth,o=n.sectorsInRow,i=n.sectorsCount;this.sectors=Array(i).fill(null).map(function(n,i){var a=t.createSector(i,r,o);return e[a.indexes.join()]=a.id,a}),this.sectorsByCoordinates=e},t.prototype.reset=function(){this.sectors=[],this.sectorsByCoordinates={},this.sectorsByNodes={},this.prevNodesMapCoordinates=r$},t.prototype.seedSectorsWithNodes=function(t){var e=this;this.sectors.forEach(function(t){return t.nodes=new Set}),this.sectorsByNodes={};var n=this.getLayoutInfo().sectorWidth,r=rq(this.getNodesMapCoordinates(),1),o=rq(r[0],2),i=o[0],a=o[1];t.forEach(function(t){var r=rQ(t),o=Math.floor((r.styles.x-i)/n),s=Math.floor((r.styles.y-a)/n),l=e.sectorsByCoordinates[[o,s].join()];if(!l)throw Error("No sector with coordinates ".concat([o,s]));e.sectorsByNodes[t]=l,e._sectors[l].nodes.add(t)})},t.prototype.nodesMapSizeChanged=function(){return!!this.prevNodesMapCoordinates&&this.prevNodesMapCoordinates.join()!==this.getNodesMapCoordinates().join()},t.prototype.getLayoutInfo=function(){var t=rq(this.getNodesMapCoordinates(),2),e=rq(t[0],2),n=e[0],r=e[1],o=rq(t[1],2),i=o[0],a=o[1],s=Math.abs(i-n),l=Math.abs(a-r),c=Math.max(Math.ceil(Math.sqrt(s*l/h.performance.sectorsCount)),h.performance.minSectorWidthInPixels),u=Math.ceil(s/c);return{sectorsInRow:u,sectorWidth:c,sectorsCount:Math.ceil(l/c)*u}},t.prototype.createSector=function(t,e,n){return{indexes:[t%n,Math.floor(t/n)],size:e,nodes:new Set,visible:!1,id:"".concat(t)}},t}(),rJ=function(t){if(t)return r3.manifest.nodesDict[t]},rQ=function(t){var e=rJ(t);if(!e)throw Error("Can't get node with id=".concat(t));return e},r1=function(t){var e=function(t){if(t)return r3.manifest.branchesDict[t]}(t);if(!e)throw Error("Can't get branch with id=".concat(t));return e},r0=function(t){var e=rJ(t);if(!e)throw Error("Can't get node with id=".concat(t));return e.styles},r2=function(){var t=new Set;return r3.manifest.nodes.forEach(function(e){return t.add(e.chapter.label)}),t},r5=function(){return(r5=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},r4=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a},r6=function(t,e,n){if(n||2==arguments.length)for(var r,o=0,i=e.length;o<i;o++)!r&&o in e||(r||(r=Array.prototype.slice.call(e,0,o)),r[o]=e[o]);return t.concat(r||Array.prototype.slice.call(e))},r9=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};let r3=new(function(){function t(){var t=this;this.zoomFactor=1,this.isGraphFrozen=!1,this.selectedNodes=new Set,this.selectedBranches=new Set,this.copiedNodes=new Set,this.visitedNodes=new Set,this.hoveredNodes=new Set,this.nodesErrors={},this.videosInfo={},this.updateVideosInfo=function(e){t.videosInfo=rw(e,function(t){return t.id})},this.selectNodes=function(e,n){void 0===n&&(n=!0);var r,o=new Set(e);((r=t.selectedNodes).size!==o.size||!rx([],rC(r),!1).every(function(t){return o.has(t)}))&&(t.selectedNodes=o,n&&rL(r6([],r4(e),!1)))},this.addNodeToSelected=function(e){t.selectedNodes.add(e),rL(r6([],r4(t.selectedNodes),!1))},this.removeNodeFromSelected=function(e){t.selectedNodes.delete(e),rL(r6([],r4(t.selectedNodes),!1))},this.clearSelectedNodes=function(e){void 0===e&&(e=!0),e&&t.selectedNodes.size&&rL([]),t.selectedNodes.clear()},this.addNodesToHovered=function(e){e.forEach(function(e){return t.hoveredNodes.add(e)})},this.removeNodesFromHovered=function(e){e.forEach(function(e){return t.hoveredNodes.delete(e)})},this.clearHoveredNodes=function(){t.hoveredNodes.clear()},this.selectBranches=function(e){t.selectedBranches=new Set(e),f.emit("selectBranches",r6([],r4(t.selectedBranches),!1))},this.clearSelectedBranches=function(){t.selectedBranches.clear(),f.emit("selectBranches",[])},this.copySelectedNodes=function(){t.selectedNodes.size&&(t.copiedNodes=new Set(t.selectedNodes),1===t.copiedNodes.size?f.emit("notification",{id:"copy_chapter",defaultTranslation:h.translation.copy_chapter}):f.emit("notification",{id:"copy_multiple_chapters",defaultTranslation:h.translation.copy_multiple_chapters}))},this.pasteNodes=function(e){var n,r;if(t.copiedNodes.size){var o=h.render.tool.copyPasteDx,i=h.render.tool.copyPasteDy;if(e){var a=r0(r4(t.copiedNodes,1)[0]);o=e[0]-a.x,i=e[1]-a.y}var s=[],l={},c=function(e){t.manifest.duplicateNode(e,[o,i],function(t){s.push(t),l[e]=t})};try{for(var u=r9(t.copiedNodes),d=u.next();!d.done;d=u.next())c(d.value)}catch(t){n={error:t}}finally{try{d&&!d.done&&(r=u.return)&&r.call(u)}finally{if(n)throw n.error}}t.copyNodeBranches(l),rO(s),t.manifest.updateBranches(),aM.layers.update(),aM.layers.updateSelected(s)}},this.deleteSelection=function(e){var n,r,o,i;if(t.selectedBranches.size){try{for(var a=r9(t.selectedBranches),s=a.next();!s.done;s=a.next()){var l=s.value,c=t.manifest.selectBranch(l);null===(o=rJ(c.source.chapterId))||void 0===o||o.deleteBranch(c.id)}}catch(t){n={error:t}}finally{try{s&&!s.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}t.clearSelectedBranches(),t.manifest.deleteGraphBranches(Array.from(t.selectedBranches)).updateBranches().save(),null==e||e()}t.selectedNodes.size&&((null===(i=t.manifest.metadata)||void 0===i?void 0:i.initChapterId)&&t.selectedNodes.has(t.manifest.metadata.initChapterId)?f.emit("notification",{id:"remove_init_chapter",defaultTranslation:h.translation.remove_initial_chapter}):rE(r6([],r4(t.selectedNodes),!1)),null==e||e())},this.setVisitedNodes=function(e){t.visitedNodes=new Set(e)},this.updatedSelectedBranches=function(){t.selectedBranches.forEach(function(e){t.manifest.branchesDict[e]||t.selectedBranches.delete(e)})},this.clearSelection=function(){t.clearSelectedNodes(),t.clearSelectedBranches()},this.reset=function(){t.manifest.reset(),t.clearSelectedNodes(!1)},this.manifest=new rX,this.sectors=new rK,this.layout=new rB,this.reset()}return Object.defineProperty(t.prototype,"nodesWithErrors",{get:function(){return Object.keys(this.nodesErrors).map(rQ)},enumerable:!1,configurable:!0}),t.prototype.setNodeErrors=function(t){Object.keys(this.nodesErrors).filter(function(e){return!t[e]}).forEach(function(t){var e=rQ(t);e.chapterErrors=[],e.setModified()}),Object.keys(t).forEach(function(e){var n=rQ(e);n.chapterErrors=t[e],n.setModified()}),this.nodesErrors=r5({},t)},t.prototype.getCopiedBranchControlId=function(t,e){if(t.type===rI.Action){var n=rQ(t.source.chapterId).chapter.containers.flatMap(function(t){return t.controls}).findIndex(function(e){return e.events.find(function(e){var n;return(null===(n=e.action.args)||void 0===n?void 0:n.branchId)===t.id})});return e.chapter.containers.flatMap(function(t){return t.controls})[n].id}},t.prototype.getCopiedBranchContainerId=function(t,e){if(t.type===rI.Inaction){var n=rQ(t.source.chapterId).chapter.containers.findIndex(function(e){return e.events.find(function(e){var n;return(null===(n=e.action.args)||void 0===n?void 0:n.branchId)===t.id})});return e.chapter.containers[n].id}},t.prototype.copyNodeBranches=function(t){var e=this;Object.keys(t).map(rQ).forEach(function(n){var r=n.branches.filter(function(e){return t[e.target.chapterId]}),o=rQ(t[n.id]);r.forEach(function(n){var r=t[n.target.chapterId],i=e.getCopiedBranchControlId(n,o),a=e.getCopiedBranchContainerId(n,o);o.addBranch(r,i,a)})})},t}());var r7,r8,ot=function(){function t(t){var e=this;this.dispose=function(){e._root.selectAll("*").remove(),e._root.remove()},this.getRelativeEventCoordinates=function(t,n){return eI(t,n||e._map.node())},this.getEditorWindowSize=function(){var t,n=null===(t=e._root.node())||void 0===t?void 0:t.getBoundingClientRect();return{width:(null==n?void 0:n.width)||0,height:(null==n?void 0:n.height)||0}},this.updateEditorBackgroundColor=function(){e._root.style("background-color",r3.manifest.styles.background.color)},this._root=eP(t).append("div").attr("id","movika-graph-editor").style("position","relative").style("width","100%").style("height","100%").style("padding",0).style("margin",0).on("contextmenu",function(t){t.preventDefault()}),this.initStyles(),this._svg=this._root.append("svg").style("width","100%").style("height","100%"),this._grid=this._svg.append("g").attr("id","grid-group"),this._map=this._svg.append("g").attr("id","map-group").attr("transform","translate(0, 0) scale(1)").style("will-change","transform"),this._staticTools=this._svg.append("g").attr("id","static-tools-group"),this._defs=this._svg.append("defs"),f.on("zoom",function(t){var n=Math.round(t.x),r=Math.round(t.y),o=t.value;e._map.attr("transform","translate(".concat(n,", ").concat(r,") scale(").concat(o,")"))})}return Object.defineProperty(t.prototype,"root",{get:function(){return this._root},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"svg",{get:function(){return this._svg},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"grid",{get:function(){return this._grid},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"map",{get:function(){return this._map},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"staticTools",{get:function(){return this._staticTools},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"defs",{get:function(){return this._defs},enumerable:!1,configurable:!0}),t.prototype.select=function(t){return this._root.select(t)},t.prototype.selectAll=function(t){return this._root.selectAll(t)},Object.defineProperty(t.prototype,"viewPosition",{get:function(){var t=this.getEditorWindowSize();return{scale:aM.inputs.zoom.zoomFactor,viewWidth:t.width,viewHeight:t.height,transformY:aM.inputs.zoom.zoomPosition.y,transformX:aM.inputs.zoom.zoomPosition.x}},enumerable:!1,configurable:!0}),t.prototype.initStyles=function(){this._root.append("style").html("\n      #movika-graph-editor {\n        background-color: ".concat(r3.manifest.styles.background.color,";\n        font-family: inherit;\n        font-size: 12px;\n      }\n\n      #movika-graph-editor * { box-sizing: border-box; }\n\n      #movika-graph-editor.zoom_hand_tool { cursor: grab; }\n\n      #movika-graph-editor.zoom_hand_tool_active { cursor: grabbing; }\n\n      #movika-graph-editor.zoom_hand_tool #map-group,\n      #movika-graph-editor.zoom_hand_tool_active #map-group { pointer-events: none; }\n\n      #movika-graph-editor svg { user-select: none; -webkit-user-select: none; }\n\n      #movika-graph-editor svg text, #movika-graph-editor svg div { pointer-events: none; }\n\n      .mge-editorPopup {\n        display: flex;\n        flex-direction: column;\n        justify-content: center;\n        align-items: center;\n        font-size: 11px;\n        line-height: 16px;\n        background-color: ").concat(h.render.color.tooltipBackground,";\n        color: ").concat(h.render.color.text,';\n        border-radius: 4px;\n        padding: 8px 12px;\n        position: absolute;\n        will-change: transform;\n        color: #F2F5FF;\n        font-weight: 400;\n        h5 {\n          margin-top: 12px;\n          font-size: 12px;\n          margin-bottom: 2px;\n          font-weight: 800;\n        }\n        h5:first-child {\n         margin-top: 0;\n        }\n      }\n\n      .mge-editorPopup.arrow::after {\n         content: "";\n         position: absolute;\n         width: 11px;\n         height: 11px;\n         border-radius: 30px 0 8px 0;\n         background: #282A2E;\n         transform: translateX(-50%) translateY(-50%) rotate(45deg);\n         bottom: -11px;\n         left: 50%;\n         box-shadow: 0px 4px 4px 0px #00000040;\n      }\n\n      #movika-graph-editor .mge-legend {\n        display: flex;\n        align-items: center;\n        background-color: rgba(17, 17, 17, 0.8);\n        border-radius: 8px;\n        padding: 2px 4px;\n        color: #FFFFFF;\n        font-weight: 400;\n        text-shadow: 0px 0px 4px rgba(21, 18, 49, 0.23);\n        position: absolute;\n        top: calc(10px + env(safe-area-inset-top));\n        user-select: none;\n        pointer-events: none;\n      }\n      #movika-graph-editor .mge-legend.mge-graph { left: 10px; }\n      #movika-graph-editor .mge-legend.mge-navigation { right: 10px; }\n      #movika-graph-editor .mge-legend.mge-navigation .mge-icon {\n        width: 28px;\n        height: 28px;\n      }\n      #movika-graph-editor .mge-legendItem {\n        display: flex;\n        align-items: center;\n        position: relative;\n        height: 36px;\n        padding: 8px;\n      }\n      #movika-graph-editor .mge-legendItem:not(:last-child) { margin-right: 12px; }\n      #movika-graph-editor .mge-legendItem:not(:last-child)::after {\n        content: "•";\n        color: rgba(255, 255, 255, 0.4);\n        position: absolute;\n        right: -8px;\n        top: 10px;\n      }\n      #movika-graph-editor .mge-legendItem .mge-icon {\n        color: #FFFFFF;\n        width: 20px;\n        height: 20px;\n        margin-right: 8px;\n      }\n      #movika-graph-editor .mge-legendItem .mge-icon.withBg {\n        color: #222222;\n        background-color: #FFFFFF;\n        border-radius: 50%;\n        padding: 4px;\n      }\n      #movika-graph-editor .mge-text {\n        font-size: 12px;\n        font-weight: 500;\n        color: rgb(255, 255, 255);\n        overflow: hidden;\n        white-space: nowrap;\n        text-overflow: ellipsis;\n      }\n      #movika-graph-editor .mge-legendItem .mge-icon svg { display: inline-block; }\n      @media screen and (max-device-width: 600px) and (orientation: portrait) {\n        #movika-graph-editor .mge-legend.mge-navigation { display: none; }\n      }\n      @media screen and (max-device-width: 900px) and (orientation: landscape) {\n        #movika-graph-editor .mge-legend.mge-navigation { display: none; }\n      }\n    '))},t}(),oe=h.render.grid.size*h.render.grid.steps,on=[{id:"grid",numberOfCells:1,strokeWidth:.2,fillOpacity:1},{id:"inner_grid",numberOfCells:h.render.grid.steps,strokeWidth:.2,fillOpacity:.8}],or=function(){function t(t){var e=this;this._gridDomElement=t,this._zoom={value:1,x:0,y:0},this._displayGrid=r3.manifest.styles.background.grid.enabled,this.dispose=function(){e._gridDomElement.selectAll("*").remove()},this.getSnappedCoordinates=function(t){var n=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a}(t,2),r=n[0],o=n[1];return[e.getSnappedCoordinateValue(r),e.getSnappedCoordinateValue(o)]},this.getSnappedCoordinateValue=function(t){return aM.inputs.keydown.shiftHold&&e._displayGrid?+(Math.floor(t/h.render.grid.size)*h.render.grid.size).toFixed(2):t},this.update=function(){e._displayGrid=r3.manifest.styles.background.grid.enabled,e.updateGridVisibility(),e._displayGrid&&e.updateGridColor()},this.renderPatterns(t),this.renderRect(t),this.updateGridColor(),this.updateGridVisibility(),f.on("zoom",function(t){e._zoom=t,e._displayGrid&&e.updateGridSize()})}return t.prototype.updateGridColor=function(){aM.dom.select("#grid rect").attr("stroke",r3.manifest.styles.background.grid.color),aM.dom.select("#inner_grid rect").attr("stroke",r3.manifest.styles.background.grid.color)},t.prototype.updateGridSize=function(){var t=this;on.forEach(function(e){if("inner_grid"===e.id){if(t._zoom.value<=.3)return void aM.dom.select("#inner_grid_rect").style("display","none");aM.dom.select("#inner_grid_rect").style("display",null)}var n=t._zoom.value*oe/e.numberOfCells;aM.dom.select("#".concat(e.id)).attr("x",t._zoom.x%n).attr("y",t._zoom.y%n).attr("width",n).attr("height",n)})},t.prototype.updateGridVisibility=function(){this._displayGrid?(this.updateGridSize(),this._gridDomElement.style("display",null)):this._gridDomElement.style("display","none")},t.prototype.renderPatterns=function(t){t.selectAll("pattern").data(on).join("pattern").attr("id",function(t){return t.id}).attr("width",function(t){return oe/t.numberOfCells}).attr("height",function(t){return oe/t.numberOfCells}).attr("patternUnits","userSpaceOnUse").append("rect").attr("width","100%").attr("height","100%").attr("stroke-width",function(t){return t.strokeWidth}).attr("fill","none")},t.prototype.renderRect=function(t){on.forEach(function(e){t.append("rect").attr("x",0).attr("y",0).attr("id",e.id+"_rect").attr("width","100%").attr("height","100%").attr("fill","url(#".concat(e.id,")")).attr("fill-opacity",e.fillOpacity)})},t}();(oo=r8||(r8={})).C="KeyC",oo.V="KeyV",oo.G="KeyG",oo.H="KeyH",oo.Equal="Equal",oo.Minus="Minus",oo.NumpadAdd="NumpadAdd",oo.NumpadSubtract="NumpadSubtract",oo.Delete="Delete",oo.Backspace="Backspace",oo.ShiftLeft="ShiftLeft",oo.Space="Space";var oo,oi,oa,os,ol,oc,ou,od,oh,of,op,ov=function(){function t(){var t=this;this._shiftHold=!1,this._spaceHold=!1,this.dispose=function(){document.removeEventListener("keydown",t.shortcutsHandler),document.removeEventListener("keydown",t.holdKeyHandler),document.removeEventListener("keyup",t.holdKeyHandler),window.removeEventListener("blur",t.resetHoldKey)},this.shortcutsHandler=function(e){if(!t.ignoreKeyboardEvent(e)){switch(e.code){case r8.Equal:case r8.NumpadAdd:t.handleZoomIn();break;case r8.Minus:case r8.NumpadSubtract:t.handleZoomOut()}if(h.isEditMode()){if(e.repeat)return;if(e.ctrlKey||e.metaKey){if(e.code===r8.C)return void t.handleCopy();if(e.code===r8.V)return void t.handlePaste()}switch(e.code){case r8.Backspace:case r8.Delete:t.handleDelete();break;case r8.H:aM.inputs.zoom.toggleMousedownZoom();break;default:return}}else if(h.isPreViewMode()){if(e.repeat||e.code!==r8.H)return;aM.inputs.zoom.toggleMousedownZoom()}}},this.holdKeyHandler=function(e){if(!t.ignoreKeyboardEvent(e)&&!e.repeat){var n="keydown"===e.type;switch(e.code){case r8.ShiftLeft:t._shiftHold=n;break;case r8.Space:t._spaceHold=n,n?aM.inputs.zoom.enableMousedownZoom():aM.inputs.zoom.disableMousedownZoom();break;default:return}}},this.resetHoldKey=function(){t._shiftHold=!1,t._spaceHold=!1},document.addEventListener("keydown",this.shortcutsHandler),document.addEventListener("keydown",this.holdKeyHandler),document.addEventListener("keyup",this.holdKeyHandler),window.addEventListener("blur",this.resetHoldKey)}return Object.defineProperty(t.prototype,"shiftHold",{get:function(){return this._shiftHold},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"spaceHold",{get:function(){return this._spaceHold},enumerable:!1,configurable:!0}),t.prototype.handleCopy=function(){r3.copySelectedNodes()},t.prototype.handlePaste=function(){r3.pasteNodes()},t.prototype.handleDelete=function(){r3.deleteSelection(function(){aM.tools.disable()})},t.prototype.handleZoomIn=function(){aM.inputs.zoom.update(function(t){return t+.1})},t.prototype.handleZoomOut=function(){aM.inputs.zoom.update(function(t){return t-.1})},t.prototype.ignoreKeyboardEvent=function(t){return r3.isGraphFrozen||t.defaultPrevented||["INPUT","TEXTAREA"].includes(t.target.nodeName)},t}(),oy=function(){function t(t){this.toolId=t,this.toolElement=n_("svg:g").datum([0,0]).attr("id",t).attr("transform","translate(0, 0)").style("display","none").call(aM.inputs.nullableDrag())}return t.prototype.render=function(t){var e=this;t.append(function(){return e.toolElement.node()})},t.prototype.start=function(){aM.inputs.zoom.disable(),this.toolElement.style("display","inline")},t.prototype.stop=function(){aM.inputs.zoom.enable(),this.toolElement.style("display","none")},t.prototype.clear=function(){this.toolElement.selectAll("*").remove()},t.prototype.position=function(t){var e=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a}(t,2),n=e[0],r=e[1];return this.toolElement.datum([n,r]).attr("transform",function(){return"translate(".concat(n,", ").concat(r,")")}),this},t.test=!0,t}(),om=12*h.render.grid.size,og=function(t){return t.append("path").attr("d",function(){return nq({x:0,y:0,w:186,h:om,r:h.render.node.borderRadius})}).attr("width",186).attr("height",om).attr("stroke-width",h.render.strokeSize).style("stroke-dasharray","3, 3").attr("stroke",h.render.color.shadowNodeStroke).attr("fill",h.render.color.shadowNodeFill)},o_=function(t,e,n){return{primaryTextContainer:ob(t,e),secondaryTextContainer:n?ob(t,n,!0):void 0}},ob=function(t,e,n){void 0===n&&(n=!1);var r=e.split("\n"),o=t.append("text").style("display",n?"none":"inline").style("fill","#F2F5FF").attr("font-weight",500).attr("y",om/2.2).attr("transform","translate(".concat(93,")")).attr("text-rendering","optimizeSpeed");return r.forEach(function(t){o.append("tspan").text(t).attr("text-anchor","middle").attr("x",0).attr("dy",17)}),o},ow=function(t,e){return!(t.minX>e.maxX||t.maxX<e.minX||t.minY>e.maxY||t.maxY<e.minY)},oC=function(t){return r3.manifest.nodes.some(function(e){return ow(t,e.getBBox())})},ox=function(t){var e="string"==typeof t?t:t.id;return!!r3.nodesErrors[e]&&r3.nodesErrors[e].length>0},oM=function(t,e){return ox(t)?e?h.render.color.activeError:h.render.color.error:t.stylesWithDefaults.hover.borderColor},ok=(of=function(t,e){return(of=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}of(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),oS=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a},oN=function(t){function e(){var e=t.call(this,"area-select")||this;return e._rectBoundingBox={minX:0,minY:0,maxX:0,maxY:0},e._needForRAF=!0,e._selectedNodeIds=[],e.render=function(n){t.prototype.render.call(e,n),e._rectElement=e.toolElement.append("rect").attr("id","select-area-rect").attr("fill","#7b68ee").attr("fill-opacity","0.05").attr("stroke","#8978F0").attr("stroke-width","0.5").attr("shape-rendering","crispEdges")},e}return ok(e,t),e.prototype.start=function(){var e=this;t.prototype.start.call(this),aM.dom.svg.on("mousedown.areaSelect",function(){var t;null===(t=e._rectElement)||void 0===t||t.attr("width",0).attr("height",0)}).on("mousemove.areaSelect",function(t){if(e._needForRAF){e._needForRAF=!1,aM.dom.select("#nodes").attr("pointer-events","none"),aM.dom.select("#branches").attr("pointer-events","none");var n=oS(e.toolElement.datum(),2),r=n[0],o=n[1],i=oS(eI(t),2),a=i[0],s=i[1];e.animationFrame=requestAnimationFrame(function(){var t,n=Math.abs(r-a),i=Math.abs(o-s);null===(t=e._rectElement)||void 0===t||t.attr("x",r<a?0:-n).attr("y",o<s?0:-i).attr("width",n).attr("height",i),e._selectedNodeIds=aM.inputs.keydown.shiftHold?function(t,e,n){if(n||2==arguments.length)for(var r,o=0,i=e.length;o<i;o++)!r&&o in e||(r||(r=Array.prototype.slice.call(e,0,o)),r[o]=e[o]);return t.concat(r||Array.prototype.slice.call(e))}([],oS(r3.selectedNodes),!1):[];var l=oS(aM.inputs.zoom.getRelativeCoordinates([r,o]),2),c=l[0],u=l[1],d=oS(aM.inputs.zoom.getRelativeCoordinates([a,s]),2),h=d[0],f=d[1];e._rectBoundingBox.minX=h<c?h:c,e._rectBoundingBox.maxX=h<c?c:h,e._rectBoundingBox.minY=f<u?f:u,e._rectBoundingBox.maxY=f<u?u:f,r3.manifest.nodes.forEach(function(t){ow(e._rectBoundingBox,t.getBBox())&&e._selectedNodeIds.push(t.id)}),aM.layers.updateSelected(e._selectedNodeIds),e._needForRAF=!0})}}).on("mouseup.areaSelect",function(){aM.layers.updateSelected(e._selectedNodeIds),e.stop()})},e.prototype.data=function(){return this},e.prototype.stop=function(){var e;aM.dom.svg.on("mousemove.areaSelect",null).on("mouseup.areaSelect",null),this.animationFrame&&cancelAnimationFrame(this.animationFrame),null===(e=this._rectElement)||void 0===e||e.attr("x",0).attr("y",0).attr("width",0).attr("height",0),this._rectBoundingBox.minX=0,this._rectBoundingBox.maxX=0,this._rectBoundingBox.minY=0,this._rectBoundingBox.maxY=0,this._needForRAF=!0,this._selectedNodeIds.length=0,aM.dom.select("#nodes").attr("pointer-events",null),aM.dom.select("#branches").attr("pointer-events",null),t.prototype.stop.call(this)},e}(oy),oE=(oi=function(t,e){return(oi=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}oi(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),oL=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a},oO=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._numberOfItems=0,e._isTooltipActive=!1,e}return oE(e,t),e.prototype.start=function(){t.prototype.start.call(this),this._numberOfItems=0,this.clear()},e.prototype.position=function(t){var e=oL(t,2),n=e[0],r=e[1],o=this.getSafeMenuToolArea(),i=o.minXPosition,a=o.minYPosition,s=o.horizontal,l=o.vertical,c=s-h.render.tool.menuItemWidth,u=l-h.render.tool.menuItemHeight*this._numberOfItems,d=Math.min(c,Math.max(i,n)),f=Math.min(u,Math.max(a,r));return this.toolElement.datum([n,r]).attr("transform",function(){return"translate(".concat(d,", ").concat(f,")")}),this},e.prototype.addMenuItem=function(t){var e,n,r,o,i,a,s,l,c,u,d=this,f=h.render.tool.menuItemHeight*this._numberOfItems,p=(n=(e={label:t.label,icon:t.icon,disabled:t.disabled,width:h.render.tool.menuItemWidth,height:h.render.tool.menuItemHeight,onClick:function(){t.onClick(),d.stop()}}).label,r=e.icon,i=void 0!==(o=e.disabled)&&o,s=void 0===(a=e.width)?h.render.node.width:a,l=e.height,c=e.onClick,(u=n_("svg:g").on("click",function(){i||c()})).append("rect").attr("x",0).attr("y",0).attr("width",s).attr("height",l||h.render.node.componentControlHeight).attr("fill",i?h.render.color.elementBackgroundAlt:h.render.color.elementBackground).on("mouseenter",function(){i||eP(this).attr("fill",h.render.color.elementBackgroundHover)}).on("mouseleave",function(){i||eP(this).attr("fill",h.render.color.elementBackground)}).style("cursor",i?"not-allowed":"pointer"),r&&u.append("use").style("color",h.render.tool.textColor).attr("x",8).attr("y",8).attr("href","#"+r).style("opacity",i?.4:1),u.append("text").text(n).attr("x",r?30:8).attr("y",20).attr("font-size",12).attr("font-weight",500).attr("text-anchor","start").style("fill",i?"#797B82":h.render.tool.textColor).attr("text-rendering","optimizeSpeed"),u).attr("transform","translate(0, ".concat(f,")"));if(t.tooltip){var v=t.tooltip;p.on("mouseenter",function(){if(!d._isTooltipActive){d._isTooltipActive=!0;var t=oL(d.toolElement.datum(),2),e=t[0],n=t[1];aM.popups.position([e+h.render.tool.menuItemTooltipOffset,n+f-10]).show(v,void 0,"tooltip")}}).on("mouseleave",function(){d._isTooltipActive&&(d._isTooltipActive=!1,aM.popups.hide())})}this.toolElement.append(function(){return p.node()}),this._numberOfItems+=1},e.prototype.createMenu=function(t){var e,n,r,o,i,a,s,l,c,u,d,f,p,v,y;n=(e={id:this.toolId,width:h.render.tool.menuItemWidth,height:h.render.tool.menuItemHeight*this._numberOfItems,element:this.toolElement,strokeColor:t||h.render.tool.strokeColor,r:h.render.tool.borderRadius}).id,r=e.width,o=e.height,u=(c={id:n,width:r,height:o,element:i=e.element,strokeColor:void 0===(a=e.strokeColor)?h.render.color.nodeStroke:a,r:l=void 0===(s=e.r)?h.render.node.borderRadius:s}).id,d=c.width,f=c.height,p=c.element,v=c.strokeColor,y=c.r,p.append("path").attr("id",nU+u).attr("d",nq({x:nQ,y:nQ,w:d-2*nQ,h:f-2*nQ,r:y-nJ})).attr("fill","none").attr("stroke-width",h.render.strokeSize).attr("stroke",v),n1({id:n,width:r,height:o,element:i,r:l})},e.prototype.getSafeMenuToolArea=function(){var t=aM.dom.getEditorWindowSize();return{minXPosition:10,minYPosition:10,horizontal:t.width-10,vertical:t.height-10}},e}(oy),oA=(oa=function(t,e){return(oa=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}oa(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),oT=function(t){function e(){return t.call(this,"control-menu")||this}return oA(e,t),e.prototype.start=function(){t.prototype.start.call(this);var e,n=rJ(null===(e=this._node)||void 0===e?void 0:e.id);if(!n||!this._control)throw Error("[Tool]: ControlMenuTool requires 'GraphNode' and 'Control' data");this.renderMenuItems(n,this._control)},e.prototype.data=function(t,e){return this._node=t,this._control=e,this},e.prototype.renderMenuItems=function(t,e){var n=t.chapter.containers.find(function(t){return!!t.controls.find(function(t){return t.id===e.id})}).id;this.addMenuItem({label:h.translation.tool_menu_item_rename,disabled:h.isPreViewMode(),onClick:function(){f.emit("control",{name:"renameControl",chapterId:t.id,containerId:n,control:e})}}),this.addMenuItem({label:h.translation.tool_menu_item_delete,disabled:h.isPreViewMode(),onClick:function(){f.emit("control",{name:"deleteControl",chapterId:t.id,controlId:e.id,containerId:n})}}),this.createMenu()},e}(oO),oB=(os=function(t,e){return(os=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}os(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),oz=function(t){function e(){return t.call(this,"control-type-menu")||this}return oB(e,t),e.prototype.start=function(){if(t.prototype.start.call(this),!this._node)throw Error("[Tool]: ControlTypeMenuTool requires 'GraphNode' data");this.renderMenuItems(this._node)},e.prototype.data=function(t){return this._node=t,this},e.prototype.renderMenuItems=function(t){this.addMenuItem({label:h.translation.tool_menu_item_control_button,icon:v.ActionButton,onClick:function(){f.emit("control",{name:"addControl",type:"Button",nodeId:t.id})}}),this.addMenuItem({label:h.translation.tool_menu_item_control_area,icon:v.ActionArea,onClick:function(){f.emit("control",{name:"addControl",type:"Area",nodeId:t.id})}}),this.createMenu()},e}(oO),oP=(ol=function(t,e){return(ol=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}ol(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),oI=function(t){function e(){return t.call(this,"editor-context-menu")||this}return oP(e,t),e.prototype.start=function(){t.prototype.start.call(this),this.renderMenuItems()},e.prototype.data=function(){return this},e.prototype.renderMenuItems=function(){var t=this;this.addMenuItem({label:h.translation.tool_menu_item_add_node,disabled:h.isPreViewMode(),onClick:function(){var e=aM.inputs.zoom.getRelativeCoordinates(t.toolElement.datum());r3.manifest.createNode(e),aM.layers.update()}}),this.addMenuItem({label:h.translation.tool_menu_item_copy,disabled:!r3.selectedNodes.size||h.isPreViewMode(),onClick:function(){r3.copySelectedNodes()}}),this.addMenuItem({label:h.translation.tool_menu_item_paste,disabled:!r3.copiedNodes.size||h.isPreViewMode(),onClick:function(){var e=aM.inputs.zoom.getRelativeCoordinates(t.toolElement.datum());r3.pasteNodes(e)}}),this.addMenuItem({label:h.translation.tool_menu_item_delete,disabled:!r3.selectedNodes.size||h.isPreViewMode(),onClick:function(){r3.deleteSelection()}}),this.createMenu()},e}(oO),oD=(oc=function(t,e){return(oc=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}oc(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),oZ=function(t){function e(){return t.call(this,"eov-menu")||this}return oD(e,t),e.prototype.start=function(){t.prototype.start.call(this);var e,n=rJ(null===(e=this._node)||void 0===e?void 0:e.id);if(!n)throw Error("[Tool]: EOVMenuTool requires 'GraphNode' data");this.renderMenuItems(n)},e.prototype.data=function(t){return this._node=t,this},e.prototype.renderMenuItems=function(t){this.addMenuItem({label:h.translation.tool_menu_item_next_node,icon:v.Node,onClick:function(){t.updateChapterSuspenseAction("setNextBranch"),rS(t.chapter),r3.manifest.updateBranches()}});var e=!!t.containers().length;this.addMenuItem({label:h.translation.tool_menu_item_random,icon:v.Random,disabled:!e,tooltip:e?void 0:h.translation.tool_menu_item_random_tooltip,onClick:function(){t.updateChapterSuspenseAction("setRandomBranch"),r3.manifest.updateBranches(),rS(t.chapter)}}),this.createMenu(h.render.color.stroke)},e}(oO),oj=(ou=function(t,e){return(ou=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}ou(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),oV=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a},oH=function(t,e,n){if(n||2==arguments.length)for(var r,o=0,i=e.length;o<i;o++)!r&&o in e||(r||(r=Array.prototype.slice.call(e,0,o)),r[o]=e[o]);return t.concat(r||Array.prototype.slice.call(e))},oF=function(t){function e(){return t.call(this,"node-menu")||this}return oj(e,t),e.prototype.start=function(){t.prototype.start.call(this);var e,n=rJ(null===(e=this._node)||void 0===e?void 0:e.id);if(!n)throw Error("[Tool]: NodeMenuTool requires 'GraphNode' data");this.renderMenuItems(n)},e.prototype.data=function(t){return this._node=t,this},e.prototype.renderMenuItems=function(t){var e,n=oH([],oV(r3.selectedNodes),!1).map(rQ),r=null===(e=r3.manifest.metadata)||void 0===e?void 0:e.initChapterId,o=n.length>1,i=!!r&&r3.selectedNodes.has(r),a=n.some(function(t){return"end"!==t.chapter.order})&&n.every(function(t){return!t.getSuspenseBranchId()&&!t.controls().length&&"start"!==t.chapter.order}),s=n.some(function(t){return"simple"!==t.chapter.order});this.addMenuItem({label:h.translation.tool_menu_item_rename,onClick:function(){f.emit("control",{name:"renameChapter",chapterId:t.id})},disabled:o}),this.addMenuItem({label:h.translation.tool_menu_item_copy,disabled:h.isPreViewMode(),onClick:function(){r3.copySelectedNodes()}}),this.addMenuItem({label:h.translation.tool_menu_item_delete,disabled:i,onClick:function(){return rE(oH([],oV(r3.selectedNodes),!1))}}),this.addMenuItem({label:h.translation.tool_menu_item_as_start_node,icon:v.StartNode,disabled:"start"===t.chapter.order||o,onClick:function(){rN({id:t.chapter.id,order:"start"})}}),this.addMenuItem({label:o?h.translation.tool_menu_items_as_node:h.translation.tool_menu_item_as_node,icon:v.Node,disabled:!s,onClick:function(){var e=n.filter(function(t){return"simple"!==t.chapter.order});1===e.length?rN({id:t.chapter.id,order:"simple"}):(e.forEach(function(t){return r3.manifest.setNodeOrder(t.id,"simple")}),r3.manifest.save())}}),this.addMenuItem({label:o?h.translation.tool_menu_items_as_end_node:h.translation.tool_menu_item_as_end_node,icon:v.EndNode,disabled:!a,onClick:function(){1===n.length?rN({id:t.chapter.id,order:"end"}):(n.forEach(function(t){return r3.manifest.setNodeOrder(t.id,"end")}),r3.manifest.save())}}),this.addMenuItem({label:h.translation.tool_menu_item_start_preview,onClick:function(){f.emit("control",{name:"openPreview",chapterId:t.id})},disabled:o||!t.chapter.videoId}),this.createMenu()},e}(oO),oR=(od=function(t,e){return(od=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}od(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),oY=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a},oW=om/3.3,oX=function(t){function e(){var e=t.call(this,"shadow-node")||this;return e._displayToolError=!1,e.render=function(n){t.prototype.render.call(e,n),e._shadowNode=og(e.toolElement),e.toolElement.append("svg").attr("x",83).attr("y",oW).attr("width",h.render.iconSize+5).attr("height",h.render.iconSize+5).attr("viewBox","0 0 ".concat(h.render.iconSize," ").concat(h.render.iconSize)).append("use").style("color",h.render.tool.textColor).attr("href","#".concat(v.Move));var r=o_(e.toolElement,h.translation.tool_shadow_node_text,h.translation.tool_shadow_node_error),o=r.primaryTextContainer,i=r.secondaryTextContainer;e._primaryText=o,e._secondaryText=i,e.toolElement.on("click",function(t){return t.preventDefault()}).on("contextmenu",function(t){return t.preventDefault()})},e}return oR(e,t),e.prototype.start=function(){t.prototype.start.call(this),this.redraw(),this.enableMouseMove()},e.prototype.data=function(){return this},e.prototype.stop=function(){aM.dom.svg.style("cursor",null).on("click.shadowNode",null).on("mousemove.shadowNode",null).on("contextmenu.shadowNode",null),f.emit("control",{name:"addChapterStopped"}),t.prototype.stop.call(this)},e.prototype.enableMouseMove=function(){var t=this;aM.dom.svg.style("cursor","none"),aM.dom.svg.on("click.shadowNode",function(e){e.preventDefault(),t._displayToolError||(r3.manifest.createNode(t.toolElement.datum()),aM.layers.update()),t.stop()}).on("mousemove.shadowNode",function(e){var n=oY(aM.dom.getRelativeEventCoordinates(e),2),r=n[0],o=n[1],i=aM.grid.getSnappedCoordinates([r-93,o-oW]);t.toolElement.datum(i).attr("transform",function(){return"translate(".concat(i[0],", ").concat(i[1],")")}),t.redraw()}).on("contextmenu.shadowNode",function(e){e.preventDefault(),t.stop()})},e.prototype.redraw=function(){var t=oC(this.getShadowNodeBox());this._displayToolError!==t&&(this._displayToolError=t,this.renderToolError())},e.prototype.renderToolError=function(){var t,e,n;null===(t=this._shadowNode)||void 0===t||t.attr("fill",this._displayToolError?h.render.color.error:h.render.color.shadowNodeFill).attr("fill-opacity","0.21").attr("stroke",this._displayToolError?h.render.color.error:h.render.color.shadowNodeStroke).attr("stroke-opacity","0.3"),null===(e=this._primaryText)||void 0===e||e.style("display",this._displayToolError?"none":"inline"),null===(n=this._secondaryText)||void 0===n||n.style("display",this._displayToolError?"inline":"none")},e.prototype.getShadowNodeBox=function(){var t=oY(this.toolElement.datum(),2),e=t[0],n=t[1];return{minX:e,minY:n,maxX:e+186,maxY:n+om}},e}(oy),o$="mge-node",oG="mge-branch",oq=function(t){return"#node-"+t},oU=function(t,e){return"".concat(oq(t)," .").concat(e)},oK=function(t){return aM.dom.select(oq(t))},oJ=function(){return aM.dom.selectAll("g.".concat(o$))},oQ=function(t){return aM.dom.select("#branch-"+t)},o1=function(){return aM.dom.selectAll("g.".concat(oG))},o0=function(t){return aM.dom.select("#".concat(h.render.prefix.nodeBorder).concat(t))},o2=function(t){return aM.dom.select(oU(t,"previewControls"))},o5=function(t,e){var n="nodeConnector";return e===rI.Action?n="nodeActionConnector":e===rI.Inaction&&(n="nodeInactionConnector"),aM.dom.select(oU(t,n))},o4=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a},o6=function(t,e){t.append("rect").attr("fill","transparent").attr("height",e).attr("width",e).attr("x",-e/2).attr("y",-e/2)},o9=function(t,e){var n=o4(e,2),r=n[0],o=n[1],i=n_("svg:g").attr("id",h.render.prefix.nodeFlipConnector+t.id).attr("class","nodeConnector").style("transform","translate(".concat(r,"px, ").concat(o,"px)")).style("display","inline");return o6(i,8),i.append("svg:use").attr("href","#".concat(t.displayLockedContent?nG.Connector:nG.ConnectorDisabled)),i.node()},o3=function(t,e){if(t.hasParentChapters(rI.Flip)){var n=o4(t.getIncomingConnectorsCoordinates()[rI.Flip]||[0,t.render.previewMiddleYCoordinate],2)[1],r=n_("svg:g").attr("class","nodeConnector").style("transform","translateY(".concat(n,"px)")).style("display",t.hasParentChapters(rI.Flip)?"inline":"none");o6(r,8),r.append("svg:use").attr("href","#".concat(nG.Connector)),e.append(function(){return r.node()})}},o7=function(t,e){if(t.hasParentChapters(rI.Action)){var n=o4(t.getIncomingConnectorsCoordinates()[rI.Action]||[0,t.render.previewMiddleYCoordinate],2),r=n[0],o=n[1];r-=h.render.node.control.connectorRadius,o-=h.render.node.control.connectorRadius;var i=n0(v.Action).attr("transform","translate(".concat(r,", ").concat(o,")")).attr("class","nodeActionConnector");e.append(function(){return i.node()})}},o8=function(t,e){if(t.hasParentChapters(rI.Inaction)){var n=o4(t.getIncomingConnectorsCoordinates()[rI.Inaction]||[0,t.render.previewMiddleYCoordinate],2),r=n[0],o=n[1];r-=h.render.node.control.connectorRadius,o-=h.render.node.control.connectorRadius;var i=n0(v.Inaction).attr("transform","translate(".concat(r,", ").concat(o,")")).attr("class","nodeInactionConnector");e.append(function(){return i.node()})}},it=(oh=function(t,e){return(oh=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}oh(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),ie=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a},ir=function(t){function e(){var e=t.call(this,"shadow-node-link")||this;return e._displayToolError=!1,e.render=function(n){t.prototype.render.call(e,n),e._shadowNodeContainer=e.toolElement.append("g").style("display","none"),e._shadowNode=og(e._shadowNodeContainer);var r=o_(e._shadowNodeContainer,h.translation.tool_shadow_node_link_text,h.translation.tool_shadow_node_error),o=r.primaryTextContainer,i=r.secondaryTextContainer;e._primaryText=o,e._secondaryText=i,e._shadowBranch=e.toolElement.append("path").attr("fill","none").attr("stroke",h.render.color.stroke),e.renderDefaultLine(),e.toolElement.append("rect").attr("fill","transparent").attr("x",-h.render.iconSize/2).attr("y",-h.render.iconSize/2).attr("width",h.render.iconSize).attr("height",h.render.iconSize).style("cursor","pointer"),e.toggleHoverEffects(!0)},e.stop=function(){e.renderDefaultLine(),e._node=void 0,e._parentControl=void 0,e._parentContainer=void 0,e._type=void 0,e.toolElement.call(aM.inputs.nullableDrag()),t.prototype.stop.call(e)},e.createSetNextBranchEvent=function(){if(!e._hasSetNextBranchEvent&&e._type!==rI.Flip){if(!e.node)throw Error("Node doesn't exist");switch(e._type){case rI.Action:e.node.updateControlActionEvent(e._parentContainer,e._parentControl,"setNextBranch");break;case rI.Inaction:e.node.updateContainerSuspenseAction(e._parentContainer,"setNextBranch")}rS(e.node.chapter)}},e.renderDefaultLine=function(){var t;null===(t=e._shadowBranch)||void 0===t||t.attr("d",n2({source:[0,0],target:[0,0]})).style("marker-start","").style("marker-end","")},e}return it(e,t),Object.defineProperty(e.prototype,"node",{get:function(){var t;return rJ(null===(t=this._node)||void 0===t?void 0:t.id)},enumerable:!1,configurable:!0}),e.prototype.start=function(){if(t.prototype.start.call(this),!this.node)throw Error("[Tool]: ShadowNodeLinkTool requires 'GraphNode' data");this.redraw(this.toolElement.datum()),this.enableDrag(this.node)},e.prototype.data=function(t,e,n,r,o){return void 0===o&&(o=!0),this._node=t,this._parentContainer=n,this._parentControl=r,this._type=e,this._hasSetNextBranchEvent=o,this},e.prototype.enableDrag=function(t){var e,n,r,o=this,i=!1;eq().on("start",function(e){r3.selectedNodes.has(t.id)||aM.layers.updateSelected([t.id]),aM.dom.select("#nodes").attr("pointer-events","none"),aM.dom.select("#branches").attr("pointer-events","none"),o._type===rI.Flip?o.updateEOVTool():(null===(i=o._shadowBranch)||void 0===i||i.style("marker-start","url(#".concat(y.Connector,")")),o.updateControlTool());var i,a=aM.grid.getSnappedCoordinates(e.subject);n=e.subject[0]-a[0],r=e.subject[1]-a[1],o.toggleHoverEffects(!1)}).on("drag",function(a){o.toolElement.style("display","inline");var s,l,c,u,d=aM.grid.getSnappedCoordinates([a.x-a.subject[0],a.y-a.subject[1]]),h=d[0]-n,f=d[1]-r;if(null===(s=o._shadowBranch)||void 0===s||s.attr("d",n2({source:[0,0],target:[h,f]})).style("marker-start","").style("marker-end","url(#".concat(y.Connector,")")),(e=o.pointInsideNodeBBox(aM.dom.getRelativeEventCoordinates(a)))&&t.id!==e.id){i=!1,null===(l=o._shadowNodeContainer)||void 0===l||l.style("display","none");var p=o5(e.id,o._type),v={chapterId:t.id,type:o._type||rI.Flip,connectorType:o._type||rI.Flip,branchId:null};if(e.updateIncomingConnectorsCoordinates(v),!p){var m=(u=e.id,aM.dom.select(oU(u,"nodeTools")));o._type===rI.Action?o7(e,m):o._type===rI.Inaction?o8(e,m):o3(e,m)}}else{i=!0,null===(c=o._shadowNodeContainer)||void 0===c||c.attr("transform","translate(".concat(h,", ").concat(f-om/2,")")).style("display","inline"),o.redraw(aM.dom.getRelativeEventCoordinates(a));var g=ie(aM.grid.getSnappedCoordinates(aM.dom.getRelativeEventCoordinates(a)),2),_=g[0],b=g[1];aM.layers.shiftLayersOnDragToEdge([[_,b],[_+186,b+om]])}}).on("end",function(n){var r;if(null===(r=o._shadowNodeContainer)||void 0===r||r.style("display","none"),o._type===rI.Flip?o.updateEOVTool(!1):o.updateControlTool(!1),aM.dom.select("#nodes").attr("pointer-events",null),aM.dom.select("#branches").attr("pointer-events",null),i){if(o._displayToolError)o.createSetNextBranchEvent();else{var a=ie(aM.grid.getSnappedCoordinates(aM.dom.getRelativeEventCoordinates(n)),2),s=a[0],l=a[1];r3.manifest.createNode([s,aM.grid.getSnappedCoordinateValue(l-om/2)],t.id,function(t){return o.createNodeBranch(t)}).updateBranches().save(),aM.layers.update()}}else e?(o.createNodeBranch(e.id),e.setModified(),r3.manifest.updateBranches().save()):o.createSetNextBranchEvent();i=!1,e=void 0,o.toggleHoverEffects(!0),o.stop()})(this.toolElement)},e.prototype.createNodeBranch=function(t){var e,n,r,o;this._parentControl?null===(e=this.node)||void 0===e||e.addBranch(t,this._type===rI.Action?null===(n=this._parentControl)||void 0===n?void 0:n.id:void 0,this._type===rI.Inaction?null===(r=this._parentContainer)||void 0===r?void 0:r.id:void 0):null===(o=this.node)||void 0===o||o.addBranch(t)},e.prototype.redraw=function(t){var e=oC(this.getShadowNodeBox(t));this._displayToolError!==e&&(this._displayToolError=e,this.renderToolError())},e.prototype.renderToolError=function(){var t,e,n;null===(t=this._shadowNode)||void 0===t||t.attr("fill",this._displayToolError?h.render.color.error:h.render.color.shadowNodeFill).attr("fill-opacity","0.21").attr("stroke",this._displayToolError?h.render.color.error:h.render.color.shadowNodeStroke).attr("stroke-opacity","0.3"),null===(e=this._primaryText)||void 0===e||e.style("display",this._displayToolError?"none":"inline"),null===(n=this._secondaryText)||void 0===n||n.style("display",this._displayToolError?"inline":"none")},e.prototype.getShadowNodeBox=function(t){var e=ie(t,2),n=e[0],r=e[1];return{minX:n,minY:r-om/2,maxX:n+186,maxY:r+om/2}},e.prototype.pointInsideNodeBBox=function(t){var e,n=this;return oJ().each(function(r){var o=rQ(r);e||(e=!function(t,e){for(var n,r,o=t.length,i=t[o-1],a=e[0],s=e[1],l=i[0],c=i[1],u=!1,d=0;d<o;++d)n=(i=t[d])[0],(r=i[1])>s!=c>s&&a<(l-n)*(s-r)/(c-r)+n&&(u=!u),l=n,c=r;return u}(o.getPolygon(),[t[0]+0,t[1]])?void 0:o),e||o.hasParentChapters(n._type)||o5(o.id,n._type).remove(),aM.dom.select("#"+nU+o.id).attr("stroke",oM(o,!1)).attr("stroke-opacity",1)}),e},e.prototype.updateEOVTool=function(t){void 0===t&&(t=!0),this.node&&!this._parentControl&&aM.dom.select("#".concat(h.render.prefix.nodeEOV+this.node.id)).select(".eovTypeLine").style("marker-start","url(#".concat(y.Circle)).style("marker-end",t?"":"url(#".concat(y.Circle))},e.prototype.updateControlTool=function(t){void 0===t&&(t=!0),aM.dom.select(".control_add_link_button_".concat(null===(e=this._parentControl)||void 0===e?void 0:e.id)).style("display","none"),aM.dom.select(".control_link_choice_".concat(null===(n=this._parentContainer)||void 0===n?void 0:n.id)).style("display","none");var e,n,r,o,i="action"===this._type?null===(r=this._parentControl)||void 0===r?void 0:r.id:null===(o=this._parentContainer)||void 0===o?void 0:o.id;aM.dom.select(".control_connector_".concat(i)).style("display",t?"none":"inline"),aM.dom.select(".start_link_".concat(i)).style("display","inline")},e.prototype.toggleHoverEffects=function(t){var e=this;t?this.toolElement.on("mouseenter",function(){var t;e.toolElement.style("display","inline"),null===(t=e._shadowBranch)||void 0===t||t.style("marker-start",e._hasSetNextBranchEvent?"url(#".concat(y.Connector,")"):"")}).on("mouseleave",function(){var t;null===(t=e._shadowBranch)||void 0===t||t.style("marker-start",e._hasSetNextBranchEvent?"url(#".concat(y.Circle,")"):"")}):this.toolElement.on("mouseenter",null).on("mouseleave",null)},e}(oy);(e=op||(op={})).ShadowNode="shadow-node",e.ShadowNodeLink="shadow-node-link",e.NodeMenu="node-menu",e.EOVMenu="eov-menu",e.ControlMenu="control-menu",e.ControlTypeMenu="control-type-menu",e.EditorContextMenu="editor-context-menu",e.AreaSelectTool="area-select-tool";var io=function(){function t(t){this._svgDOMElement=t,this.handleOutsideClick=function(t){t.defaultPrevented||aM.inputs.zoom.isMousedownZoomEnabled||aM.tools.disableContextMenu()},this._svgDOMElement.on("contextmenu",function(t){t.defaultPrevented||aM.inputs.zoom.isMousedownZoomEnabled||aM.tools.use(op.EditorContextMenu).position(eI(t)).start()}),this._svgDOMElement.on("mousedown",function(t){t.defaultPrevented||aM.inputs.zoom.isMousedownZoomEnabled||aM.tools.use(op.AreaSelectTool).position(eI(t)).start()}),this._svgDOMElement.on("click",function(t){t.defaultPrevented||aM.inputs.zoom.isMousedownZoomEnabled||(r3.selectedBranches.size&&r3.clearSelectedBranches(),aM.tools.disable())}),document.addEventListener("click",this.handleOutsideClick)}return t.prototype.dispose=function(){this._svgDOMElement.on("contextmenu",null),document.removeEventListener("click",this.handleOutsideClick)},t}(),ii=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a},ia=function(){function t(t){var e=this;this._svgDOMElement=t,this._zoomTransform=nZ,this._wheelDelay=300,this._wheel=null,this._mouse=[[0,0],[0,0]],this._mousedownZoomEnabled=!1,this._isZoomActive=!1,this._isZoomDisabled=!1,this.update=function(t){var n;e._isZoomDisabled||(n=is(n="function"==typeof t?t(e._zoomTransform.k):t),e._zoom.scaleTo(e._svgDOMElement,n))},this.translateTo=function(t,n){var r,o,i,a=ii(t,2),s=a[0],l=a[1];return void 0===n&&(n=e._zoomTransform.k),r=void 0,i=function(){var t,e,r,o,i;return function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}}(this,function(a){return this._isZoomDisabled?[2]:(t=this._svgDOMElement.node())?(r=(e=t.getBoundingClientRect()).width,o=e.height,r&&o?(i=is(n),[2,this._svgDOMElement.transition().duration(750).call(this._zoom.transform,nZ.translate(r/2,o/2).scale(i).translate(-s,-l)).end()]):[2]):[2]})},new(o=void 0,o=Promise)(function(t,n){function a(t){try{l(i.next(t))}catch(t){n(t)}}function s(t){try{l(i.throw(t))}catch(t){n(t)}}function l(e){var n;e.done?t(e.value):((n=e.value)instanceof o?n:new o(function(t){t(n)})).then(a,s)}l((i=i.apply(e,r||[])).next())})},this.shiftTo=function(t){var n=ii(t,2),r=n[0],o=n[1],i=e.zoomPosition,a=i.x,s=i.y;e._svgDOMElement.call(e._zoom.transform,nZ.translate(a+r,s+o).scale(e._zoomTransform.k))},this.getRelativeCoordinates=function(t,n){return n?e._zoomTransform.apply(t):e._zoomTransform.invert(t)},this.toggleMousedownZoom=function(){e._mousedownZoomEnabled?e.disableMousedownZoom():e.enableMousedownZoom()},this.enableMousedownZoom=function(){e._isZoomDisabled||(e._mousedownZoomEnabled=!0,aM.dom.root.attr("class","zoom_hand_tool"))},this.disableMousedownZoom=function(){e._isZoomDisabled||(e._mousedownZoomEnabled=!1,e._isZoomActive||aM.dom.root.attr("class",null))},this.enable=function(){e._isZoomDisabled=!1},this.disable=function(){e._isZoomDisabled=!0},this._zoom=(function(){var t,e,n,r=nH,o=nF,i=nX,a=nY,s=nW,l=[0,1/0],c=[[-1/0,-1/0],[1/0,1/0]],u=250,d=nB,h=tu("start","zoom","end"),f=0,p=10;function v(t){t.property("__zoom",nR).on("wheel.zoom",C,{passive:!1}).on("mousedown.zoom",x).on("dblclick.zoom",M).filter(s).on("touchstart.zoom",k).on("touchmove.zoom",S).on("touchend.zoom touchcancel.zoom",N).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function y(t,e){return(e=Math.max(l[0],Math.min(l[1],e)))===t.k?t:new nI(e,t.x,t.y)}function m(t,e,n){var r=e[0]-n[0]*t.k,o=e[1]-n[1]*t.k;return r===t.x&&o===t.y?t:new nI(t.k,r,o)}function g(t){return[(+t[0][0]+ +t[1][0])/2,(+t[0][1]+ +t[1][1])/2]}function _(t,e,n,r){t.on("start.zoom",function(){b(this,arguments).event(r).start()}).on("interrupt.zoom end.zoom",function(){b(this,arguments).event(r).end()}).tween("zoom",function(){var t=arguments,i=b(this,t).event(r),a=o.apply(this,t),s=null==n?g(a):"function"==typeof n?n.apply(this,t):n,l=Math.max(a[1][0]-a[0][0],a[1][1]-a[0][1]),c=this.__zoom,u="function"==typeof e?e.apply(this,t):e,h=d(c.invert(s).concat(l/c.k),u.invert(s).concat(l/u.k));return function(t){if(1===t)t=u;else{var e=h(t),n=l/e[2];t=new nI(n,s[0]-e[0]*n,s[1]-e[1]*n)}i.zoom(null,t)}})}function b(t,e,n){return!n&&t.__zooming||new w(t,e)}function w(t,e){this.that=t,this.args=e,this.active=0,this.sourceEvent=null,this.extent=o.apply(t,e),this.taps=0}function C(t,...e){if(r.apply(this,arguments)){var n=b(this,e).event(t),o=this.__zoom,s=Math.max(l[0],Math.min(l[1],o.k*Math.pow(2,a.apply(this,arguments)))),u=eI(t);if(n.wheel)n.mouse[0][0]===u[0]&&n.mouse[0][1]===u[1]||(n.mouse[1]=o.invert(n.mouse[0]=u)),clearTimeout(n.wheel);else{if(o.k===s)return;n.mouse=[u,o.invert(u)],tZ(this),n.start()}nV(t),n.wheel=setTimeout(function(){n.wheel=null,n.end()},150),n.zoom("mouse",i(m(y(o,s),n.mouse[0],n.mouse[1]),n.extent,c))}}function x(t,...e){if(!n&&r.apply(this,arguments)){var o=t.currentTarget,a=b(this,e,!0).event(t),s=eP(t.view).on("mousemove.zoom",function(t){if(nV(t),!a.moved){var e=t.clientX-u,n=t.clientY-d;a.moved=e*e+n*n>f}a.event(t).zoom("mouse",i(m(a.that.__zoom,a.mouse[0]=eI(t,o),a.mouse[1]),a.extent,c))},!0).on("mouseup.zoom",function(t){s.on("mousemove.zoom mouseup.zoom",null),eF(t.view,a.moved),nV(t),a.event(t).end()},!0),l=eI(t,o),u=t.clientX,d=t.clientY;eH(t.view),nj(t),a.mouse=[l,this.__zoom.invert(l)],tZ(this),a.start()}}function M(t,...e){if(r.apply(this,arguments)){var n=this.__zoom,a=eI(t.changedTouches?t.changedTouches[0]:t,this),s=n.invert(a),l=n.k*(t.shiftKey?.5:2),d=i(m(y(n,l),a,s),o.apply(this,e),c);nV(t),u>0?eP(this).transition().duration(u).call(_,d,a,t):eP(this).call(v.transform,d,a,t)}}function k(n,...o){if(r.apply(this,arguments)){var i,a,s,l,c=n.touches,u=c.length,d=b(this,o,n.changedTouches.length===u).event(n);for(nj(n),a=0;a<u;++a)l=[l=eI(s=c[a],this),this.__zoom.invert(l),s.identifier],d.touch0?d.touch1||d.touch0[2]===l[2]||(d.touch1=l,d.taps=0):(d.touch0=l,i=!0,d.taps=1+!!t);t&&(t=clearTimeout(t)),i&&(d.taps<2&&(e=l[0],t=setTimeout(function(){t=null},500)),tZ(this),d.start())}}function S(t,...e){if(this.__zooming){var n,r,o,a,s=b(this,e).event(t),l=t.changedTouches,u=l.length;for(nV(t),n=0;n<u;++n)o=eI(r=l[n],this),s.touch0&&s.touch0[2]===r.identifier?s.touch0[0]=o:s.touch1&&s.touch1[2]===r.identifier&&(s.touch1[0]=o);if(r=s.that.__zoom,s.touch1){var d=s.touch0[0],h=s.touch0[1],f=s.touch1[0],p=s.touch1[1],v=(v=f[0]-d[0])*v+(v=f[1]-d[1])*v,g=(g=p[0]-h[0])*g+(g=p[1]-h[1])*g;r=y(r,Math.sqrt(v/g)),o=[(d[0]+f[0])/2,(d[1]+f[1])/2],a=[(h[0]+p[0])/2,(h[1]+p[1])/2]}else{if(!s.touch0)return;o=s.touch0[0],a=s.touch0[1]}s.zoom("touch",i(m(r,o,a),s.extent,c))}}function N(t,...r){if(this.__zooming){var o,i,a=b(this,r).event(t),s=t.changedTouches,l=s.length;for(nj(t),n&&clearTimeout(n),n=setTimeout(function(){n=null},500),o=0;o<l;++o)i=s[o],a.touch0&&a.touch0[2]===i.identifier?delete a.touch0:a.touch1&&a.touch1[2]===i.identifier&&delete a.touch1;if(a.touch1&&!a.touch0&&(a.touch0=a.touch1,delete a.touch1),a.touch0)a.touch0[1]=this.__zoom.invert(a.touch0[0]);else if(a.end(),2===a.taps&&(i=eI(i,this),Math.hypot(e[0]-i[0],e[1]-i[1])<p)){var c=eP(this).on("dblclick.zoom");c&&c.apply(this,arguments)}}}return v.transform=function(t,e,n,r){var o=t.selection?t.selection():t;o.property("__zoom",nR),t!==o?_(t,e,n,r):o.interrupt().each(function(){b(this,arguments).event(r).start().zoom(null,"function"==typeof e?e.apply(this,arguments):e).end()})},v.scaleBy=function(t,e,n,r){v.scaleTo(t,function(){return this.__zoom.k*("function"==typeof e?e.apply(this,arguments):e)},n,r)},v.scaleTo=function(t,e,n,r){v.transform(t,function(){var t=o.apply(this,arguments),r=this.__zoom,a=null==n?g(t):"function"==typeof n?n.apply(this,arguments):n,s=r.invert(a),l="function"==typeof e?e.apply(this,arguments):e;return i(m(y(r,l),a,s),t,c)},n,r)},v.translateBy=function(t,e,n,r){v.transform(t,function(){return i(this.__zoom.translate("function"==typeof e?e.apply(this,arguments):e,"function"==typeof n?n.apply(this,arguments):n),o.apply(this,arguments),c)},null,r)},v.translateTo=function(t,e,n,r,a){v.transform(t,function(){var t=o.apply(this,arguments),a=this.__zoom,s=null==r?g(t):"function"==typeof r?r.apply(this,arguments):r;return i(nZ.translate(s[0],s[1]).scale(a.k).translate("function"==typeof e?-e.apply(this,arguments):-e,"function"==typeof n?-n.apply(this,arguments):-n),t,c)},r,a)},w.prototype={event:function(t){return t&&(this.sourceEvent=t),this},start:function(){return 1==++this.active&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(t,e){return this.mouse&&"mouse"!==t&&(this.mouse[1]=e.invert(this.mouse[0])),this.touch0&&"touch"!==t&&(this.touch0[1]=e.invert(this.touch0[0])),this.touch1&&"touch"!==t&&(this.touch1[1]=e.invert(this.touch1[0])),this.that.__zoom=e,this.emit("zoom"),this},end:function(){return 0==--this.active&&(delete this.that.__zooming,this.emit("end")),this},emit:function(t){var e=eP(this.that).datum();h.call(t,this.that,new nP(t,{sourceEvent:this.sourceEvent,target:v,type:t,transform:this.that.__zoom,dispatch:h}),e)}},v.wheelDelta=function(t){return arguments.length?(a="function"==typeof t?t:nz(+t),v):a},v.filter=function(t){return arguments.length?(r="function"==typeof t?t:nz(!!t),v):r},v.touchable=function(t){return arguments.length?(s="function"==typeof t?t:nz(!!t),v):s},v.extent=function(t){return arguments.length?(o="function"==typeof t?t:nz([[+t[0][0],+t[0][1]],[+t[1][0],+t[1][1]]]),v):o},v.scaleExtent=function(t){return arguments.length?(l[0]=+t[0],l[1]=+t[1],v):[l[0],l[1]]},v.translateExtent=function(t){return arguments.length?(c[0][0]=+t[0][0],c[1][0]=+t[1][0],c[0][1]=+t[0][1],c[1][1]=+t[1][1],v):[[c[0][0],c[0][1]],[c[1][0],c[1][1]]]},v.constrain=function(t){return arguments.length?(i=t,v):i},v.duration=function(t){return arguments.length?(u=+t,v):u},v.interpolate=function(t){return arguments.length?(d=t,v):d},v.on=function(){var t=h.on.apply(h,arguments);return t===h?v:t},v.clickDistance=function(t){return arguments.length?(f=(t=+t)*t,v):Math.sqrt(f)},v.tapDistance=function(t){return arguments.length?(p=+t,v):p},v})().scaleExtent([.05,2]).clickDistance(50).on("start",function(){e._isZoomActive=!0,e._mousedownZoomEnabled&&aM.dom.root.attr("class","zoom_hand_tool_active")}).on("zoom",function(t){var n=t.transform;e._zoomTransform=n,e.zoom()}).on("end",function(){if(e._isZoomActive=!1,e.zoomEnd(),aM.dom.root.attr("class",e._mousedownZoomEnabled?"zoom_hand_tool":null),aM.dom.map.attr("pointer-events",null),e.zoomBreakpointPassed()){r3.manifest.setAllNodesAsModified();var t=function(t,e,n){if(n||2==arguments.length)for(var r,o=0,i=e.length;o<i;o++)!r&&o in e||(r||(r=Array.prototype.slice.call(e,0,o)),r[o]=e[o]);return t.concat(r||Array.prototype.slice.call(e))}([],ii(r3.selectedNodes),!1);aM.layers.clear(),aM.layers.update(),r3.clearSelectedNodes(!1),aM.layers.updateSelected(t)}r3.zoomFactor=e.zoomFactor}),h.isEditOrPreViewMode()?(this._zoom.filter(function(t){var n="touchstart"===t.type,r="mousedown"===t.type;return!(e._isZoomDisabled||n&&t.defaultPrevented)&&(r&&1===t.button||n?(aM.dom.root.attr("class","zoom_hand_tool_active"),!0):r&&e._mousedownZoomEnabled)}),this._svgDOMElement.call(this._zoom).on("dblclick.zoom",null).on("wheel.zoom",function(t){if(!e._isZoomDisabled){t.preventDefault(),t.stopImmediatePropagation();var n,r,o=Math.max(.05,Math.min(2,e._zoomTransform.k*Math.pow(2,-t.deltaY*(1===t.deltaMode?.05:t.deltaMode?1:.002)*(t.ctrlKey||t.metaKey?5:1)))),i=eI(t);e._wheel?(e._mouse[0][0]===i[0]&&e._mouse[0][1]===i[1]||(e._mouse[1]=e._zoomTransform.invert(e._mouse[0]=i)),clearTimeout(e._wheel)):(e._mouse=[i,e._zoomTransform.invert(i)],tZ(e._svgDOMElement.node()),aM.dom.map.attr("pointer-events","none")),e._wheel=window.setTimeout(function(){e._wheel=null,e._svgDOMElement.call(e._zoom.transform,nZ.translate(e._zoomTransform.x,e._zoomTransform.y).scale(e._zoomTransform.k))},e._wheelDelay),t.ctrlKey||t.metaKey?e._zoomTransform=il((n=e._zoomTransform,(r=Math.max(.05,Math.min(2,r=o)))===n.k?n:new nI(r,n.x,n.y)),e._mouse[0],e._mouse[1]):e._zoomTransform=il(e._zoomTransform,[e._mouse[0][0]-t.deltaX,e._mouse[0][1]-t.deltaY],e._mouse[1]),e._mouse[1]=e._zoomTransform.invert(e._mouse[0]),e.zoom()}},{passive:!1})):this._svgDOMElement.call(this._zoom)}return Object.defineProperty(t.prototype,"zoomConfig",{get:function(){return{min:.05,max:2,step:.0195}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"zoomFactor",{get:function(){return this._zoomTransform.k},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"zoomPosition",{get:function(){return{x:this._zoomTransform.x,y:this._zoomTransform.y}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isMousedownZoomEnabled",{get:function(){return this._mousedownZoomEnabled},enumerable:!1,configurable:!0}),t.prototype.zoom=function(){f.emit("zoom",{value:this._zoomTransform.k,x:this._zoomTransform.x,y:this._zoomTransform.y})},t.prototype.zoomBreakpointPassed=function(){var t=r3.zoomFactor,e=this.zoomFactor,n=h.performance.renderSkeletonOnZoomLessThan;return!(t===e||t>n&&e>n||t<n&&e<n)},t.prototype.zoomEnd=function(){f.emit("zoomEnd",{value:this._zoomTransform.k,x:this._zoomTransform.x,y:this._zoomTransform.y})},t}();function is(t){if(t<.05||t>2){if(t<.05)return .05;if(t>2)return 2}return t}function il(t,e,n){var r=e[0]-n[0]*t.k,o=e[1]-n[1]*t.k;return r===t.x&&o===t.y?t:new nI(t.k,r,o)}var ic=function(){function t(t){var e=this;this.dispose=function(){var t,n;null===(t=e._keydownEvents)||void 0===t||t.dispose(),null===(n=e._mouseEvents)||void 0===n||n.dispose()},this.nullableDrag=function(){return eq().on("drag",null)},this._zoom=new ia(t),this._keydownEvents=new ov,h.isEditOrPreViewMode()&&(this._mouseEvents=new io(t))}return Object.defineProperty(t.prototype,"zoom",{get:function(){return this._zoom},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"keydown",{get:function(){return this._keydownEvents},enumerable:!1,configurable:!0}),t}(),iu="branchElement",id="#654BDD",ih=function(t){var e=r1(t),n=n_("svg:path").attr("class",iu);return n.attr("d",n2({source:e.source.position.absolute,target:e.target.position.absolute})).attr("fill","none").attr("stroke",iy(t)).attr("stroke-width",h.render.strokeSize),n.node()},ip=function(t){var e=r1(t),n=n_("svg:path").attr("class",iu),r=function(t,e,n){if(n||2==arguments.length)for(var r,o=0,i=e.length;o<i;o++)!r&&o in e||(r||(r=Array.prototype.slice.call(e,0,o)),r[o]=e[o]);return t.concat(r||Array.prototype.slice.call(e))}([],function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a}(e.source.position.absolute),!1);return e.type===rI.Flip&&(r[0]=r[0]-42),n.attr("d",n2({source:r,target:e.target.position.absolute})).attr("fill","none").attr("stroke",iy(t)).attr("stroke-width",h.render.strokeSize+1),n.node()},iv=function(t){var e=r1(t),n=n_("svg:path").attr("class","shadowBranchElement");return n.attr("d",n2({source:e.source.position.absolute,target:e.target.position.absolute})).attr("fill","none").attr("stroke","transparent").attr("stroke-width",h.render.strokeSize+5),n.node()},iy=function(t){var e=r1(t);return h.isViewMode()?e.isAssociatedNodeLocked()?"#76787A":h.render.color.stroke:r3.selectedBranches.has(e.id)?id:h.render.color.stroke},im=function(t,e){var n=this;this.clear=function(){n._layer.selectAll("*").remove()},this.allowReRendering=function(){return!0},this._layer=t.append("g").attr("id",e)},ig=(n=function(t,e){return(n=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i_=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a},ib=function(t,e,n){if(n||2==arguments.length)for(var r,o=0,i=e.length;o<i;o++)!r&&o in e||(r||(r=Array.prototype.slice.call(e,0,o)),r[o]=e[o]);return t.concat(r||Array.prototype.slice.call(e))},iw=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.render=function(){var t=r3.layout.getChangedBranches(),n=t.deleted,r=t.edited;if(r.length+n.length!==0){e.destroyBranches(ib(ib([],i_(n),!1),i_(r),!1));var o=!!r.length;o&&e.renderBranches(r),(o||n.length)&&e.saveRenderResults()}},e.updateSelected=function(){o1().each(function(t){e.applyBranchColor(t)})},e.setHovered=function(){},e.clear=function(){e._layer.selectAll("*").remove(),r3.layout.renderedBranchesData={}},e.createBranchesSelection=function(t){var n=e._layer.selectAll("g.NotExistingClassName").data(t.map(function(t){return t.id})).join("g").attr("class",oG).attr("id",function(t){return"branch-".concat(t)});return h.isEditOrPreViewMode()&&n.style("cursor","pointer"),n},e.renderBranches=function(t){var n=e.createBranchesSelection(t);r3.layout.shouldRenderFullLayout?e.renderFullLayout(n):e.renderSkeleton(n)},e}return ig(e,t),e.prototype.addEventListeners=function(t){var e=this;t.on("contextmenu",function(t){t.preventDefault()}).on("click",function(t,n){h.isViewMode()||(t.preventDefault(),r3.selectBranches([n]),e.updateSelected())}).on("mouseenter",function(t,n){h.isViewMode()||r3.selectedBranches.has(n)||e.applySelectedBranch(n)}).on("mouseleave",function(t,n){h.isViewMode()||r3.selectedBranches.has(n)||e.applyDefaultBranch(n)})},e.prototype.renderFullLayout=function(t){t.append(iv),t.append(ih),this.addEventListeners(t)},e.prototype.renderSkeleton=function(t){t.append(ip)},e.prototype.saveRenderResults=function(){var t=o1().data().map(r1);r3.layout.renderedBranchesData=rw(t)},e.prototype.destroyBranches=function(t){if(0!==t.length&&r3.layout.hasRenderedBranches){var e=r3.layout.renderedBranchesData;t.forEach(function(t){e[t.id]&&oQ(t.id).remove()})}},e.prototype.applyBranchColor=function(t){oQ(t).select(".".concat(iu)).attr("stroke",iy(t))},e.prototype.applySelectedBranch=function(t){oQ(t).select(".".concat(iu)).attr("stroke",id)},e.prototype.applyDefaultBranch=function(t){oQ(t).select(".".concat(iu)).attr("stroke",h.render.color.stroke)},e}(im),iC=(r=function(t,e){return(r=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),ix=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._hadInitialRender=!1,e.setHovered=function(){},e.allowReRendering=function(){return!e._hadInitialRender},e}return iC(e,t),e.prototype.render=function(){var t;this._marker=((t=this._layer.append("g").attr("class","navigationMarker")).append("svg").attr("x",-h.render.iconSize).attr("y",0).attr("width",2*h.render.iconSize).attr("height",2*h.render.iconSize).attr("viewBox","0 0 ".concat(h.render.iconSize," ").concat(h.render.iconSize)).append("use").attr("href","#".concat(v.Location)),t).style("display","none"),this._hadInitialRender=!0},e.prototype.updateSelected=function(t){if(this._marker){if(t.length){var e=rJ(function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a}(t,1)[0]);if(!e)throw Error("Can't get first selected graph node");var n=e.styles.x+e.render.width/2,r=e.styles.y-40;this._marker.attr("transform","translate(".concat(n,", ").concat(r,")")).style("display","inline").style("color",e.stylesWithDefaults.hover.borderColor)}else this._marker.style("display","none")}},e}(im),iM=i(96),ik=i.n(iM),iS=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a},iN=h.render.node.headerHeight-8,iE=h.render.node.width-h.render.node.headerHeight,iL=h.render.iconSize+4,iO=function(t,e,n){var r=t.append("g").attr("class","header");iz(r,n),iB(r,e,n),h.isEditMode()&&iP(r,e,n),r.on("mouseenter",function(){return function(t){var e=rQ(t);if(ox(e.id)&&!e.isDragged){var n=16*e.chapterErrors.reduce(function(t,e){return Math.ceil(e.message.length/33)+t},0)+(30*(e.chapterErrors.length-1)+18)+30,r=e.chapterErrors.map(function(t){return"<h5>".concat(t.title,"</h5><div>").concat(t.message,"</div>")}).join("");aM.popups.position([e.styles.x-24,e.styles.y-n]).withScale().show(r,void 0,"tooltip",{width:"224px",arrowDown:!0})}}(n.id)}).on("mouseleave",function(){return aM.popups.hide()})},iA=function(t,e,n){if(ox(t)){var r=h.render.color.elementBackground;n&&(r=h.render.color.error),e&&(r=h.render.color.activeError),oK(t).select(".headerBg").attr("fill",r)}};function iT(t,e){if(h.isViewOrPreViewMode()){var n=e?t.stylesWithDefaults.hover.borderColor:t.stylesWithDefaults.header.backgroundColor;oK(t.id).select(".headerBg").attr("fill",n)}iA(t.id,e,!1)}var iB=function(t,e,n){var r=iS(e,2),o=r[0],i=r[1];t.append(function(){var t;return n4({text:n.displayLockedContent?n.chapter.label:h.translation.node_not_visited,posX:o+12,posY:i+10,width:140,fontWeight:600,color:h.isViewOrPreViewMode()?null===(t=n.stylesWithDefaults.header)||void 0===t?void 0:t.textColor:void 0})})},iz=function(t,e){t.append("rect").attr("class","headerBg").attr("width",h.render.node.width).attr("height",h.render.node.headerHeight).attr("fill",h.isViewOrPreViewMode()?e.stylesWithDefaults.header.backgroundColor:h.render.color.elementBackground)},iP=function(t,e,n){var r=iS(e,2)[1],o="rgba(0,0,0,0)",i=function(){return ox(n)?r3.selectedNodes.has(n.id)?"#E53737":"#F06A6A":"#363738"},a=t.append("g").attr("id","options").style("cursor","pointer").on("click",function(t){t.preventDefault(),aM.inputs.keydown.shiftHold&&t.stopImmediatePropagation();var e=aM.inputs.zoom.getRelativeCoordinates([r0(n.id).x+n.render.width+5,r0(n.id).y],!0);aM.tools.use(op.NodeMenu).data(n).position(e).start(),eP(this).selectChild().attr("fill",i())}).on("mousedown",function(){eP(this).selectChild().attr("fill",i())}).on("mouseenter",function(){eP(this).selectChild().attr("fill",i())}).on("mouseleave",function(){eP(this).selectChild().attr("fill",o)});a.append("path").attr("d",nq({x:iE+4,y:r+4,w:iN,h:iN,r:10})).attr("fill",o),a.append("use").style("color",h.render.color.text).attr("x",iE+iL/2).attr("y",r+iL/2).attr("href","#".concat(v.Etc))},iI=function(t){var e=rQ(t);if("simple"!==e.chapter.order){var n=e.render.width-h.render.node.componentOrderRadius,r=-h.render.node.componentOrderRadius,o=n_("svg:g").attr("class","nodeOrder").attr("transform","translate(".concat(n,", ").concat(r,")")).style("color","#19191A");o.append("use").attr("href","#".concat(nG.Order)),o.append("use").attr("y",h.render.node.componentOrderRadius-h.render.iconSize/2).attr("x",h.render.node.componentOrderRadius-h.render.iconSize/2).attr("href","#".concat(function(t){switch(t.chapter.order){case"start":return v.StartNode;case"end":return v.EndNode;case"simple":return v.Node}}(e))).raise(),oK(e.id).append(function(){return o.node()})}},iD=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a},iZ="previewControls",ij="previewBackground",iV=function(t,e,n){var r=iD(e,2),o=r[0],i=r[1],a=t.append("g").attr("class","preview");a.append("rect").attr("class",ij).attr("x",o).attr("y",i-1).attr("width",h.render.node.width).attr("height",h.render.node.componentPreviewHeight+4).attr("fill",h.isViewOrPreViewMode()?n.stylesWithDefaults.header.backgroundColor:h.render.color.elementBackground);var s=a.append("g").attr("class","previewContainer").attr("clip-path","url(#".concat(nG.PreviewClipPath,")")),l=[o,i+1];iX(s.append("g").attr("class","previewContent"),l,n),h.isEditMode()&&i$(s,l,n),a.on("mouseenter",function(){var t,e,r;!n.isDragged&&n.displayLockedContent&&(o2(n.id).node()||(e=n.id,r=aM.dom.select(oU(e,"previewContainer")),h.isEditMode()?iG(r,l,n):h.isViewOrPreViewMode()&&(null===(t=n.stylesWithDefaults.watchAgain)||void 0===t?void 0:t.enabled)&&iq(r,l,n)))}).on("mouseleave",function(){!n.isDragged&&n.displayLockedContent&&o2(n.id).remove()})};function iH(t,e){h.isViewOrPreViewMode()&&oK(t.id).select(".".concat(ij)).attr("fill",e?t.stylesWithDefaults.hover.borderColor:t.stylesWithDefaults.header.backgroundColor)}var iF=function(t,e,n,r){var o=iD(e,2),i=o[0],a=o[1];t.append("rect").attr("x",i).attr("y",a).attr("width",n.render.width-2).attr("height",h.render.node.componentPreviewHeight).attr("fill",r)},iR=function(t,e,n){var r=iD(e,2)[1];t.append("svg").attr("x",h.render.node.width/2-10).attr("y",r+h.render.node.componentPreviewHeight/2-10).attr("width",h.render.iconSize+4).attr("height",h.render.iconSize+4).attr("viewBox","0 0 ".concat(h.render.iconSize," ").concat(h.render.iconSize)).append("use").style("color",n.stylesWithDefaults.preview.textColor).attr("href","#".concat(v.Lock))},iY=function(t,e,n){var r=iD(e,2),o=r[0],a=r[1];if(!n.videoInfo)throw Error("No video info to render cover");t.append("svg:image").attr("id","dropZone_".concat(n.id)).attr("x",o).attr("y",a).attr("width",n.render.width-2).attr("height",h.render.node.componentPreviewHeight).attr("preserveAspectRatio","xMidYMid meet").attr("href",n.videoInfo.cover).on("error",function(t){eP(t.target).attr("href",function(){return i(521)})})},iW=function(t,e,n){var r=iD(e,2),o=r[0],i=r[1];t.append("use").attr("id","dropZone_".concat(n.id)).attr("x",o).attr("y",i).attr("href","#".concat(nG.PreviewPlaceholder))},iX=function(t,e,n){var r=iD(e,2),o=r[0],i=r[1];if(!n.displayLockedContent){var a=n.stylesWithDefaults.preview.backgroundColor;return iF(t,[o,i],n,a),void iR(t,[o,i],n)}n.videoInfo?(iF(t,[o,i],n,a=h.render.node.previewPlaceholder.backgroundColor),iY(t,[o,i],n)):iW(t,[o,i],n)},i$=function(t,e,n){var r,o=iD(e,2),i=o[0],a=o[1];(null===(r=n.videoInfo)||void 0===r?void 0:r.title)&&(t.append("rect").attr("class","previewContentTitle").attr("x",i).attr("y",a+h.render.node.componentPreviewHeight-32).attr("width",n.render.width-2).attr("height",32).attr("fill","rgba(13, 15, 18, 0.89)"),t.append(function(){var t;return n4({text:(null===(t=n.videoInfo)||void 0===t?void 0:t.title)||"",posX:i+8,posY:h.render.node.componentPreviewHeight+12,width:h.render.node.width-16,fontSize:14,fontWeight:600})}))},iG=function(t,e,n){var r=iD(e,2),o=r[0],i=r[1],a=t.append("g").attr("class",iZ).attr("transform","translate(".concat(o,", ").concat(i,")"));a.append("rect").attr("width",n.render.width-2).attr("height",h.render.node.componentPreviewHeight).attr("fill","rgba(0, 0, 0, 0.8)"),a.append(function(){var t;return iU(n.chapter.videoId?h.translation.node_video_change:h.translation.node_video_choose,"rgba(255, 255, 255, 0.17)","rgba(255, 255, 255, 0.22)","rgba(255, 255, 255, 0.27)",(t=n.id,function(){f.emit("control",{name:"changeVideo",chapterId:t})})).attr("transform","translate(16, 25)").node()}),a.append(function(){var t;return iU(h.translation.node_open_editor,"#7B68EE","#8978F0","#9889F2",(t=n.id,function(){f.emit("control",{name:"openEditor",chapterId:t})})).attr("transform","translate(16, 61)").node()})},iq=function(t,e,n){var r=iD(e,2),o=r[0],i=r[1],a=t.append("g").attr("class",iZ).attr("transform","translate(".concat(o,", ").concat(i,")"));a.append("rect").attr("width",n.render.width-2).attr("height",h.render.node.componentPreviewHeight).attr("fill","rgba(0, 0, 0, 0.8)"),a.append(function(){var t;return iU(h.translation.node_watch_again_from,n.stylesWithDefaults.watchAgain.backgroundColor,n.stylesWithDefaults.watchAgain.backgroundColor,n.stylesWithDefaults.watchAgain.backgroundColor,(t=n.id,function(){f.emit("control",{name:"openPreview",chapterId:t})}),n.stylesWithDefaults.watchAgain.textColor,130,30,8).attr("transform","translate(28, 42)").node()})},iU=function(t,e,n,r,o,i,a,s,l){void 0===i&&(i=h.render.color.text),void 0===a&&(a=h.render.node.width-32),void 0===s&&(s=28),void 0===l&&(l=4);var c=n_("svg:g").attr("class","previewControlButton").on("mouseenter",function(){eP(this).select(".buttonBg").attr("fill",n)}).on("mouseleave",function(){eP(this).select(".buttonBg").attr("fill",e)}).on("mousedown",function(){eP(this).select(".buttonBg").attr("fill",r)}).on("click",function(t){eP(this).select(".buttonBg").attr("fill",n),o(t)});return c.append("path").attr("class","buttonBg").attr("d",nq({x:0,y:0,w:a,h:s,r:l})).attr("fill",e).style("cursor","pointer"),c.append("text").text(t).attr("class","buttonText").attr("x",a/2).attr("y",s-10).attr("font-weight",500).attr("font-size",14).attr("text-anchor","middle").style("fill",i).attr("text-rendering","optimizeSpeed"),c},iK=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a},iJ="rgba(255, 255, 255, 0.17)",iQ=function(t,e,n){var r=iK(e,2),o=r[0],i=r[1];t.append("path").attr("class","addActionRect").attr("d",function(){return nq({x:o+8,y:i+8,w:n.render.width-16,h:h.render.node.componentAddActionHeight-16,r:8})}).attr("fill",iJ)},i1=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a},i0=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},i2=function(t,e){return n5({text:t.label||t.type,posX:h.render.iconSize+14,posY:h.render.node.componentControlHeight/2-8,width:h.render.node.width-(h.render.iconSize+30),color:e.stylesWithDefaults.controls.textColor})},i5=function(t,e){var n=n_("svg:g").append("g").attr("class","nodeControl").style("cursor","pointer");return function(t,e,n){t.on("mouseenter",function(){aM.dom.select(".control_add_link_button_".concat(e.id)).attr("display","inline"),eP(this).select(".controlElementRect").attr("fill",n$(n.stylesWithDefaults.controls.backgroundColor,h.render.color.percentDiff))}).on("mouseleave",function(){aM.dom.select(".control_add_link_button_".concat(e.id)).attr("display","none"),eP(this).select(".controlElementRect").attr("fill",n.stylesWithDefaults.controls.backgroundColor)}).on("contextmenu",function(t){t.preventDefault(),t.stopImmediatePropagation();var r=aM.dom.getRelativeEventCoordinates(t,aM.dom.staticTools.node());aM.tools.use(op.ControlMenu).data(n,e).position(r).start()})}(n,e,t),function(t,e){t.append("rect").attr("class","controlElementRect").attr("width",h.render.node.width).attr("height",h.render.node.componentControlHeight).attr("fill",e.stylesWithDefaults.controls.backgroundColor).attr("stroke-width",h.render.strokeSize).attr("stroke",h.render.color.elementStroke)}(n,t),function(t,e){t.append("use").style("color",h.render.color.text).attr("x",8).attr("y",h.render.node.componentControlHeight/2-h.render.iconSize/2).attr("href","#".concat(function(t){switch(t.type){case"Area":return v.ActionArea;case"Button":return v.ActionButton}}(e)))}(n,e),n.append(function(){return i2(e,t).node()}),n},i4=function(t,e,n){var r,o,i=i1(e,2),a=i[0],s=i[1],l=t.append("g").attr("class","controls"),c=0;try{for(var u=i0(n.containers().reverse()),d=u.next();!d.done;d=u.next()){var f=d.value;n.getContainerControls(f.id).forEach(function(t){l.append(function(){var e=s+h.render.node.componentControlHeight*c++;return i5(n,t).attr("transform","translate(".concat(a,", ").concat(e,")")).node()})})}}catch(t){r={error:t}}finally{try{d&&!d.done&&(o=u.return)&&o.call(u)}finally{if(r)throw r.error}}},i6=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a},i9=function(t,e,n){var r=i6(e,2),o=r[0],i=r[1],a=t.append("g").attr("class","eov");!function(t,e){t.style("cursor","pointer").on("mouseenter",function(){eP(this).select(".endOfVideoRect").attr("fill",n$(e.stylesWithDefaults.flipTo.backgroundColor,h.render.color.percentDiff))}).on("mouseleave",function(){eP(this).select(".endOfVideoRect").attr("fill",e.stylesWithDefaults.flipTo.backgroundColor)})}(a,n),function(t,e,n){t.append("rect").attr("class","endOfVideoRect").attr("width",h.render.node.width).attr("height",h.render.node.componentControlHeight).attr("fill",n.stylesWithDefaults.flipTo.backgroundColor).attr("y",e)}(a,i,n),function(t,e){var n=i6(e,2),r=n[0],o=n[1];t.append("use").style("color",h.render.color.text).attr("x",r+8).attr("y",o+14).attr("href","#".concat(v.EndOfVideo))}(a,[o,i]),function(t,e,n){var r=i6(e,2),o=r[0],i=r[1];t.append("text").text(h.translation.node_eov).attr("font-weight",400).attr("x",o+8+h.render.iconSize+6).attr("y",i+26).style("fill",n.stylesWithDefaults.flipTo.textColor).attr("text-rendering","optimizeSpeed")}(a,[o,i],n)},i3=function(t){var e,n,r,o=rQ(t),i=n_("svg:g");if(h.isEditMode()){var a,s,l=h.render.node.heightWithPreviewEov,c=l+h.render.node.componentAddActionHeight;iO(i,[0,0],o),iV(i,[0,h.render.node.headerHeight],o),o.isEndNode()||(i9(i,[0,h.render.node.heightWithPreview+1],o),a=[0,l],function(t,e){t.on("click",function(t){var n=aM.dom.getRelativeEventCoordinates(t,aM.dom.staticTools.node());aM.tools.use(op.ControlTypeMenu).data(e).position(n).start()}).on("mouseenter",function(){eP(this).select(".addActionRect").attr("fill","#626366")}).on("mouseleave",function(){eP(this).select(".addActionRect").attr("fill",iJ)})}(s=i.append("g").attr("class","addAction").style("cursor","pointer"),o),function(t,e,n){var r=iK(e,2),o=r[0],i=r[1];t.append("rect").attr("x",o).attr("y",i).attr("width",n.render.width).attr("height",h.render.node.componentAddActionHeight).attr("fill",h.render.color.elementBackground).attr("stroke-width",h.render.strokeSize).attr("stroke",h.render.color.elementStroke)}(s,a,o),iQ(s,a,o),function(t,e,n){var r=iK(e,2)[1];t.append("text").text(h.translation.node_add_control).attr("font-weight",600).attr("text-anchor","middle").style("fill",h.render.color.text).attr("x",n.render.width/2).attr("y",r+24).attr("text-rendering","optimizeSpeed")}(s,a,o),i4(i,[0,c],o))}else c=(null===(e=o.stylesWithDefaults.flipTo)||void 0===e?void 0:e.enabled)?h.render.node.heightWithPreviewEov:h.render.node.heightWithPreview+1,iO(i,[0,0],o),iV(i,[0,h.render.node.headerHeight],o),o.isEndNode()||((null===(n=o.stylesWithDefaults.flipTo)||void 0===n?void 0:n.enabled)&&i9(i,[0,h.render.node.heightWithPreview+1],o),(null===(r=o.stylesWithDefaults.controls)||void 0===r?void 0:r.enabled)&&i4(i,[0,c],o));return n1({id:o.id,width:o.render.width,height:o.render.height,element:i,r:h.render.node.borderRadius}),i.node()},i7=function(t,e,n){var r=oM(n,e);return t.attr("stroke-width",h.render.strokeSize+Number(e)).attr("stroke",r)},i8=function(t,e){void 0===e&&(e=!0);var n=rQ(t),r=oM(n,e),o=n_("svg:path").attr("class","border").attr("id",h.render.prefix.nodeBorder+t).attr("d",function(){return nq({x:1,y:1,w:n.render.width-2,h:n.render.height-2,r:h.render.node.borderRadius})}).attr("fill","none").attr("stroke",r).style("pointer-events","none");return i7(o,e,n),o.node()},at=function(t){var e=rQ(t);if(e.hasErrors()){var n=r3.selectedNodes.has(e.id);oK(t).append(function(){return i8(e.id,n)})}},ae=h.render.iconSize/2,an=function(t){var e=n_("svg:g");return e.append("path").attr("fill","none").attr("stroke",h.render.color.stroke).attr("d",n2({source:[0,0],target:[23,0]})).attr("pointer-events","none"),e.append(function(){return n0(t).attr("transform","translate(".concat(-h.render.node.control.connectorRadius,", ").concat(-h.render.node.control.connectorRadius,")")).node()}),e},ar=h.render.iconSize/2,ao=h.render.iconSize/2,ai="#7B68EE",aa=function(t){var e=t.render.width,n=h.render.node.heightWithPreview+h.render.node.componentControlHeight/2,r=t.getSuspenseActionType(),o="setNextBranch"===r?2*h.render.tool.eov.size:h.render.tool.eov.size,i=n_("svg:g").attr("id",h.render.prefix.nodeEOV+t.id).attr("stroke",h.render.color.stroke).attr("stroke-width",h.render.strokeSize);return i.append("path").attr("class","eovTypeLine").attr("fill","none").attr("d",n2({source:[e,n],target:[e+o,n]})).attr("pointer-events","none").style("marker-start","url(#".concat(y.Circle)).style("marker-end",t.getSuspenseBranchId()?"":"url(#".concat(y.Circle)),"setNextBranch"!==r||t.getSuspenseBranchId()||i.append("rect").attr("fill","transparent").attr("stroke","none").attr("x",e+o-ao/2).attr("y",n-ao/2).attr("width",ao).attr("height",ao).on("mouseenter",function(r){if(!r.buttons){var i=rQ(t.id);aM.tools.use(op.ShadowNodeLink).data(i,rI.Flip).position([i.styles.x+e+o,n+i.styles.y]).start()}}).on("mouseleave",function(){}),i.append(function(){return as(t,[e+11,n-16]).attr("transform","translate(".concat(e+12,", ").concat(n-12,")")).node()}),i.node()},as=function(t,e){var n=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a}(e,2),r=n[0],o=n[1],i=n_("svg:g");return i.on("click",function(e){if(!h.isViewOrPreViewMode()){e.preventDefault();var n=rJ(t.id)||t,i=aM.inputs.zoom.getRelativeCoordinates([n.styles.x+r,n.styles.y+o],!0);aM.tools.use(op.EOVMenu).data(n).position(i).start(),eP(this).select(".eovButtonBg").attr("stroke",h.render.color.stroke).attr("fill",h.render.color.elementBackground)}}).on("mouseenter",function(){h.isViewOrPreViewMode()||eP(this).select(".eovButtonBg").attr("stroke",ai).attr("fill",ai)}).on("mouseleave",function(){h.isViewOrPreViewMode()||eP(this).select(".eovButtonBg").attr("stroke",h.render.color.stroke).attr("fill",h.render.color.elementBackground)}).call(aM.inputs.nullableDrag()),i.append("path").attr("class","eovButtonBg").attr("stroke",h.render.color.stroke).attr("fill",h.render.color.elementBackground).attr("d",nq({x:0,y:0,w:h.render.tool.eov.size,h:h.render.tool.eov.size,r:h.render.tool.eov.radius})),i.append("use").style("color",h.render.tool.textColor).attr("x",5).attr("y",5).attr("width",12).attr("height",12).attr("viewBox","0 0 ".concat(h.render.iconSize," ").concat(h.render.iconSize)).attr("href","#".concat(al(t.getSuspenseActionType()))),i},al=function(t){switch(t){case"setNextBranch":return v.Node;case"setRandomBranch":return v.Random;default:return v.Add}},ac=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},au=function(t){if(!h.isEditMode())return ad(t);var e,n,r=rQ(t),o=n_("svg:g").attr("class","nodeTools");if(o3(r,o),o7(r,o),o8(r,o),r.isEndNode())return o.node();o.append(function(){return aa(r)});var i=0,a=function(t){r.getContainerControls(t.id).forEach(function(e){var n,a,s=null===(n=e.events)||void 0===n?void 0:n.some(function(t){return"onClick"===t.type&&"setNextBranch"===t.action.type}),l=null===(a=t.events)||void 0===a?void 0:a.some(function(t){return"onSuspense"===t.type&&"setNextBranch"===t.action.type});s&&l||o.append(function(){return function(t,e,n,r){var o,i,a,s,l=!1,c=null===(o=e.events)||void 0===o?void 0:o.some(function(t){return"onSuspense"===t.type&&"setNextBranch"===t.action.type}),u=null===(i=n.events)||void 0===i?void 0:i.some(function(t){return"onClick"===t.type&&"setNextBranch"===t.action.type});s=c||u?u?h.render.node.control.inactionLinkY:h.render.node.control.actionLinkY:(h.render.node.control.actionLinkY+h.render.node.control.inactionLinkY)/2;var d=h.render.node.componentControlHeight*r,f=t.render.controlsContainerYCoordinate+d,p=n_("svg:g").attr("class","controlAddLinks").attr("transform","translate(".concat(t.render.width,", ").concat(f,")")).call(aM.inputs.nullableDrag()),y=n_("svg:g").attr("class","control_link_choice_".concat(e.id)).attr("display","none").on("mouseenter",function(){eP(this).attr("display","inline"),b.attr("display","inline"),w.attr("stroke",h.render.color.stroke)}).on("mouseleave",function(t){t.toElement.closest("#shadow-node-link")||(eP(this).attr("display","none"),b.attr("display","none"),w.attr("stroke",h.render.color.connectorStroke))});if(y.append("rect").attr("fill","transparent").attr("x",0).attr("y",0).attr("width",h.render.node.componentControlHeight).attr("height",h.render.node.componentControlHeight),!u){y.append(function(){return n0(v.Action).attr("transform","translate(15, ".concat(h.render.node.control.actionLinkY-h.render.node.control.connectorRadius,")")).on("mouseenter",function(r){r.buttons||aM.tools.use(op.ShadowNodeLink).data(t,rI.Action,e,n,!1).position([t.styles.x+t.render.width+23,t.styles.y+f+h.render.node.control.actionLinkY]).start()}).node()}),y.append("path").attr("fill","none").attr("stroke",h.render.color.stroke).attr("d",n2({source:[7,s],target:[16,h.render.node.control.actionLinkY]})).attr("pointer-events","none");var m=an(v.Action).attr("class","start_link_".concat(n.id)).attr("transform","translate(0, ".concat(h.render.node.control.actionLinkY,")")).attr("display","none");p.append(function(){return m.node()})}if(!c){var g="expect"===(null===(a=rb("onSuspense",e.events))||void 0===a?void 0:a.action.type);y.append(function(){return n0(v.Inaction,!1,g).attr("transform","translate(15, ".concat(h.render.node.control.inactionLinkY-h.render.node.control.connectorRadius,")")).on("mouseenter",function(r){if(!g||l)r.buttons||aM.tools.use(op.ShadowNodeLink).data(t,rI.Inaction,e,n,!1).position([t.styles.x+t.render.width+23,t.styles.y+f+h.render.node.control.inactionLinkY]).start();else{l=!0;var o=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a}(aM.dom.getRelativeEventCoordinates(r,aM.dom.staticTools.node()),2),i=o[0],a=o[1];aM.popups.position([i,a+10]).show(h.translation.tooltip_inaction_not_available,void 0,"tooltip")}}).on("mouseleave",function(){g&&l&&(l=!1,aM.popups.hide())}).node()}),y.append("path").attr("fill","none").attr("stroke",h.render.color.stroke).attr("d",n2({source:[7,s],target:[16,h.render.node.control.inactionLinkY]})).attr("pointer-events","none");var _=an(v.Inaction).attr("class","start_link_".concat(e.id)).attr("transform","translate(0, ".concat(h.render.node.control.inactionLinkY,")")).attr("display","none");p.append(function(){return _.node()})}p.append(function(){return y.node()});var b=n0(v.Plus,!0).attr("transform","translate(".concat(-h.render.node.control.connectorRadius,", ").concat(s-h.render.node.control.connectorRadius,")")).attr("class","control_add_link_button_".concat(n.id)).attr("display","none").on("mouseenter",function(){eP(this).attr("display","inline"),y.attr("display","inline"),w.attr("stroke",h.render.color.stroke)}).on("mouseleave",function(){eP(this).attr("display","none"),y.attr("display","none"),w.attr("stroke",h.render.color.connectorStroke)}),w=b.select(".connector_circle");return w.attr("stroke",h.render.color.connectorStroke),p.append(function(){return b.node()}),p.node()}(r,t,e,i)}),s&&o.append(function(){var n,o,a,s,l,c,u;return n=i,a=h.render.node.componentControlHeight*n,s=r.render.controlsContainerYCoordinate+h.render.node.control.actionLinkY+a,l=!!(null===(o=e.events)||void 0===o?void 0:o.some(function(t){return t.action.args.branchId})),(c=n_("svg:g").attr("class","controlActionLink").attr("transform","translate(".concat(r.render.width,", ").concat(s,")"))).append(function(){return n0(v.Action).attr("transform","translate(".concat(-h.render.node.control.connectorRadius,", ").concat(-h.render.node.control.connectorRadius,")")).on("mouseenter",function(){l||u.style("display","inline")}).node()}),u=n0(v.Minus,!0).attr("transform","translate(".concat(-h.render.node.control.connectorRadius,", ").concat(-h.render.node.control.connectorRadius,")")).style("display","none").on("mouseleave",function(){u.style("display","none")}).on("click",function(){r.updateControlActionEvent(t,e,"continuePlayback"),rS(r.chapter),aM.tools.use(op.ShadowNodeLink).stop()}),c.append(function(){return u.node()}),l||(c.on("mouseenter",function(n){n.buttons||aM.tools.use(op.ShadowNodeLink).data(r,rI.Action,t,e).position([r.styles.x+r.render.width+h.render.node.control.lineLength,r.styles.y+s]).start()}).on("mouseleave",function(){}).call(aM.inputs.nullableDrag()),c.append("rect").attr("fill","transparent").attr("x",h.render.node.control.lineLength-ae/2).attr("y",-ae/2).attr("width",ae).attr("height",ae),c.append("path").attr("fill","none").attr("stroke",h.render.color.stroke).attr("d",n2({source:[7,0],target:[h.render.node.control.lineLength,0]})).attr("pointer-events","none"),c.append("use").attr("class","control_connector_".concat(e.id)).attr("x",h.render.node.control.lineLength).attr("y",0).attr("href","#".concat(nG.Connector))),c.node()}),l&&o.append(function(){var n,o,a,s,l,c,u;return n=i,a=h.render.node.componentControlHeight*n,s=r.render.controlsContainerYCoordinate+h.render.node.control.inactionLinkY+a,l=!!(null===(o=t.events)||void 0===o?void 0:o.some(function(t){return t.action.args.branchId})),(c=n_("svg:g").attr("class","controlInactionLink").attr("transform","translate(".concat(r.render.width,", ").concat(s,")"))).append(function(){return n0(v.Inaction).attr("transform","translate(".concat(-h.render.node.control.connectorRadius,", ").concat(-h.render.node.control.connectorRadius,")")).on("mouseenter",function(){l||u.style("display","inline")}).node()}),u=n0(v.Minus,!0).attr("transform","translate(".concat(-h.render.node.control.connectorRadius,", ").concat(-h.render.node.control.connectorRadius,")")).style("display","none").on("mouseleave",function(){u.style("display","none")}).on("click",function(){r.updateContainerSuspenseAction(t,"continuePlayback"),rS(r.chapter),aM.tools.use(op.ShadowNodeLink).stop()}),c.append(function(){return u.node()}),l||(c.on("mouseenter",function(n){n.buttons||aM.tools.use(op.ShadowNodeLink).data(r,rI.Inaction,t,e).position([r.styles.x+r.render.width+h.render.node.control.lineLength,r.styles.y+s]).start()}).on("mouseleave",function(){}).call(aM.inputs.nullableDrag()),c.append("rect").attr("fill","transparent").attr("x",h.render.node.control.lineLength-ar/2).attr("y",-ar/2).attr("width",ar).attr("height",ar),c.append("path").attr("fill","none").attr("stroke",h.render.color.stroke).attr("d",n2({source:[7,0],target:[h.render.node.control.lineLength,0]})).attr("pointer-events","none"),c.append("use").attr("class","control_connector_".concat(t.id)).attr("x",h.render.node.control.lineLength).attr("y",0).attr("href","#".concat(nG.Connector))),c.node()}),i++})};try{for(var s=ac(r.containers().reverse()),l=s.next();!l.done;l=s.next())a(l.value)}catch(t){e={error:t}}finally{try{l&&!l.done&&(n=s.return)&&n.call(s)}finally{if(e)throw e.error}}return o.node()},ad=function(t){var e,n,r,o,i,a,s,l=rQ(t),c=n_("svg:g").attr("class","nodeTools"),u=l.getIncomingConnectorsCoordinates();if(Object.keys(u).forEach(function(t){switch(t){case rI.Flip:c.append(function(){return o9(l,u[t])});break;case rI.Action:o7(l,c);break;case rI.Inaction:o8(l,c)}}),(null===(r=l.stylesWithDefaults.controls)||void 0===r?void 0:r.enabled)&&!l.isEndNode()){var d=0,f=function(t){l.getContainerControls(t.id).forEach(function(e){var n,r,o=null===(n=e.events)||void 0===n?void 0:n.some(function(t){return"onClick"===t.type&&"setNextBranch"===t.action.type}),i=null===(r=t.events)||void 0===r?void 0:r.some(function(t){return"onSuspense"===t.type&&"setNextBranch"===t.action.type});o&&c.append(function(){var t,e,n,r;return t=d,e=h.render.node.componentControlHeight*t,n=l.render.controlsContainerYCoordinate+h.render.node.control.actionLinkY+e,(r=n_("svg:g").attr("transform","translate(".concat(l.render.width,", ").concat(n,")"))).append(function(){return n0(v.Action).attr("transform","translate(".concat(-h.render.node.control.connectorRadius,", ").concat(-h.render.node.control.connectorRadius,")")).node()}),r.node()}),i&&c.append(function(){var t,e,n,r;return t=d,e=h.render.node.componentControlHeight*t,n=l.render.controlsContainerYCoordinate+h.render.node.control.inactionLinkY+e,(r=n_("svg:g").attr("transform","translate(".concat(l.render.width,", ").concat(n,")"))).append(function(){return n0(v.Inaction).attr("transform","translate(".concat(-h.render.node.control.connectorRadius,", ").concat(-h.render.node.control.connectorRadius,")")).node()}),r.node()}),d++})};try{for(var p=ac(l.containers().reverse()),y=p.next();!y.done;y=p.next())f(y.value)}catch(t){e={error:t}}finally{try{y&&!y.done&&(n=p.return)&&n.call(p)}finally{if(e)throw e.error}}}return l.isEndNode()||((!(null===(o=l.stylesWithDefaults.flipTo)||void 0===o?void 0:o.enabled)&&l.hasBranches(rI.Flip)||!(null===(i=l.stylesWithDefaults.controls)||void 0===i?void 0:i.enabled)&&l.hasBranches(rI.Action)||!(null===(a=l.stylesWithDefaults.controls)||void 0===a?void 0:a.enabled)&&l.hasBranches(rI.Inaction))&&c.append(function(){return o9(l,[l.render.width,l.render.previewMiddleYCoordinate])}),(null===(s=l.stylesWithDefaults.flipTo)||void 0===s?void 0:s.enabled)&&c.append(function(){return aa(l)})),c.node()},ah=function(t){var e,n,r,o,i=rQ(t),a=n_("svg:g"),s=h.render.node,l=s.headerHeight,c=s.heightWithPreviewEov,u=s.componentAddActionHeight;return n=(e=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a}([0,0],2))[0],r=e[1],o=a.append("rect").attr("width",h.render.node.width).attr("height",i.render.height-r).attr("fill",h.render.color.elementBackground),(n||r)&&o.attr("x",n).attr("y",r),function(t,e,n){var r=iD(e,2),o=r[0],i=r[1];if(!n.displayLockedContent){var a=n.stylesWithDefaults.preview.backgroundColor;return iF(t,[o,i],n,a),void iR(t,[o,i],n)}n.videoInfo?iY(t,[o,i],n):iW(t,[o,i],n)}(a,[0,l+1],i),h.isEditMode()&&!i.isEndNode()&&(iQ(a,[0,c],i),function(t,e,n){var r,o,i=i1(e,2),a=i[0],s=i[1],l=0;try{for(var c=i0(n.containers().reverse()),u=c.next();!u.done;u=c.next()){var d=u.value;n.getContainerControls(d.id).forEach(function(e){t.append(function(){var t=s+h.render.node.componentControlHeight*l++;return i2(e,n).attr("transform","translate(".concat(a,", ").concat(t,")")).node()})})}}catch(t){r={error:t}}finally{try{u&&!u.done&&(o=c.return)&&o.call(c)}finally{if(r)throw r.error}}}(a,[0,c+u],i)),a.node()},af=(o=function(t,e){return(o=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),ap=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a},av=function(t,e,n){if(n||2==arguments.length)for(var r,o=0,i=e.length;o<i;o++)!r&&o in e||(r||(r=Array.prototype.slice.call(e,0,o)),r[o]=e[o]);return t.concat(r||Array.prototype.slice.call(e))},ay=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},am=function(t){function e(e,n){var r=t.call(this,e,n)||this;return r._needForRAF=!0,r.render=function(){var t=r3.layout.getChangedNodes(),e=t.deletedNodes,n=t.editedNodes;r.destroyNodes(av(av([],ap(e),!1),ap(n),!1)),n.length&&(r.renderNodes(n),r.updateSelected(av([],ap(r3.selectedNodes),!1),!0)),r.saveRenderResults()},r.clear=function(){r._layer.selectAll("*").remove(),r3.layout.renderedNodesData={}},r.updateSelected=function(t,e){void 0===e&&(e=!1);var n=e?new Set:r3.selectedNodes,o=new Set(t);try{for(var i=ay(n),a=i.next();!a.done;a=i.next()){var s=a.value;(h=rJ(s))&&!o.has(s)&&(r.removeNodeHighlight(s),iH(h,!1),iT(h,!1))}}catch(t){l={error:t}}finally{try{a&&!a.done&&(c=i.return)&&c.call(i)}finally{if(l)throw l.error}}try{for(var l,c,u,d,h,f=ay(o),p=f.next();!p.done;p=f.next())s=p.value,(h=rJ(s))&&!n.has(h.id)&&(r.createNodeHighlight(h),iH(h,!0),iT(h,!0))}catch(t){u={error:t}}finally{try{p&&!p.done&&(d=f.return)&&d.call(f)}finally{if(u)throw u.error}}t.forEach(function(t){return oK(t).raise()})},r.setHovered=function(t){var e,n,o,i,a=new Set(t);try{for(var s=ay(r3.hoveredNodes.values()),l=s.next();!l.done;l=s.next()){var c=l.value,u=rJ(c);u&&!a.has(u.id)&&r.onNodeMouseLeave(u.id)}}catch(t){e={error:t}}finally{try{l&&!l.done&&(n=s.return)&&n.call(s)}finally{if(e)throw e.error}}try{for(var d=ay(a.values()),h=d.next();!h.done;h=d.next()){var f=h.value;r3.hoveredNodes.has(f)||r.onNodeMouseEnter(f)}}catch(t){o={error:t}}finally{try{h&&!h.done&&(i=d.return)&&i.call(d)}finally{if(o)throw o.error}}},r.createNodeCards=function(t){var e=t.map(function(t){return t.id});return r._layer.selectAll("g.NotExistingClassName").data(e).join("g").attr("class",o$).attr("id",function(t){return"node-"+t}).attr("transform",function(t){var e=r0(t);return"translate(".concat(Math.round(e.x),", ").concat(Math.round(e.y),")")})},r.subscribeForZoomEvent(),r}return af(e,t),e.prototype.subscribeForZoomEvent=function(){var t=h.performance.renderAfterZoomThrottleInMs,e=ik()(function(){aM.layers.update()},t);f.on("zoom",e)},e.prototype.destroyNodes=function(t){t.forEach(function(t){return oK(t.id).remove()})},e.prototype.saveRenderResults=function(){var t=oJ().data().map(rQ);r3.layout.renderedNodesData=rw(t),r3.layout.previousNodesToRenderCount=r3.manifest.nodes.length},e.prototype.renderNodeFullLayout=function(t){t.append(i3),t.each(at),t.append(au),t.each(iI)},e.prototype.renderNodeSkeletons=function(t){t.append(ah),t.each(iI)},e.prototype.renderNodes=function(t){var e=this.createNodeCards(t);this.addEventsToNodes(e),r3.layout.shouldRenderFullLayout?this.renderNodeFullLayout(e):this.renderNodeSkeletons(e),e.each(function(t){rQ(t).resetModified()})},e.prototype.addEventsToNodes=function(t){var e=this;t.on("contextmenu",function(t,e){var n=rQ(e);t.preventDefault();var r=aM.dom.getRelativeEventCoordinates(t,aM.dom.staticTools.node());aM.tools.use(op.NodeMenu).data(n).position(r).start()}).on("click",function(t,n){if(!h.isViewMode()){var r=rQ(n);t.preventDefault(),e.onNodeSelection(r)}}).on("mousedown",function(t,n){if(!h.isViewMode()&&1!==t.button&&!r3.selectedNodes.has(n)){var r=rQ(n);aM.inputs.keydown.shiftHold||e.onNodeSelection(r)}}).on("mouseenter touchstart",function(t,n){return e.onNodeMouseEnter(n)},{passive:!0}).on("mouseleave",function(t,n){return e.onNodeMouseLeave(n)}).call(h.isEditOrPreViewMode()?this.initNodeDrag():function(){return null})},e.prototype.onNodeMouseEnter=function(t){if(!r3.selectedNodes.has(t)){var e=rQ(t);this.createNodeHighlight(e,!1),r3.addNodesToHovered([t]),iA(t,!1,!0)}},e.prototype.onNodeMouseLeave=function(t){r3.selectedNodes.has(t)||(this.removeNodeHighlight(t),r3.removeNodesFromHovered([t]),iA(t,!1,!1))},e.prototype.createNodeHighlight=function(t,e){void 0===e&&(e=!0);var n=o0(t.id);n.node()?i7(n,e,t):oK(t.id).insert(function(t){return i8(t,e)},"g.nodeTools")},e.prototype.removeNodeHighlight=function(t){ox(t)?i7(o0(t),!1,rQ(t)):function(t){("string"==typeof t?[t]:t).forEach(function(t){return o0(t).remove()})}(t)},e.prototype.onNodeSelection=function(t){var e=new Set(r3.selectedNodes);aM.inputs.keydown.shiftHold?e.has(t.id)?e.delete(t.id):e.add(t.id):(e.clear(),e.add(t.id));var n=av([],ap(e),!1);aM.layers.updateSelected(n)},e.prototype.initNodeDrag=function(){var t=this,e=0,n=0,r=!1;return eq().clickDistance(50).on("start",function(t,r){var o=rQ(r);aM.tools.disable(),aM.popups.hide(),e=t.x-o.styles.x,n=t.y-o.styles.y}).on("drag",function(o,i){r3.selectedNodes.has(i)&&t._needForRAF&&(t._needForRAF=!1,r=!0,requestAnimationFrame(function(){var r=rQ(i);r.isDragged=!0;var a=ap(aM.grid.getSnappedCoordinates([o.x,o.y]),2),s=a[0],l=a[1],c=s-e-r.styles.x,u=l-n-r.styles.y;r3.selectedNodes.forEach(function(t){var e=rJ(t);if(e){var n=Math.round(e.styles.x+c),r=Math.round(e.styles.y+u);e.updatePosition(n,r),oK(t).attr("transform","translate(".concat(n,", ").concat(r,")"))}}),r3.selectedNodes.forEach(function(t){var e=rJ(t);e&&o1().each(function(t){var n=r1(t);n.source.chapterId===e.id?(n.updateSourceAbsolutePosition([e.styles.x,e.styles.y]),eP(this).datum(n.id).select(".".concat(iu)).attr("d",n2({source:n.source.position.absolute,target:n.target.position.absolute}))):n.target.chapterId===e.id&&(n.updateTargetAbsolutePosition([e.styles.x,e.styles.y]),eP(this).datum(t).select(".".concat(iu)).attr("d",n2({source:n.source.position.absolute,target:n.target.position.absolute})))})}),t._needForRAF=!0;var d=function(){var t=(function(t,e,n){if(n||2==arguments.length)for(var r,o=0,i=e.length;o<i;o++)!r&&o in e||(r||(r=Array.prototype.slice.call(e,0,o)),r[o]=e[o]);return t.concat(r||Array.prototype.slice.call(e))})([],function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a}(r3.selectedNodes),!1).map(rQ);if(0===t.length)throw Error("No selected nodes to calculated group coordinates");var e=t.reduce(function(t,e){var n=e.styles;return 0===Object.keys(t).length?{minX:n.x,minY:n.y,maxX:n.x+e.render.width,maxY:n.y+e.render.height}:{minX:Math.min(t.minX,n.x),minY:Math.min(t.minY,n.y),maxX:Math.max(t.maxX,n.x+e.render.width),maxY:Math.max(t.maxY,n.y+e.render.height)}},{}),n=e.minX,r=e.minY,o=e.maxY;return[[n,r],[e.maxX,o]]}();aM.layers.shiftLayersOnDragToEdge(d)}))}).on("end",function(){var e=av([],ap(r3.selectedNodes),!1).map(function(t){var e=rQ(t);return e.isDragged&&(e.isDragged=!1),{id:t,x:e.styles.x,y:e.styles.y}});r&&f.emit("events",{name:"coordinatesUpdated",context:e}),t._needForRAF=!0,r=!1})},e}(im),ag=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},a_=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a},ab=function(t){var e=this;this._editorMapElement=t,this.update=function(){var t,n;r3.sectors.updateSectors(aM.dom.viewPosition);try{for(var r=ag(e._layers),o=r.next();!o.done;o=r.next()){var i=o.value;i.allowReRendering()&&i.render()}}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}},this.updateSelected=function(t){var n,r;try{for(var o=ag(e._layers),i=o.next();!i.done;i=o.next())i.value.updateSelected(t)}catch(t){n={error:t}}finally{try{i&&!i.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}r3.selectNodes(t)},this.updateHovered=function(t){var n,r;try{for(var o=ag(e._layers),i=o.next();!i.done;i=o.next())i.value.setHovered(t)}catch(t){n={error:t}}finally{try{i&&!i.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}},this.clear=function(){e._layers.forEach(function(t){return t.clear()})},this.dispose=function(){e._editorMapElement.selectAll("*").remove()},this.shiftLayersOnDragToEdge=function(t){var n=a_(t,2),r=a_(n[0],2),o=r[0],i=r[1],a=a_(n[1],2),s=a[0],l=a[1],c=30*Math.max(aM.inputs.zoom.zoomFactor,.4);e.shiftNodesMapOnLeftBorderTouche(o,c),e.shiftNodesMapOnTopBorderTouche(i,c),e.shiftNodesMapOnRightBorderTouche(s,c),e.shiftNodesMapOnBottomBorderTouche(l,c)},this.shiftNodesMapOnLeftBorderTouche=function(t,e){var n=aM.inputs.zoom,r=n.zoomFactor,o=n.shiftTo;n.zoomPosition.x+t*r<40&&o([e,0])},this.shiftNodesMapOnTopBorderTouche=function(t,e){var n=aM.inputs.zoom,r=n.zoomFactor,o=n.shiftTo;n.zoomPosition.y+t*r<40&&o([0,e])},this.shiftNodesMapOnRightBorderTouche=function(t,e){var n=aM.inputs.zoom,r=n.zoomFactor,o=n.shiftTo,i=n.zoomPosition,a=aM.dom.getEditorWindowSize().width;i.x+t*r>a-40&&o([-e,0])},this.shiftNodesMapOnBottomBorderTouche=function(t,e){var n=aM.inputs.zoom,r=n.zoomFactor,o=n.shiftTo,i=n.zoomPosition,a=aM.dom.getEditorWindowSize().height;i.y+t*r>a-40&&o([0,-e])},this._layers=function(t,e,n){if(n||2==arguments.length)for(var r,o=0,i=e.length;o<i;o++)!r&&o in e||(r||(r=Array.prototype.slice.call(e,0,o)),r[o]=e[o]);return t.concat(r||Array.prototype.slice.call(e))}([new iw(t,"branches"),new am(t,"nodes")],a_(h.isViewMode()?[new ix(t,"navigation")]:[]),!1)},aw=function(){function t(t){var e=this;this._editorDOMElement=t,this._withScale=!1,this._zoom={x:0,y:0,value:1},this.show=function(t,n,r,o){void 0===r&&(r="popup"),void 0===o&&(o={}),e.renderPopup(t,n,r,o)},this.hide=function(){var t;e._currentPopupType="popup",e._popupPosition=void 0,e._withScale=!1,null===(t=e._popup)||void 0===t||t.remove()},this.position=function(t){return e._popupPosition=t,e},this.withScale=function(){return e._withScale=!0,e},this._currentPopupType="popup",f.on("zoom",function(t){e._zoom=t,"popup"!==e._currentPopupType&&e.hide()})}return t.prototype.renderPopup=function(t,e,n,r){this._currentPopupType=n;var o=["mge-editorPopup",r.arrowDown?"arrow":""].filter(Boolean).join(" ");if(this._popup=this._editorDOMElement.append("div").attr("class",o).style("width",r.width||"auto").style("min-width","popup"===n?"324px":"200px").style("pointer-events","popup"===n?"all":"none"),e&&this._popup.append("div").style("font-size",17).style("font-weight",600).html(e),this._popup.append("div").html(t),this._popupPosition){if(this._popup.style("top","0").style("left","0").style("transform-origin","top left"),this._withScale){var i=this._popupPosition[0]*this._zoom.value+this._zoom.x,a=this._popupPosition[1]*this._zoom.value+this._zoom.y;this._popup.style("transform","translate(".concat(i,"px, ").concat(a,"px) scale(").concat(this._zoom.value,")"))}else i=this._popupPosition[0],a=this._popupPosition[1],this._popup.style("transform","translate(".concat(i,"px, ").concat(a,"px)"))}else this._popup.style("top","50%").style("left","50%"),this._withScale?this._popup.style("transform","translate(-50%, -50%) scale(".concat(this._zoom.value,")")):this._popup.style("transform","translate(-50%, -50%)")},t}(),aC=function(){function t(t,e){var n,r=this;this.use=function(t){return r.disable(),r._activeTool=t,r._tools[t].tool},this.disable=function(){r._activeTool&&(r._tools[r._activeTool].tool.stop(),r._activeTool=null)},this.disableContextMenu=function(){r._activeTool&&[op.NodeMenu,op.EOVMenu,op.ControlMenu,op.ControlTypeMenu,op.EditorContextMenu].includes(r._activeTool)&&(r._tools[r._activeTool].tool.stop(),r._activeTool=null)},this._activeTool=null,this._tools=((n={})[op.ShadowNode]={render:"map",tool:new oX},n[op.ShadowNodeLink]={render:"map",tool:new ir},n[op.NodeMenu]={render:"staticTools",tool:new oF},n[op.EOVMenu]={render:"staticTools",tool:new oZ},n[op.ControlMenu]={render:"staticTools",tool:new oT},n[op.ControlTypeMenu]={render:"staticTools",tool:new oz},n[op.EditorContextMenu]={render:"staticTools",tool:new oI},n[op.AreaSelectTool]={render:"staticTools",tool:new oN},n);var o=t.append("g").attr("id","editor-tools");Object.values(this._tools).forEach(function(t){switch(t.render){case"map":t.tool.render(o);break;case"staticTools":t.tool.render(e)}})}return Object.defineProperty(t.prototype,"activeTool",{get:function(){return this._activeTool},enumerable:!1,configurable:!0}),t}(),ax=function(){function t(t){this._editorDOMElement=t,this.renderGraphLegend(),this.renderNavigationLegend()}return t.prototype.dispose=function(){},t.prototype.renderGraphLegend=function(){var t=this._editorDOMElement.append("div").attr("class","mge-legend mge-graph");this.renderLegendItem(t,h.translation.graph_node_start,v.StartNode,12,!0),this.renderLegendItem(t,h.translation.graph_node_end,v.EndNode,12,!0),this.renderLegendItem(t,h.translation.graph_location,v.Location)},t.prototype.renderNavigationLegend=function(){var t=this._editorDOMElement.append("div").attr("class","mge-legend mge-navigation");this.renderLegendItem(t,h.translation.navigation_controls,v.LegendNavigation,28)},t.prototype.renderLegendItem=function(t,e,n,r,o){void 0===r&&(r=20),void 0===o&&(o=!1);var i=t.append("div").attr("class","mge-legendItem");i.append("div").attr("class",o?"mge-icon withBg":"mge-icon").append("svg").attr("x",0).attr("y",0).attr("width",r).attr("height",r).attr("viewBox","0 0 ".concat(h.render.iconSize," ").concat(h.render.iconSize)).append("use").attr("href","#".concat(n)),i.append("div").text(e)},t}();let aM=new(function(){function t(){}return t.prototype.init=function(t){this._dom=new ot(t),this._grid=new or(this._dom.grid),this._defs=new n7(this._dom.defs),this._inputs=new ic(this._dom.svg),this._layers=new ab(this._dom.map),this._popups=new aw(this._dom.root),h.isEditOrPreViewMode()&&(this._tools=new aC(this._dom.map,this._dom.staticTools)),h.isViewMode()&&(this._legend=new ax(this._dom.root))},t.prototype.dispose=function(){var t,e,n,r,o,i,a,s;null===(t=this._legend)||void 0===t||t.dispose(),null===(e=this._tools)||void 0===e||e.disable(),null===(n=this._popups)||void 0===n||n.hide(),null===(r=this._layers)||void 0===r||r.dispose(),null===(o=this._inputs)||void 0===o||o.dispose(),null===(i=this._defs)||void 0===i||i.dispose(),null===(a=this._grid)||void 0===a||a.dispose(),null===(s=this._dom)||void 0===s||s.dispose()},Object.defineProperty(t.prototype,"dom",{get:function(){return this._dom||this.throwModuleError("DOM"),this._dom},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"layers",{get:function(){return this._layers||this.throwModuleError("Layers"),this._layers},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"inputs",{get:function(){return this._inputs||this.throwModuleError("Inputs"),this._inputs},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"popups",{get:function(){return this._popups||this.throwModuleError("Popups"),this._popups},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"tools",{get:function(){return this._tools||this.throwModuleError("Tools"),this._tools},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"grid",{get:function(){return this._grid||this.throwModuleError("Grid"),this._grid},enumerable:!1,configurable:!0}),t.prototype.throwModuleError=function(t){throw Error(t+" manager was not initialized. Did you forget to init()?")},t}());var ak=function(){function t(t,e){var n=this;this.update=function(t){var e=function(t,e,n){if(n||2==arguments.length)for(var r,o=0,i=e.length;o<i;o++)!r&&o in e||(r||(r=Array.prototype.slice.call(e,0,o)),r[o]=e[o]);return t.concat(r||Array.prototype.slice.call(e))}([],function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a}(r3.selectedNodes),!1);0===r3.manifest.nodes.length&&t.chapters.length>h.performance.enableSkeletonsOnNodesCount&&n.zoom(.05),r3.reset(),r3.manifest.set(t),r3.setVisitedNodes([t.metadata.initChapterId]),n.reRenderAfterUpdate(e)},this.updateVideosInfo=function(t){try{r3.updateVideosInfo(t),r3.manifest.rebuildNodesAndBranches(),aM.layers.update()}catch(t){throw Error("Argument type mismatch.")}},this.setGraphFrozen=function(t){r3.isGraphFrozen=t},this.dispose=function(){r3.reset(),f.dispose(),aM.dispose()},this.zoom=function(t){rM(t)&&aM.inputs.zoom.update(t)},this.zoomTo=function(t){Array.isArray(t)&&rM(t[0])&&rM(t[1])&&aM.inputs.zoom.translateTo(t)},this.zoomConfig=function(){return aM.inputs.zoom.zoomConfig},this.zoomEnable=function(){aM.inputs.zoom.enable()},this.zoomDisable=function(){aM.inputs.zoom.disable()},this.selectChapter=function(t,e){void 0===e&&(e=!1);var r="string"==typeof t?[t]:t;aM.layers.updateSelected(r);var o="string"==typeof t?t:t[0];e&&o&&n.focusChapter(o)},this.hoverOverChapters=function(t){var e=Array.isArray(t)?t:[t];aM.layers.updateHovered(e)},this.focusChapter=function(t,e){void 0===e&&(e=n.zoomConfig().max/2);var r=rJ(t);r&&aM.inputs.zoom.translateTo(r.getCenter(),e).then(function(){r3.layout.isPerformanceBoostDisabled()||(aM.layers.clear(),aM.layers.update())})},this.recenterGraph=function(){if(r3.manifest.nodes.length){var t=r3.manifest.getManifestBoundingBox(),e=aM.dom.getEditorWindowSize(),n=(t.maxX+t.minX)/2,r=(t.maxY+t.minY)/2,o=Math.min(Math.min(e.width/(t.maxX-t.minX),e.height/(t.maxY-t.minY)),1)-.05;aM.inputs.zoom.translateTo([n,r],o)}},this.setChaptersValidationErrors=function(t){if(!h.isEditMode())throw Error("Only applicable in 'edit' mode");r3.setNodeErrors(t),n.reRenderAfterUpdate()},this.toggleAddChapterTool=function(t){if(void 0===t&&(t=!0),!h.isEditMode())throw Error("Only applicable in 'edit' mode");if(t){var e=aM.inputs.zoom.getRelativeCoordinates([100,100]);aM.tools.use(op.ShadowNode).position(e).start()}else aM.tools.disable()},this.toggleHandTool=function(t){aM.inputs.zoom.toggleMousedownZoom(),t(aM.inputs.zoom.isMousedownZoomEnabled)},this.setVisitedChapters=function(t){if(!h.isViewMode())throw Error("Only applicable in 'view' mode");r3.setVisitedNodes(t),aM.layers.update()},this.setMode=function(t){if(["edit","pre_view"].includes(t)){if(!h.isEditOrPreViewMode())throw Error("Only applicable in 'edit' mode");h.switchMode(t),r3.manifest.rebuildNodesAndBranches(),n.reRenderAfterUpdate()}},this.on=function(t,e){f.on(t,e)},h.init(e),aM.init(t),aM.layers.clear()}return t.prototype.reRenderAfterUpdate=function(t){void 0===t&&(t=[]),aM.dom.updateEditorBackgroundColor(),aM.grid.update(),aM.layers.update(),r3.updatedSelectedBranches();var e=t.filter(function(t){return rJ(t)});aM.layers.updateSelected(e)},t}()})();var s=a.Q,l=a.$});
//# sourceMappingURL=movika-graph-editor.9ab11626.js.map
